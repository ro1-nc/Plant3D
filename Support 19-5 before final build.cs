
using Autodesk.AutoCAD.ApplicationServices;
using Autodesk.AutoCAD.Colors;
using Autodesk.AutoCAD.DatabaseServices;
using Autodesk.AutoCAD.EditorInput;
using Autodesk.AutoCAD.Geometry;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Autodesk.ProcessPower.PnP3dObjects;
using Autodesk.ProcessPower.PlantInstance;
using Autodesk.ProcessPower.ProjectManager;
using Autodesk.ProcessPower.DataLinks;
using Autodesk.ProcessPower.DataObjects;
using Autodesk.ProcessPower.PnP3dDataLinks;
using Autodesk.ProcessPower.PartsRepository;
using Autodesk.ProcessPower.PnP3dPipeSupport;
using Autodesk.ProcessPower.P3dUI;
using Autodesk.ProcessPower.ACPUtils;
using Autodesk.ProcessPower.P3dProjectParts;
using System.Xaml;
using System.Linq.Expressions;
using System.IO;
using System.Runtime.InteropServices;
using System.Reflection;
using System.Windows.Media.Media3D;

using MyCol = System.Drawing.Color;
using Autodesk.AutoCAD.BoundaryRepresentation;
using System.Numerics;
using Plane = Autodesk.AutoCAD.Geometry.Plane;
using Exception = System.Exception;
using Autodesk.AutoCAD.Runtime;
using PlantApp = Autodesk.ProcessPower.PlantInstance.PlantApplication;
using System.Threading;

namespace Project1.Support2D
{
    public class SupportC
    {
        List<SupportData> ListCentalSuppoData = new List<SupportData>();
        CalculationMaths Calculate = new CalculationMaths();

        public double spaceX = 81971.6112;
        public double spaceY = 71075.0829;

        public double tempX = 101659.6570;
        public double tempY = 71694.2039;

        //datum level
        public double datum_level = 0.0;

        //for collecting information
        Dictionary<Defination, double> info = new Dictionary<Defination, double>();

        Dictionary<Defination, Point3d> pointsinfo = new Dictionary<Defination, Point3d>();

        //for collecting extra info
        Dictionary<string, double> extrainfo = new Dictionary<string, double>();

        Dictionary<string, Point3d> pointsextrainfo = new Dictionary<string, Point3d>();

        //dictionary for tag name and concrete size
        Dictionary<string, double> ConcreteSize_WithTAG = new Dictionary<string, double>();

        //for collecting created tags
        List<string> Created_TAG = new List<string>();

        Dictionary<string, Point3d> DicTextPos = new Dictionary<string, Point3d>();

        //dictionary for determining parts
        public Dictionary<string, string> Csectiondetails = new Dictionary<string, string>();

        public Dictionary<string, string> Lsectiondetails = new Dictionary<string, string>();


        //get doc
        public Document CurDoc = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument;
        public void ReadSupportData()
        {
            Document AcadDoc = null;
            Transaction AcadTransaction = null;
            BlockTable AcadBlockTable = null;
            BlockTableRecord AcadBlockTableRecord = null;
            Database AcadDatabase = null;
            Editor AcadEditor = null;
            Document ADoc = null;
            Transaction ATransaction = null;
            BlockTable ABlockTable = null;
            BlockTableRecord ABlockTableRecord = null;
            Database ADatabase = null;
            Editor AEditor = null;
            //PromptSelectionResult selectionRes;

            AcadDoc = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument;
            if (AcadDoc != null)
            {
                string Path = System.IO.Path.GetDirectoryName(AcadDoc.Name);
                Logger.filePath = Path + string.Concat("Log2d", DateTime.Now.ToString("yyyy-dd-M--HH-mm-ss"), ".txt");
                Logger.GetInstance.Debug("Started Reading File");
            }

            string[] LayersName = new string[3];

            List<SupportData> RawSupportData = new List<SupportData>();

            List<SupporSpecData> ListPSuppoData = new List<SupporSpecData>();
            List<SupporSpecData> ListSecondarySuppoData = new List<SupporSpecData>();
            List<SupporSpecData> ListConcreteSupportData = new List<SupporSpecData>();
            string FilePathOpenDoc = "";
            if (AcadDoc != null)
            {
                FilePathOpenDoc = AcadDoc.Name;
                string Filepath = "";

                Project currentProject = PlantApp.CurrentProject.ProjectParts["Piping"];
                DataLinksManager dlm = currentProject.DataLinksManager;

                List<PnPProjectDrawing> dwgList = currentProject.GetPnPDrawingFiles();

                DocumentCollection documentCollection = Application.DocumentManager;

                foreach (PnPProjectDrawing dwg in dwgList)
                {
                    if (dwg.AbsoluteFileName.ToUpper().Contains("PIPING")
                        ||
                        dwg.AbsoluteFileName.ToUpper().Contains("SUPPORT"))
                    {

                        Filepath = PlantApp.CurrentProject.ProjectFolderPath + "\\" + dwg.RelativeFileName;
                        if (System.IO.File.Exists(Filepath))
                        {
                            if (Filepath != FilePathOpenDoc)
                            {
                                AcadDoc = Application.DocumentManager.Open(Filepath, false);

                                Application.DocumentManager.MdiActiveDocument = AcadDoc;
                                AcadEditor = AcadDoc.Editor;

                                AcadDatabase = AcadDoc.Database;

                                if (AcadDatabase != null)
                                {
                                    AcadTransaction = AcadDatabase.TransactionManager.StartTransaction();

                                    if (AcadTransaction != null)
                                    {
                                        using (AcadDoc.LockDocument())
                                        {
                                            AcadBlockTable = AcadTransaction.GetObject(AcadDatabase.BlockTableId,
                                                OpenMode.ForWrite) as BlockTable;

                                            if (AcadBlockTable != null)
                                            {
                                                AcadBlockTableRecord = AcadTransaction.GetObject(AcadBlockTable[BlockTableRecord.ModelSpace],
                                                                OpenMode.ForWrite) as BlockTableRecord;

                                                try
                                                {
                                                    LayersName = GetNamesOfSupportEnteredbyUser(AcadTransaction, AcadDatabase);
                                                }
                                                catch (Exception)
                                                {
                                                    //Logger.GetInstance.Error("Error while Getting Layer Name");
                                                }
                                                if (LayersName[0] != null && LayersName[0].Length > 0)
                                                {
                                                    try
                                                    {
                                                        GetAllPrimarySupportData(AcadEditor, AcadTransaction, LayersName[0], ref ListPSuppoData);
                                                        //Logger.GetInstance.Debug("Total number of Support from Primary Layer"+ ListPSuppoData.Count.ToString());
                                                    }
                                                    catch (Exception)
                                                    {
                                                        //Logger.GetInstance.Error("Error while Reading Primary Support");
                                                        ListPSuppoData = new List<SupporSpecData>();
                                                    }
                                                }

                                                if (LayersName[1] != null && LayersName[1].Length > 0)
                                                {
                                                    try
                                                    {
                                                        GetAllSecondarySupportData(AcadEditor, AcadTransaction, LayersName[1], ref ListSecondarySuppoData);

                                                        //Logger.GetInstance.Debug("Total number of Support from Secondary Layer" + ListSecondarySuppoData.Count.ToString());
                                                    }
                                                    catch (Exception)
                                                    {
                                                        //Logger.GetInstance.Error("Error while Reading Secondary Support");
                                                        ListSecondarySuppoData = new List<SupporSpecData>();
                                                    }
                                                }

                                                if (LayersName[2] != null && LayersName[2].Length > 0)
                                                {
                                                    try
                                                    {
                                                        GetAllConcreteSupportData(AcadEditor, AcadTransaction, LayersName[2], ref ListConcreteSupportData);

                                                        //Logger.GetInstance.Debug("Total number of Support from Concrete Layer" + ListConcreteSupportData.Count.ToString());
                                                    }
                                                    catch (Exception)
                                                    {
                                                        //Logger.GetInstance.Error("Error while Reading Concrete Support");
                                                        ListConcreteSupportData = new List<SupporSpecData>();
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    AcadTransaction.Commit();
                                }
                            }
                        }
                    }
                }

                Application.DocumentManager.CloseAll();
                Thread t = new Thread(SP);
                t.Start();
                t.Join();
                AcadDoc = Application.DocumentManager.Open(FilePathOpenDoc, false);

                using (AcadDoc.LockDocument())
                {
                    AcadEditor = AcadDoc.Editor;
                    AcadDatabase = AcadDoc.Database;
                    AcadTransaction = AcadDatabase.TransactionManager.StartTransaction();
                    AcadBlockTable = AcadTransaction.GetObject(AcadDatabase.BlockTableId,
                    OpenMode.ForWrite) as BlockTable;

                    try
                    {
                        LayersName = GetNamesOfSupportEnteredbyUser(AcadTransaction, AcadDatabase);
                    }
                    catch (Exception)
                    {
                        //Logger.GetInstance.Error("Error while Getting Layer Name");
                    }
                    if (LayersName[0] != null && LayersName[0].Length > 0)
                    {
                        try
                        {
                            GetAllPrimarySupportData(AcadEditor, AcadTransaction, LayersName[0], ref ListPSuppoData);
                            //Logger.GetInstance.Debug("Total number of Support from Primary Layer"+ ListPSuppoData.Count.ToString());
                        }
                        catch (Exception)
                        {
                            //Logger.GetInstance.Error("Error while Reading Primary Support");
                            ListPSuppoData = new List<SupporSpecData>();
                        }
                    }

                    if (LayersName[1] != null && LayersName[1].Length > 0)
                    {
                        try
                        {
                            GetAllSecondarySupportData(AcadEditor, AcadTransaction, LayersName[1], ref ListSecondarySuppoData);

                            //Logger.GetInstance.Debug("Total number of Support from Secondary Layer" + ListSecondarySuppoData.Count.ToString());
                        }
                        catch (Exception)
                        {
                            //Logger.GetInstance.Error("Error while Reading Secondary Support");
                            ListSecondarySuppoData = new List<SupporSpecData>();
                        }
                    }

                    if (LayersName[2] != null && LayersName[2].Length > 0)
                    {
                        try
                        {
                            GetAllConcreteSupportData(AcadEditor, AcadTransaction, LayersName[2], ref ListConcreteSupportData);

                            //Logger.GetInstance.Debug("Total number of Support from Concrete Layer" + ListConcreteSupportData.Count.ToString());
                        }
                        catch (Exception)
                        {
                            //Logger.GetInstance.Error("Error while Reading Concrete Support");
                            ListConcreteSupportData = new List<SupporSpecData>();
                        }
                    }
                    DicTextPos = GetAllTexts(AcadTransaction, AcadBlockTable);

                    SaparateSupports(ref RawSupportData, ListPSuppoData, ListSecondarySuppoData, ListConcreteSupportData, AcadTransaction, AcadBlockTable);

                    ListCentalSuppoData = RawSupportData;
                }
                AcadTransaction.Commit();

            }
        }

        Dictionary<string, Point3d> GetAllTexts(Transaction AcadTransaction, BlockTable AcadBlockTable)
        {
            var AcadBlockTableRecord = AcadTransaction.GetObject(AcadBlockTable[BlockTableRecord.ModelSpace], OpenMode.ForWrite) as BlockTableRecord;

            Dictionary<string, Point3d> DicTextLoc = new Dictionary<string, Point3d>();

            foreach (var id in AcadBlockTableRecord)
            {
                if (id.ObjectClass.DxfName == "TEXT")
                {
                    try
                    {
                        MText mtext = (MText)AcadTransaction.GetObject(id, OpenMode.ForWrite);

                        Extents3d? Ext3d = mtext.Bounds;

                        DicTextLoc[mtext.Text] = Ext3d.Value.MinPoint;
                    }
                    catch (Exception)
                    {
                        try
                        {
                            DBText text = (DBText)AcadTransaction.GetObject(id, OpenMode.ForRead);
                            //text.Position
                            // text.TextString
                            DicTextLoc[text.TextString] = text.Position;
                        }
                        catch (Exception)
                        {
                        }
                    }
                }

            }
            return DicTextLoc;
        }

        public void SP()
        {
            System.Threading.Thread.Sleep(5000);
        }
        string GetTextInsidetheBBOx(Transaction AcadTransaction, BlockTable AcadBlockTable, Pt3D MinPoint, Pt3D MaxPoint)
        {

            var AcadBlockTableRecord = AcadTransaction.GetObject(AcadBlockTable[BlockTableRecord.ModelSpace], OpenMode.ForWrite) as BlockTableRecord;

            Dictionary<string, Point3d> DicTextLoc = new Dictionary<string, Point3d>();

            foreach (var id in AcadBlockTableRecord)
            {
                /*if (id.ObjectClass.DxfName == "TEXT")
                {
                    DBText text = (DBText)AcadTransaction.GetObject(id, OpenMode.ForRead);
                    //text.Position
                    // text.TextString
                    if((Math.Round(MinPoint.X)< Math.Round(text.Position.X) && Math.Round(text.Position.X) <= Math.Round(MaxPoint.X)&& Math.Round(MinPoint.Y) <= Math.Round(text.Position.Y) && Math.Round(text.Position.Y) <= Math.Round(MaxPoint.Y) && Math.Round(MinPoint.Z) <= Math.Round(text.Position.Z) && Math.Round(text.Position.Z) <= Math.Round(MaxPoint.Z))|| (Math.Round(MaxPoint.X) <= Math.Round(text.Position.X) && Math.Round(text.Position.X) <= Math.Round(MinPoint.X) && Math.Round(MaxPoint.Y) <= Math.Round(text.Position.Y) && Math.Round(text.Position.Y) <= Math.Round(MinPoint.Y) && Math.Round(MaxPoint.Z) <= Math.Round(text.Position.Z) && Math.Round(text.Position.Z) <= Math.Round(MinPoint.Z)))
                    {
                        return text.TextString;
                    }
                }
                else*/
                if (id.ObjectClass.DxfName.ToUpper().Contains("TEXT"))
                {
                    try
                    {
                        MText mtext = (MText)AcadTransaction.GetObject(id, OpenMode.ForWrite);

                        Extents3d? Ext3d = mtext.Bounds;


                        if ((Math.Round(MinPoint.X) < Math.Round(Ext3d.Value.MinPoint.X) && Math.Round(Ext3d.Value.MinPoint.X) <= Math.Round(MaxPoint.X) && Math.Round(MinPoint.Y) <= Math.Round(Ext3d.Value.MinPoint.Y) && Math.Round(Ext3d.Value.MinPoint.Y) <= Math.Round(MaxPoint.Y) && Math.Round(MinPoint.Z) <= Math.Round(Ext3d.Value.MinPoint.Z) && Math.Round(Ext3d.Value.MinPoint.Z) <= Math.Round(MaxPoint.Z)) || (Math.Round(MaxPoint.X) <= Math.Round(Ext3d.Value.MinPoint.X) && Math.Round(Ext3d.Value.MinPoint.X) <= Math.Round(MinPoint.X) && Math.Round(MaxPoint.Y) <= Math.Round(Ext3d.Value.MinPoint.Y) && Math.Round(Ext3d.Value.MinPoint.Y) <= Math.Round(MinPoint.Y) && Math.Round(MaxPoint.Z) <= Math.Round(Ext3d.Value.MinPoint.Z) && Math.Round(Ext3d.Value.MinPoint.Z) <= Math.Round(MinPoint.Z)))
                        {
                            DicTextPos[mtext.Text] = Ext3d.Value.MinPoint;
                            return mtext.Text;

                        }
                    }
                    catch
                    {
                        try
                        {
                            DBText text = (DBText)AcadTransaction.GetObject(id, OpenMode.ForRead);

                            if ((Math.Round(MinPoint.X) < Math.Round(text.Position.X) && Math.Round(text.Position.X) <= Math.Round(MaxPoint.X) && Math.Round(MinPoint.Y) <= Math.Round(text.Position.Y) && Math.Round(text.Position.Y) <= Math.Round(MaxPoint.Y) && Math.Round(MinPoint.Z) <= Math.Round(text.Position.Z) && Math.Round(text.Position.Z) <= Math.Round(MaxPoint.Z)) || (Math.Round(MaxPoint.X) <= Math.Round(text.Position.X) && Math.Round(text.Position.X) <= Math.Round(MinPoint.X) && Math.Round(MaxPoint.Y) <= Math.Round(text.Position.Y) && Math.Round(text.Position.Y) <= Math.Round(MinPoint.Y) && Math.Round(MaxPoint.Z) <= Math.Round(text.Position.Z) && Math.Round(text.Position.Z) <= Math.Round(MinPoint.Z)))
                            {
                                DicTextPos[text.TextString] = text.Position;
                                return text.TextString;
                            }
                        }
                        catch
                        {
                        }
                    }
                }

            }
            return "";
        }

        void SaparateSupports(ref List<SupportData> RawSupportData, List<SupporSpecData> ListPSuppoData, List<SupporSpecData> ListSecondarySuppoData, List<SupporSpecData> ListConcreteSupportData, Transaction AcadTransaction, BlockTable AcadBlockTable)
        {
            //We will iterate over the Primary Support Get all the touching Support to it
            List<SupporSpecData> ListAllSuppoData = new List<SupporSpecData>();
            CombineSupportData(ref ListAllSuppoData, ListPSuppoData, ListSecondarySuppoData, ListConcreteSupportData);

            List<string> ListProcessedSupData = new List<string>();

            List<string> ListProcessedDataIds = new List<string>();

            foreach (SupporSpecData PSuppoData in ListPSuppoData)
            {

                SupportData SupData = new SupportData();
                List<SupporSpecData> ListSuppoData = new List<SupporSpecData>();


                string Text = ""; //GetTextInsidetheBBOx(AcadTransaction, AcadBlockTable, PSuppoData.Boundingboxmin, PSuppoData.Boundingboxmax);

                //if (RawSupportData.Exists(x => x.Name.Equals(Text)))
                //{
                //    RawSupportData.Find(x => x.Name.Equals(Text)).Quantity++;

                //  continue;
                // }

                if (ListProcessedDataIds != null && ListProcessedDataIds.Count > 0 && ListProcessedDataIds.Contains(PSuppoData.SuppoId))
                {
                    continue;
                }

                GetAllTouchingSecondarySupport(PSuppoData, ref ListSuppoData, ref ListProcessedDataIds, ListSecondarySuppoData);

                List<SupporSpecData> TempSuppoList = new List<SupporSpecData>();
                SupporSpecData TempSuppoData = new SupporSpecData();

                TempSuppoList = new List<SupporSpecData>(ListSuppoData);
                //Temporary Adding this  need to Modify This
                if (ListSuppoData != null)
                {
                    foreach (SupporSpecData Sup in TempSuppoList)
                    {
                        if (Sup.SuppoId != null && Sup.SuppoId.Contains("S") && Sup.TouchingPartid != null && Sup.TouchingPartid.Contains("P"))
                        {
                            TempSuppoData = Sup;
                            GetllTouchingParts(TempSuppoData, ref ListSuppoData, ref ListProcessedDataIds, ListAllSuppoData);
                        }
                    }

                    SeparateAndFillSupport(ref ListSuppoData, ref RawSupportData, Text, AcadTransaction, AcadBlockTable);
                }
            }

            System.Threading.Thread.Sleep(5000);
            GC.Collect();
            foreach (SupporSpecData PSuppoData in ListSecondarySuppoData)
            {
                SupportData SupData = new SupportData();
                List<SupporSpecData> ListSuppoData = new List<SupporSpecData>();


                string Text = ""; //GetTextInsidetheBBOx(AcadTransaction, AcadBlockTable, PSuppoData.Boundingboxmin, PSuppoData.Boundingboxmax);

                //if (RawSupportData.Exists(x => x.Name.Equals(Text)))
                //{
                //    RawSupportData.Find(x => x.Name.Equals(Text)).Quantity++;

                //  continue;
                // }

                if (ListProcessedDataIds != null && ListProcessedDataIds.Count > 0 && ListProcessedDataIds.Contains(PSuppoData.SuppoId))
                {
                    continue;
                }

                /*  GetAllTouchingSecondarySupport(PSuppoData, ref ListSuppoData, ref ListProcessedDataIds, ListSecondarySuppoData);

                  SupporSpecData TempSuppoData = new SupporSpecData();
                  //Temporary Adding this  need to Modify This
                  foreach (SupporSpecData Sup in ListSuppoData)
                  {
                      if (Sup.SuppoId.Contains("S"))
                      {
                          TempSuppoData = Sup;
                      }
                  }*/


                GetllTouchingParts(PSuppoData, ref ListSuppoData, ref ListProcessedDataIds, ListAllSuppoData);

                SeparateAndFillSupport(ref ListSuppoData, ref RawSupportData, Text, AcadTransaction, AcadBlockTable);
            }
        }

        void GetAllTouchingPart(ref List<SupporSpecData> RawSupportData)
        {
            foreach (SupporSpecData SSupportData in RawSupportData)
            {
                List<string> ListTouchingParts = new List<string>();

                if (SSupportData.SuppoId == null)
                {
                    continue;
                }

                foreach (SupporSpecData SupData in RawSupportData)
                {
                    if (SupData.SuppoId == null || SupData.SuppoId == SSupportData.SuppoId)
                    {
                        continue;
                    }

                    bool IsXRange = false;
                    bool IsYRange = false;
                    bool IsZRange = false;

                    if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmin.X) && Math.Round(SupData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmin.X) && Math.Round(SupData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmax.X) && Math.Round(SupData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SupData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmin.X) && Math.Round(SSupportData.Boundingboxmax.X) <= Math.Round(SupData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }


                    if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmin.Y) && Math.Round(SupData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmin.Y) && Math.Round(SupData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmax.Y) && Math.Round(SupData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SupData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmin.Y) && Math.Round(SSupportData.Boundingboxmax.Y) <= Math.Round(SupData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }



                    if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmin.Z) && Math.Round(SupData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmin.Z) && Math.Round(SupData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmax.Z) && Math.Round(SupData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SupData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmin.Z) && Math.Round(SSupportData.Boundingboxmax.Z) <= Math.Round(SupData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }

                    if (IsXRange && IsYRange && IsZRange)
                    {
                        ListTouchingParts.Add(SupData.SuppoId);
                    }
                }

                SSupportData.ListtouchingParts = ListTouchingParts;
            }
        }
        void CheckforGussetPlate(ref SupportData RawSupportData)
        {
            foreach (SupporSpecData SSupportData in RawSupportData.ListSecondrySuppo)
            {
                if (SSupportData.SupportName == null)
                {
                    continue;
                }

                if (!SSupportData.SupportName.ToUpper().Equals("PLATE"))
                {
                    continue;
                }
                foreach (SupporSpecData SupData in RawSupportData.ListConcreteData)
                {
                    bool IsXRange = false;
                    bool IsYRange = false;
                    bool IsZRange = false;

                    if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmin.X) && Math.Round(SupData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmin.X) && Math.Round(SupData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmax.X) && Math.Round(SupData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SupData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmin.X) && Math.Round(SSupportData.Boundingboxmax.X) <= Math.Round(SupData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }


                    if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmin.Y) && Math.Round(SupData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmin.Y) && Math.Round(SupData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmax.Y) && Math.Round(SupData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SupData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmin.Y) && Math.Round(SSupportData.Boundingboxmax.Y) <= Math.Round(SupData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }



                    if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmin.Z) && Math.Round(SupData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmin.Z) && Math.Round(SupData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmax.Z) && Math.Round(SupData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SupData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmin.Z) && Math.Round(SSupportData.Boundingboxmax.Z) <= Math.Round(SupData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }

                    if (IsXRange && IsYRange && IsZRange)
                    {
                        if (SupData.SuppoId != null && SupData.SuppoId.ToUpper().Contains("S") && SSupportData.SuppoId != null && SSupportData.SuppoId.ToUpper().Contains("C"))
                        {
                            if (SupData.SupportName.ToUpper().Equals("PLATE"))
                            {
                                SupData.IsGussetplate = true;
                            }
                        }
                        else if (SupData.SuppoId != null && SupData.SuppoId.ToUpper().Contains("C") && SSupportData.SuppoId != null && SSupportData.SuppoId.ToUpper().Contains("S"))
                        {
                            if (SSupportData.SupportName.ToUpper().Equals("PLATE"))
                            {
                                SSupportData.IsGussetplate = true;
                            }
                        }
                    }
                }
            }
        }
        void SeparateAndFillSupport(ref List<SupporSpecData> ListSuppoData, ref List<SupportData> RawSupportData, string Name, Transaction AcadTransaction, BlockTable AcadBlockTable)
        {
            SupportData FullSuppo = new SupportData();
            List<SupporSpecData> ListPSuppoData = new List<SupporSpecData>();
            List<SupporSpecData> ListSecondarySuppoData = new List<SupporSpecData>();
            List<SupporSpecData> ListConcreteSupportData = new List<SupporSpecData>();

            GetAllTouchingPart(ref ListSuppoData);
            foreach (SupporSpecData SupData in ListSuppoData)
            {
                if (SupData.SuppoId != null && SupData.SuppoId.Contains("P"))
                {
                    ListPSuppoData.Add(SupData);
                }
                else if (SupData.SuppoId != null && SupData.SuppoId.Contains("S"))
                {
                    ListSecondarySuppoData.Add(SupData);
                }
                else if (SupData.SuppoId != null && SupData.SuppoId.Contains("C"))
                {
                    ListConcreteSupportData.Add(SupData);
                }

                string text = GetTextInsidetheBBOx(AcadTransaction, AcadBlockTable, SupData.Boundingboxmin, SupData.Boundingboxmax);
                if (text.Length > 0)
                {
                    Name = GetTextInsidetheBBOx(AcadTransaction, AcadBlockTable, SupData.Boundingboxmin, SupData.Boundingboxmax);
                }
            }

            FullSuppo.ListPrimarySuppo = ListPSuppoData;
            FullSuppo.ListSecondrySuppo = ListSecondarySuppoData;
            FullSuppo.ListConcreteData = ListConcreteSupportData;
            FullSuppo.Name = Name;
            FullSuppo.Quantity++;


            CheckforGussetPlate(ref FullSuppo);
            RawSupportData.Add(FullSuppo);
        }

        void CombineSupportData(ref List<SupporSpecData> ListAllSuppoData, List<SupporSpecData> ListPSuppoData, List<SupporSpecData> ListSecondarySuppoData, List<SupporSpecData> ListConcreteSupportData)
        {
            foreach (SupporSpecData Data in ListPSuppoData)
            {
                ListAllSuppoData.Add(Data);
            }

            foreach (SupporSpecData Data in ListSecondarySuppoData)
            {
                ListAllSuppoData.Add(Data);
            }

            foreach (SupporSpecData Data in ListConcreteSupportData)
            {
                ListAllSuppoData.Add(Data);
            }
        }

        void GetllTouchingParts(SupporSpecData SupData, ref List<SupporSpecData> ListSuppoData, ref List<string> ListProcessedDataIds, List<SupporSpecData> ListAllSuppoData)
        {
            List<SupporSpecData> ListTouchingSuppo = new List<SupporSpecData>();

            foreach (SupporSpecData SSupportData in ListAllSuppoData)
            {
                if (ListProcessedDataIds.Contains(SSupportData.SuppoId))
                {
                    continue;
                }

                bool IsXRange = false;
                bool IsYRange = false;
                bool IsZRange = false;

                if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmin.X) && Math.Round(SupData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                {
                    IsXRange = true;
                }
                else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmin.X) && Math.Round(SupData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                {
                    IsXRange = true;
                }
                else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmax.X) && Math.Round(SupData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                {
                    IsXRange = true;
                }
                else if (Math.Round(SupData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmin.X) && Math.Round(SSupportData.Boundingboxmax.X) <= Math.Round(SupData.Boundingboxmax.X))
                {
                    IsXRange = true;
                }
                /*   else if (Math.Round(SupData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmin.X) && Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SupData.Boundingboxmax.X))
                   {
                       IsXRange = true;
                   }
                   else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmax.X) && Math.Round(SSupportData.Boundingboxmax.X) <= Math.Round(SupData.Boundingboxmax.X))
                   {
                       IsXRange = true;
                   }*/

                if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmin.Y) && Math.Round(SupData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                {
                    IsYRange = true;
                }
                else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmin.Y) && Math.Round(SupData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                {
                    IsYRange = true;
                }
                else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmax.Y) && Math.Round(SupData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                {
                    IsYRange = true;
                }
                else if (Math.Round(SupData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmin.Y) && Math.Round(SSupportData.Boundingboxmax.Y) <= Math.Round(SupData.Boundingboxmax.Y))
                {
                    IsYRange = true;
                }
                /*else if (Math.Round(SupData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmin.Y) && Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SupData.Boundingboxmax.Y))
                {
                    IsYRange = true;
                }
                else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmax.Y) && Math.Round(SSupportData.Boundingboxmax.Y) <= Math.Round(SupData.Boundingboxmax.Y))
                {
                    IsYRange = true;
                }
                */

                if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmin.Z) && Math.Round(SupData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                {
                    IsZRange = true;
                }
                else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmin.Z) && Math.Round(SupData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                {
                    IsZRange = true;
                }
                else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmax.Z) && Math.Round(SupData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                {
                    IsZRange = true;
                }
                else if (Math.Round(SupData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmin.Z) && Math.Round(SSupportData.Boundingboxmax.Z) <= Math.Round(SupData.Boundingboxmax.Z))
                {
                    IsZRange = true;
                }
                /*  else if (Math.Round(SupData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmin.Z) && Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SupData.Boundingboxmax.Z))
                  {
                      IsZRange = true;
                  }
                  else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmax.Z) && Math.Round(SSupportData.Boundingboxmax.Z) <= Math.Round(SupData.Boundingboxmax.Z))
                  {
                      IsZRange = true;
                  }*/

                if (IsXRange && IsYRange && IsZRange)
                {
                    ListTouchingSuppo.Add(SSupportData);
                    ListSuppoData.Add(SSupportData);

                    //if (SupData.SuppoId != null && SupData.SuppoId.ToUpper().Contains("S") && SSupportData.SuppoId != null && SSupportData.SuppoId.ToUpper().Contains("C"))
                    //{
                    //    if (SupData.SupportName.ToUpper().Equals("PLATE"))
                    //    {
                    //        SupData.IsGussetplate = true;
                    //    }
                    //}
                    //else if (SupData.SuppoId != null && SupData.SuppoId.ToUpper().Contains("C") && SSupportData.SuppoId != null && SSupportData.SuppoId.ToUpper().Contains("S"))
                    //{
                    //    if (SSupportData.SupportName.ToUpper().Equals("PLATE"))
                    //    {
                    //        SSupportData.IsGussetplate = true;
                    //    }
                    //}

                    if (SupData.SuppoId != null && SupData.SuppoId.ToUpper().Contains("P"))
                    {
                        SupData.TouchingPartid = SSupportData.SuppoId;
                        //SSupportData.TouchingPartid = SupData.SuppoId;
                    }

                    if (!ListProcessedDataIds.Contains(SSupportData.SuppoId))
                    {
                        ListProcessedDataIds.Add(SSupportData.SuppoId);
                    }
                }
            }

            foreach (SupporSpecData SuppoData in ListTouchingSuppo)
            {
                GetllTouchingParts(SuppoData, ref ListSuppoData, ref ListProcessedDataIds, ListAllSuppoData);
            }
        }

        void GetAllTouchingSecondarySupport(SupporSpecData PSuppoData, ref List<SupporSpecData> ListPartsRange, ref List<string> ListProcessedDataIds, List<SupporSpecData> ListSecondarySuppoData)
        {

            //Need to be Refine the Logic later
            GetAllSondaryPartinRange(PSuppoData, ref ListPartsRange, ref ListProcessedDataIds, ListSecondarySuppoData);
            ListPartsRange.Add(PSuppoData);

            if (!ListProcessedDataIds.Contains(PSuppoData.SuppoId))
            {
                ListProcessedDataIds.Add(PSuppoData.SuppoId);
            }
            //int CountTouchingParts = 1;
            // while(CountTouchingParts!=0)
            // {
            // }

            //GetPartsTochingXminconst(PSuppoData, ref Data, ListSecondarySuppoData);
            //GetPartsTochingXmaxconst(PSuppoData, ref Data, ListSecondarySuppoData);
            //GetPartsTochingYminconst(PSuppoData, ref Data, ListSecondarySuppoData);
            //GetPartsTochingYmaxconst(PSuppoData, ref Data, ListSecondarySuppoData);
            //GetPartsTochingZminconst(PSuppoData, ref Data, ListSecondarySuppoData);
            //GetPartsTochingZmaxconst(PSuppoData, ref Data, ListSecondarySuppoData); 
        }

        void ModifyBoundigBox(ref SupporSpecData PSuppoData)
        {
            if (PSuppoData.BottomPrim == null)
            {
                return;
            }
            if (Calculate.DistPoint(PSuppoData.Boundingboxmin, PSuppoData.BottomPrim) > Calculate.DistPoint(PSuppoData.Boundingboxmax, PSuppoData.BottomPrim))
            {
                PSuppoData.Boundingboxmax = new Pt3D(PSuppoData.BottomPrim);
            }
            else
            {
                PSuppoData.Boundingboxmin = new Pt3D(PSuppoData.BottomPrim);
            }
        }
        void GetAllSondaryPartinRange(SupporSpecData PRSuppoData, ref List<SupporSpecData> ListPartsRange, ref List<string> ListProcessedDataIds, List<SupporSpecData> ListSecondarySuppoData)
        {
            SupporSpecData PSuppoData = new SupporSpecData(PRSuppoData);

            if (PSuppoData.IsSupportNB)
            {
                try
                {
                    ModifyBoundigBox(ref PSuppoData);
                }
                catch (Exception)
                {
                }
            }

            foreach (SupporSpecData SSupportData in ListSecondarySuppoData)
            {
                bool IsXRange = false;
                bool IsYRange = false;
                bool IsZRange = false;

                /* if (SSupportData.Boundingboxmin.X <= PSuppoData.Boundingboxmin.X && PSuppoData.Boundingboxmax.X <= SSupportData.Boundingboxmax.X)
                 {
                     IsXRange = true;
                 }
                 else if (SSupportData.Boundingboxmin.X <= PSuppoData.Boundingboxmin.X && PSuppoData.Boundingboxmin.X <= SSupportData.Boundingboxmax.X)
                 {
                     IsXRange = true;
                 }
                 else if (SSupportData.Boundingboxmin.X <= PSuppoData.Boundingboxmax.X && PSuppoData.Boundingboxmax.X <= SSupportData.Boundingboxmax.X)
                 {
                     IsXRange = true;
                 }

                 if (SSupportData.Boundingboxmin.Y <= PSuppoData.Boundingboxmin.Y && PSuppoData.Boundingboxmax.Y <= SSupportData.Boundingboxmax.Y)
                 {
                     IsYRange = true;
                 }
                 else if (SSupportData.Boundingboxmin.Y <= PSuppoData.Boundingboxmin.Y && PSuppoData.Boundingboxmin.Y <= SSupportData.Boundingboxmax.Y)
                 {
                     IsYRange = true;
                 }
                 else if (SSupportData.Boundingboxmin.Y <= PSuppoData.Boundingboxmax.Y && PSuppoData.Boundingboxmax.Y <= SSupportData.Boundingboxmax.Y)
                 {
                     IsYRange = true;
                 }

                 if (SSupportData.Boundingboxmin.Z <= PSuppoData.Boundingboxmin.Z && PSuppoData.Boundingboxmax.Z <= SSupportData.Boundingboxmax.Z)
                 {
                     IsZRange = true;
                 }
                 else if (SSupportData.Boundingboxmin.Z <= PSuppoData.Boundingboxmin.Z && PSuppoData.Boundingboxmin.Z <= SSupportData.Boundingboxmax.Z)
                 {
                     IsZRange = true;
                 }
                 else if (SSupportData.Boundingboxmin.Z <= PSuppoData.Boundingboxmax.Z && PSuppoData.Boundingboxmax.Z <= SSupportData.Boundingboxmax.Z)
                 {
                     IsZRange = true;
                 }
                 */
                if (SSupportData.SupportName != null && SSupportData.SupportName == "PLATE")

                {
                    if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(PSuppoData.Boundingboxmin.X) && Math.Round(PSuppoData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(PSuppoData.Boundingboxmin.X) && Math.Round(PSuppoData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(PSuppoData.Boundingboxmax.X) && Math.Round(PSuppoData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(PSuppoData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmin.X) && Math.Round(SSupportData.Boundingboxmax.X) <= Math.Round(PSuppoData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }


                    if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(PSuppoData.Boundingboxmin.Y) && Math.Round(PSuppoData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(PSuppoData.Boundingboxmin.Y) && Math.Round(PSuppoData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(PSuppoData.Boundingboxmax.Y) && Math.Round(PSuppoData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(PSuppoData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmin.Y) && Math.Round(SSupportData.Boundingboxmax.Y) <= Math.Round(PSuppoData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }


                    if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(PSuppoData.Boundingboxmin.Z) && Math.Round(PSuppoData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(PSuppoData.Boundingboxmin.Z) && Math.Round(PSuppoData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(PSuppoData.Boundingboxmax.Z) && Math.Round(PSuppoData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(PSuppoData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmin.Z) && Math.Round(SSupportData.Boundingboxmax.Z) <= Math.Round(PSuppoData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                }
                else
                {
                    if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(PRSuppoData.Boundingboxmin.X) && Math.Round(PRSuppoData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(PRSuppoData.Boundingboxmin.X) && Math.Round(PRSuppoData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.X) <= Math.Round(PRSuppoData.Boundingboxmax.X) && Math.Round(PRSuppoData.Boundingboxmax.X) <= Math.Round(SSupportData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }
                    else if (Math.Round(PRSuppoData.Boundingboxmin.X) <= Math.Round(SSupportData.Boundingboxmin.X) && Math.Round(SSupportData.Boundingboxmax.X) <= Math.Round(PRSuppoData.Boundingboxmax.X))
                    {
                        IsXRange = true;
                    }


                    if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(PRSuppoData.Boundingboxmin.Y) && Math.Round(PRSuppoData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(PRSuppoData.Boundingboxmin.Y) && Math.Round(PRSuppoData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Y) <= Math.Round(PRSuppoData.Boundingboxmax.Y) && Math.Round(PRSuppoData.Boundingboxmax.Y) <= Math.Round(SSupportData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }
                    else if (Math.Round(PRSuppoData.Boundingboxmin.Y) <= Math.Round(SSupportData.Boundingboxmin.Y) && Math.Round(SSupportData.Boundingboxmax.Y) <= Math.Round(PRSuppoData.Boundingboxmax.Y))
                    {
                        IsYRange = true;
                    }


                    if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(PRSuppoData.Boundingboxmin.Z) && Math.Round(PRSuppoData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(PRSuppoData.Boundingboxmin.Z) && Math.Round(PRSuppoData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(SSupportData.Boundingboxmin.Z) <= Math.Round(PRSuppoData.Boundingboxmax.Z) && Math.Round(PRSuppoData.Boundingboxmax.Z) <= Math.Round(SSupportData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                    else if (Math.Round(PRSuppoData.Boundingboxmin.Z) <= Math.Round(SSupportData.Boundingboxmin.Z) && Math.Round(SSupportData.Boundingboxmax.Z) <= Math.Round(PRSuppoData.Boundingboxmax.Z))
                    {
                        IsZRange = true;
                    }
                }


                if (IsXRange && IsYRange && IsZRange)
                {
                    PRSuppoData.TouchingPartid = SSupportData.SuppoId;
                    SSupportData.TouchingPartid = PRSuppoData.SuppoId;
                    ListPartsRange.Add(SSupportData);

                    //if (PRSuppoData.SuppoId != null && PRSuppoData.SuppoId.ToUpper().Contains("S") && SSupportData.SuppoId != null && SSupportData.SuppoId.ToUpper().Contains("C"))
                    //{
                    //    if (PRSuppoData.SupportName.ToUpper().Equals("PLATE"))
                    //    {
                    //        PRSuppoData.IsGussetplate = true;
                    //    }
                    //}
                    //else if (PRSuppoData.SuppoId != null && PRSuppoData.SuppoId.ToUpper().Contains("C") && SSupportData.SuppoId != null && SSupportData.SuppoId.ToUpper().Contains("S"))
                    //{
                    //    if (SSupportData.SupportName.ToUpper().Equals("PLATE"))
                    //    {
                    //        SSupportData.IsGussetplate = true;
                    //    }
                    //}


                    if (!ListProcessedDataIds.Contains(SSupportData.SuppoId))
                    {
                        ListProcessedDataIds.Add(SSupportData.SuppoId);
                    }
                }
            }
        }

        void GetPartsTochingXminconst(SupporSpecData PSuppoData, ref SupportData Data, List<SupporSpecData> ListSecondarySuppoData)
        {
            foreach (SupporSpecData SSuppoData in ListSecondarySuppoData)
            {
                //Considring only the support in the positive Z direction
                if (SSuppoData.Boundingboxmin.X <= PSuppoData.Boundingboxmin.X)
                {

                }


            }
        }

        void GetPartsTochingXmaxconst(SupporSpecData PSuppoData, ref SupportData Data, List<SupporSpecData> ListSecondarySuppoData)
        {

        }

        void GetPartsTochingYminconst(SupporSpecData PSuppoData, ref SupportData Data, List<SupporSpecData> ListSecondarySuppoData)
        {

        }

        void GetPartsTochingYmaxconst(SupporSpecData PSuppoData, ref SupportData Data, List<SupporSpecData> ListSecondarySuppoData)
        {

        }

        void GetPartsTochingZminconst(SupporSpecData PSuppoData, ref SupportData Data, List<SupporSpecData> ListSecondarySuppoData)
        {

        }
        void GetPartsTochingZmaxconst(SupporSpecData PSuppoData, ref SupportData Data, List<SupporSpecData> ListSecondarySuppoData)
        {

        }

        void FillBoundingBox(Entity AcEnt, ref SupporSpecData SuppoSpecdata)
        {
            Extents3d? Ext = AcEnt.Bounds;
            SuppoSpecdata.Boundingboxmin = GetPt3DFromPoint3D(Ext.Value.MinPoint);
            SuppoSpecdata.Boundingboxmax = GetPt3DFromPoint3D(Ext.Value.MaxPoint);
        }

        Pt3D GetPt3DFromPoint3D(Point3d Pt)
        {
            Pt3D LocalPoint3d = new Pt3D();
            LocalPoint3d.X = Pt.X;
            LocalPoint3d.Y = Pt.Y;
            LocalPoint3d.Z = Pt.Z;

            return LocalPoint3d;
        }

        Pt3D GetPt3DFromArray(double[] Pt)
        {
            Pt3D LocalPoint3d = new Pt3D();
            LocalPoint3d.X = Pt[0];
            LocalPoint3d.Y = Pt[1];
            LocalPoint3d.Z = Pt[2];

            return LocalPoint3d;
        }


        void FillDirVec(Entity AcEnt, ref SupporSpecData SuppoSpecdata)
        {
            DirectionVec DirVec = new DirectionVec();
            DirVec.XDirVec = GetPt3DFromVecData(AcEnt.Ecs.CoordinateSystem3d.Xaxis);
            DirVec.YDirVec = GetPt3DFromVecData(AcEnt.Ecs.CoordinateSystem3d.Yaxis);
            DirVec.ZDirVec = GetPt3DFromVecData(AcEnt.Ecs.CoordinateSystem3d.Zaxis);

            SuppoSpecdata.Directionvec = DirVec;
        }

        Pt3D GetPt3DFromVecData(Vector3d Vec)
        {
            Pt3D LocalPoint3d = new Pt3D();
            LocalPoint3d.X = Vec.X;
            LocalPoint3d.Y = Vec.Y;
            LocalPoint3d.Z = Vec.Z;

            return LocalPoint3d;
        }

        string[] GetNamesOfSupportEnteredbyUser(Transaction AcadTransaction, Database AcadDatabase)
        {
            string[] LayersName = new string[3];
            //LayerTable AcadLyrTbl;
            LayerTable AcadLyrTbl = AcadTransaction.GetObject(AcadDatabase.LayerTableId, OpenMode.ForRead) as LayerTable;

            if (AcadLyrTbl != null)
            {
                foreach (ObjectId AcadObjId in AcadLyrTbl)
                {
                    LayerTableRecord AcadLyrTblRec;
                    AcadLyrTblRec = AcadTransaction.GetObject(AcadObjId,
                                                    OpenMode.ForRead) as LayerTableRecord;
                    if (AcadLyrTblRec.Name.ToLower().Equals("primary support"))
                    {
                        LayersName[0] = AcadLyrTblRec.Name;

                        //Logger.GetInstance.Debug("Layer 1 Nameis : "+ LayersName[0]);
                    }
                    else if (AcadLyrTblRec.Name.ToLower().Equals("secondary support"))
                    {
                        LayersName[1] = AcadLyrTblRec.Name;

                        //Logger.GetInstance.Debug("Layer 2 Nameis : " + LayersName[1]);
                    }
                    else if (AcadLyrTblRec.Name.ToLower().Equals("concrete support"))
                    {
                        LayersName[2] = AcadLyrTblRec.Name;

                        //Logger.GetInstance.Debug("Layer 3 Nameis : " + LayersName[2]);
                    }
                }
            }
            return LayersName;
        }
        List<SupporSpecData> GetAllPrimarySupportData(Editor AcadEditor, Transaction AcadTransaction, string LayerName, ref List<SupporSpecData> ListPSuppoData)
        {
            // = new List<SupporSpecData>();
            try
            {
                PromptSelectionResult SelectionRes;
                ObjectIdCollection Ents;
                TypedValue[] SelFilterName = new TypedValue[1] { new TypedValue((int)DxfCode.LayerName, LayerName) };
                SelectionFilter SelFilter = new SelectionFilter(SelFilterName);


                SelectionRes = AcadEditor.SelectAll(SelFilter);

                //Getting Object ID of the each selected entiry
                Ents = new ObjectIdCollection(SelectionRes.Value.GetObjectIds());

                int Count = ListPSuppoData.Count + 1;
                foreach (ObjectId Id in Ents)
                {
                    try
                    {
                        var AcEnt = (Entity)AcadTransaction.GetObject(Id, OpenMode.ForRead);
                        SupporSpecData SuppoSpecdata = new SupporSpecData();
                        // to explode block of text collect them
                        if (AcEnt.GetType() == typeof(BlockReference))
                        {
                            if (AcEnt.GetType().Name.Contains("BlockReference"))
                            {
                                BlockReference BlockRef = AcEnt as BlockReference;

                                SuppoSpecdata.AcadObjID = AcEnt.ObjectId;
                                FillBoundingBox(AcEnt, ref SuppoSpecdata);
                                SuppoSpecdata.CalculateCentroid();
                                FillDirVec(AcEnt, ref SuppoSpecdata);
                                SuppoSpecdata.CalculateDist();
                                SuppoSpecdata.CalculateVolume();
                                SuppoSpecdata.SupportName = BlockRef.Name;
                                SuppoSpecdata.SuppoId = "P" + Count.ToString();
                                // BlockRef.ScaleFactors

                                if (BlockRef.Name.ToUpper().Contains("GRP FLG"))
                                {
                                    GetRotationFlgGrp(BlockRef, ref SuppoSpecdata);
                                }
                                else if (BlockRef.Name.ToUpper().Contains("NB"))
                                {
                                    GetRotationNBParts(BlockRef, ref SuppoSpecdata);
                                }
                                else
                                {
                                    //SuppoSpecdata.IsSupportNB = true;
                                    DBObjectCollection ExpObjs = new DBObjectCollection();
                                    BlockRef.Explode(ExpObjs);
                                    GetZDir(ref SuppoSpecdata, ExpObjs);
                                }
                            }
                        }
                        else if (AcEnt.GetType() == typeof(Autodesk.ProcessPower.PnP3dObjects.Support))
                        {
                            Autodesk.ProcessPower.PnP3dObjects.Support Suppo = AcEnt as Autodesk.ProcessPower.PnP3dObjects.Support;

                            dynamic Obj = Suppo.AcadObject;

                            SuppoSpecdata.AcadObjID = AcEnt.ObjectId;

                            if (Obj != null)
                            {
                                SuppoSpecdata.SupportName = Obj.PartFamilyLongDesc;
                                string Tag = Obj.LineNumberTag;
                                SuppoSpecdata.Size = Obj.Size;
                            }

                            Autodesk.ProcessPower.PnP3dObjects.PartSizeProperties PartProp = Suppo.PartSizeProperties;

                            SuppoSpecdata.NomianalDia = PartProp.NominalDiameter;

                            FillBoundingBox(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.CalculateCentroid();
                            FillDirVec(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.CalculateDist();
                            SuppoSpecdata.CalculateVolume();

                            SuppoSpecdata.SuppoId = "P" + Count.ToString();
                        }

                        Count++;
                        ListPSuppoData.Add(SuppoSpecdata);
                    }
                    catch (Exception)
                    {
                    }
                }
            }
            catch (Exception)
            {
            }
            return ListPSuppoData;
        }


        void GetRotationFlgGrp(BlockReference BlockRef, ref SupporSpecData SuppoSpecdata)
        {
            DBObjectCollection ExpObjs = new DBObjectCollection();
            BlockRef.Explode(ExpObjs);

            List<BodyData> ListSeleBodyNB = new List<BodyData>();
            BodyData BodyBottomPart = new BodyData();

            CircleData CirDataS = new CircleData();

            //Fun1 730 to 828
            foreach (Entity AcEnt1 in ExpObjs)
            {
                if (AcEnt1.GetType() == typeof(Circle))
                {
                    Circle CirData = AcEnt1 as Circle;

                    CirDataS.Vector.X = CirData.Normal.X;
                    CirDataS.Vector.Y = CirData.Normal.Y;
                    CirDataS.Vector.Z = CirData.Normal.Z;

                    CirDataS.Center.X = CirData.Center.X;
                    CirDataS.AcadPlane = CirData.GetPlane();
                }
            }

            foreach (Entity AcEnt1 in ExpObjs)
            {
                if (AcEnt1.GetType() == typeof(Solid3d))
                {
                    Solid3d solid3D = AcEnt1 as Solid3d;
                    using (var Breps = new Autodesk.AutoCAD.BoundaryRepresentation.Brep(solid3D))
                    {
                        Autodesk.AutoCAD.BoundaryRepresentation.BrepFaceCollection FaceColl = Breps.Faces;

                        int Count = FaceColl.Count<Autodesk.AutoCAD.BoundaryRepresentation.Face>();

                        // Here we are getting the cuboidal bodies from which we can get diection of the Primary support so we are checking for Faces
                        if (Count == 8)
                        {
                            foreach (var FacE in FaceColl)
                            {
                                FaceData FaceLoc = new FaceData();

                                FaceLoc.AcadFace = FacE;
                                BoundBlock3d Block3d = FacE.BoundBlock;

                                FaceLoc.SurfaceArea = FacE.GetSurfaceArea();

                                ExternalBoundedSurface ExtBSurf = FacE.Surface as ExternalBoundedSurface;

                                if (ExtBSurf != null)
                                {
                                    if (ExtBSurf.IsPlane)
                                    {
                                        Plane PlaneSurf = ExtBSurf.BaseSurface as Plane;

                                        if (PlaneSurf.IsCoplanarTo(CirDataS.AcadPlane))
                                        {

                                            FillDirVecData(PlaneSurf.GetCoordinateSystem(), ref SuppoSpecdata);

                                            DirectionVec DirVec = new DirectionVec();
                                            DirVec.XDirVec = GetPt3DFromVecData(FacE.BoundBlock.Direction1);
                                            DirVec.YDirVec = GetPt3DFromVecData(FacE.BoundBlock.Direction2);
                                            DirVec.ZDirVec = GetPt3DFromVecData(FacE.BoundBlock.Direction3);

                                            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(CirDataS.AcadPlane.Normal.X, CirDataS.AcadPlane.Normal.Y, CirDataS.AcadPlane.Normal.Z);
                                            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);


                                            //  System.Windows.Media.Media3D.Vector3D.
                                            double angle1 = System.Windows.Media.Media3D.Vector3D.AngleBetween(Vec1, Vec2);
                                            double angle2 = System.Windows.Media.Media3D.Vector3D.AngleBetween(Vec1, new System.Windows.Media.Media3D.Vector3D(0, 1, 0));
                                            double angle3 = System.Windows.Media.Media3D.Vector3D.AngleBetween(Vec1, new System.Windows.Media.Media3D.Vector3D(0, 0, 1));

                                            double anglePto = System.Windows.Media.Media3D.Vector3D.DotProduct(Vec1, new System.Windows.Media.Media3D.Vector3D(0, 0, 1));
                                            //System.Windows.Media.Media3D.Vector3D Crossp = System.Windows.Media.Media3D.Vector3D.CrossProduct(Vec1, Vec2);

                                            SuppoSpecdata.Directionvec = DirVec;
                                            //  PlaneSurf.TransformBy

                                            SuppoSpecdata.DistCenter = GetDistanceCenterCirclefromBase(FaceLoc.AcadFace, CirDataS.Center);

                                            Vec1.Normalize();

                                            double X = Calculate.GetSignedRotation(Vec1, new System.Windows.Media.Media3D.Vector3D(1, 0, 0), new System.Windows.Media.Media3D.Vector3D(0, 0, 1));
                                            double Y = Calculate.GetSignedRotation(Vec1, new System.Windows.Media.Media3D.Vector3D(0, 1, 0), new System.Windows.Media.Media3D.Vector3D(0, 0, 1));
                                            double Z = Calculate.GetSignedRotation(Vec1, new System.Windows.Media.Media3D.Vector3D(0, 0, 1), new System.Windows.Media.Media3D.Vector3D(1, 0, 0));

                                            SuppoSpecdata.FaceLocalAngle = new Angles();
                                            SuppoSpecdata.FaceLocalAngle.XinRadian = X;
                                            SuppoSpecdata.FaceLocalAngle.YinRadian = Y;
                                            SuppoSpecdata.FaceLocalAngle.ZinRadian = Z;
                                            SuppoSpecdata.FaceLocalAngle.XinDegree = Calculate.ConvertRadiansToDegrees(X);
                                            SuppoSpecdata.FaceLocalAngle.YinDegree = Calculate.ConvertRadiansToDegrees(Y);
                                            SuppoSpecdata.FaceLocalAngle.ZinDegree = Calculate.ConvertRadiansToDegrees(Z);

                                            SuppoSpecdata.NoramlDir = new Pt3D();
                                            SuppoSpecdata.NoramlDir.X = CirDataS.AcadPlane.Normal.X;
                                            SuppoSpecdata.NoramlDir.Y = CirDataS.AcadPlane.Normal.Y;
                                            SuppoSpecdata.NoramlDir.Z = CirDataS.AcadPlane.Normal.Z;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        double GetDistanceCenterCirclefromBase(Autodesk.AutoCAD.BoundaryRepresentation.Face AcadFace, Pt3D CenterCir)
        {
            List<double> DistList = new List<double>();

            // double Lenght = 0;
            double Dist = 0;
            foreach (var Loop in AcadFace.Loops)
            {
                if (Loop.LoopType == LoopType.LoopExterior)
                {
                    foreach (Edge AcadEdge in Loop.Edges)
                    {
                        ExternalCurve3d Curve = AcadEdge.Curve as ExternalCurve3d;

                        if (Curve.IsLineSegment)
                        {
                            LineSegment3d LineSeg = Curve.NativeCurve as LineSegment3d;


                            //if (Math.Round(LineSeg.Length) > Math.Round(Lenght))
                            // Lenght = LineSeg.Length;
                            ///LineSeg.
                            Dist = Calculate.DistPoint(GetCenterofLineSeg(LineSeg), CenterCir);
                            DistList.Add(Calculate.DistPoint(GetCenterofLineSeg(LineSeg), CenterCir));
                        }
                    }
                }
            }


            DistList.Sort();

            return DistList[DistList.Count - 1];
        }

        Pt3D GetCenterofLineSeg(LineSegment3d LineSegd)
        {
            Pt3D CenterPt = new Pt3D();

            CenterPt.X = (LineSegd.StartPoint.X + LineSegd.EndPoint.X) / 2;
            CenterPt.Y = (LineSegd.StartPoint.Y + LineSegd.EndPoint.Y) / 2;
            CenterPt.Z = (LineSegd.StartPoint.Z + LineSegd.EndPoint.Z) / 2;

            return CenterPt;
        }

        void GetZDir(ref SupporSpecData SuppoSpecdata, DBObjectCollection ExpObjs)
        {
            double z = 0.0;
            double Vol = 0.0;
            foreach (Entity AcEnt1 in ExpObjs)
            {
                Pt3D BoxData = new Pt3D();
                var Boundingboxmax = AcEnt1.Bounds.Value.MaxPoint;
                var Boundingboxmin = AcEnt1.Bounds.Value.MinPoint;
                BoxData.X = Math.Abs(Boundingboxmax.X - Boundingboxmin.X);
                BoxData.Y = Math.Abs(Boundingboxmax.Y - Boundingboxmin.Y);
                BoxData.Z = Math.Abs(Boundingboxmax.Z - Boundingboxmin.Z);

                if (Vol < BoxData.X * BoxData.Y * BoxData.Z)
                {
                    Vol = BoxData.X * BoxData.Y * BoxData.Z;
                    z = Boundingboxmin.Z + (Math.Abs(Boundingboxmax.Z - Boundingboxmin.Z) / 2);
                }
            }

            SuppoSpecdata.PrimaryZhtNB = z;
        }

        // This will Calculate NBParts All Required Data 
        // Please Make Smaller Functions in the NB Parts


        // This will Calculate NBParts All Required Data 
        // Please Make Smaller Functions in the NB Parts
        void GetRotationNBParts(BlockReference BlockRef, ref SupporSpecData SuppoSpecdata)
        {
            SuppoSpecdata.IsSupportNB = true;
            DBObjectCollection ExpObjs = new DBObjectCollection();
            BlockRef.Explode(ExpObjs);

            List<BodyData> ListSeleBodyNB = new List<BodyData>();
            BodyData BodyBottomPart = new BodyData();

            GetZDir(ref SuppoSpecdata, ExpObjs);

            //Fun1 730 to 828
            foreach (Entity AcEnt1 in ExpObjs)
            {
                if (AcEnt1.GetType() == typeof(Solid3d))
                {
                    Solid3d solid3D = AcEnt1 as Solid3d;
                    using (var Breps = new Autodesk.AutoCAD.BoundaryRepresentation.Brep(solid3D))
                    {
                        Autodesk.AutoCAD.BoundaryRepresentation.BrepFaceCollection FaceColl = Breps.Faces;

                        int Count = FaceColl.Count<Autodesk.AutoCAD.BoundaryRepresentation.Face>();

                        // Here we are getting the cuboidal bodies from which we can get diection of the Primary support so we are checking for Faces
                        if (Count == 6 || Count == 8)
                        {
                            BodyData BodyLoc = new BodyData();
                            BodyLoc.Volume = solid3D.MassProperties.Volume;

                            List<FaceData> ListFacesLoc = new List<FaceData>();

                            int Cntr = 1;
                            foreach (var FacE in FaceColl)
                            {
                                FaceData FaceLoc = new FaceData();

                                FaceLoc.AcadFace = FacE;
                                BoundBlock3d Block3d = FacE.BoundBlock;

                                FaceLoc.SurfaceArea = FacE.GetSurfaceArea();

                                ExternalBoundedSurface ExtBSurf = FacE.Surface as ExternalBoundedSurface;

                                if (ExtBSurf != null)
                                {
                                    if (ExtBSurf.IsPlane)
                                    {
                                        FaceLoc.IsPlannar = true;
                                        Plane PlaneSurf = ExtBSurf.BaseSurface as Plane;

                                        FaceLoc.FaceNormal = PlaneSurf.Normal;

                                        FaceLoc.PtonPlane = PlaneSurf.PointOnPlane;

                                        FaceLoc.IdLocal = "F" + Cntr.ToString();
                                        ListFacesLoc.Add(FaceLoc);
                                        Cntr++;
                                    }
                                }


                                /* Point3d Pt = Block3d.BasePoint;

                                 PointOnSurface ptOnSurf = FacE.Surface.GetClosestPointTo(Pt);

                                 Point2d param = ptOnSurf.Parameter;

                                 Vector3d normal = ptOnSurf.GetNormal(param);

                                 // It seems we cannot trust the

                                 // face.Surface.IsNormalReversed property,

                                 // so I am applying a small offset to the point on surface

                                 // and check if the offset point is inside the solid

                                 // in case it is inside (or on boundary),

                                 // the normal must be reversed

                                 Vector3d normalTest = normal.MultiplyBy(1E-6 / normal.Length);

                                 Point3d ptTest = Pt.Add(normalTest);

                                 Autodesk.AutoCAD.BoundaryRepresentation.PointContainment ptContainment = new PointContainment();

                                 bool reverse = false;

                                 using (BrepEntity brepEnt = FacE.Brep.GetPointContainment(ptTest, out ptContainment))
                                 {

                                     if (ptContainment != PointContainment.Outside)
                                     {
                                         reverse = true;
                                     }
                                 }

                                 normal.MultiplyBy(reverse ? -1.0 : 1.0);

                                 */
                            }


                            if (Count == 6)
                            {
                                BodyLoc.ListFaceData = ListFacesLoc;
                                ListSeleBodyNB.Add(BodyLoc);
                            }
                            else if (Count == 8)
                            {
                                BodyLoc.ListFaceData = ListFacesLoc;
                                BodyBottomPart = BodyLoc;
                            }
                        }
                        else if (Count > 8)
                        {
                            BodyData BodyLoc = new BodyData();
                            BodyLoc.Volume = solid3D.MassProperties.Volume;

                            List<FaceData> ListFacesLoc = new List<FaceData>();

                            int Cntr = 1;
                            foreach (var FacE in FaceColl)
                            {
                                FaceData FaceLoc = new FaceData();

                                FaceLoc.AcadFace = FacE;
                                BoundBlock3d Block3d = FacE.BoundBlock;

                                FaceLoc.SurfaceArea = FacE.GetSurfaceArea();

                                ExternalBoundedSurface ExtBSurf = FacE.Surface as ExternalBoundedSurface;

                                if (ExtBSurf != null)
                                {
                                    if (ExtBSurf.IsPlane)
                                    {
                                        FaceLoc.IsPlannar = true;
                                        Plane PlaneSurf = ExtBSurf.BaseSurface as Plane;

                                        FaceLoc.FaceNormal = PlaneSurf.Normal;

                                        FaceLoc.PtonPlane = PlaneSurf.PointOnPlane;

                                        FaceLoc.IdLocal = "F" + Cntr.ToString();
                                        ListFacesLoc.Add(FaceLoc);

                                    }
                                }
                            }
                        }
                    }
                }
            }

            //Fun1 730 to 828

            // Getting the smallest and the biggest volumes
            // Please Don't change order of fill data to list ListbodiesToCompare Sequence is used to later to caompare data
            //First add the body i the list whoes volume is smaller 

            List<BodyData> ListbodiesToCompare = new List<BodyData>();
            if (ListSeleBodyNB != null && ListSeleBodyNB.Count > 0)
            {
                if (ListSeleBodyNB.Exists(e => Math.Round(e.Volume) > Math.Round(ListSeleBodyNB[0].Volume)))
                {
                    ListbodiesToCompare.Add(ListSeleBodyNB[0]);
                    ListbodiesToCompare.Add(ListSeleBodyNB.Find(e => e.Volume > ListSeleBodyNB[0].Volume));
                }
                else if (ListSeleBodyNB.Exists(e => Math.Round(e.Volume) < Math.Round(ListSeleBodyNB[0].Volume)))
                {
                    ListbodiesToCompare.Add(ListSeleBodyNB.Find(e => e.Volume < ListSeleBodyNB[0].Volume));
                    ListbodiesToCompare.Add(ListSeleBodyNB[0]);
                }
            }

            // Get here on Coplanar face of smallest body Face  
            FaceData FaceDataToProcess = new FaceData();
            if (ListbodiesToCompare != null && ListbodiesToCompare.Count == 2)
            {
                foreach (FaceData FaceB in ListbodiesToCompare[0].ListFaceData)
                {
                    ExternalBoundedSurface ExtBnSurf = FaceB.AcadFace.Surface as ExternalBoundedSurface;
                    Plane PlaneSurfB = ExtBnSurf.BaseSurface as Plane;

                    foreach (FaceData FaceB1 in ListbodiesToCompare[1].ListFaceData)
                    {
                        ExternalBoundedSurface ExtBnSurf1 = FaceB1.AcadFace.Surface as ExternalBoundedSurface;
                        Plane PlaneSurfB1 = ExtBnSurf.BaseSurface as Plane;

                        if (PlaneSurfB.IsCoplanarTo(PlaneSurfB1))
                        {
                            FaceDataToProcess = FaceB;
                            break;
                        }
                    }
                }
            }

            GetDirfromface(FaceDataToProcess, ref SuppoSpecdata);

            ExternalBoundedSurface ExtBSurf1 = FaceDataToProcess.AcadFace.Surface as ExternalBoundedSurface;

            if (ExtBSurf1 != null)
            {
                if (ExtBSurf1.IsPlane)
                {
                    Plane PlaneSurf = ExtBSurf1.BaseSurface as Plane;

                    SuppoSpecdata.NoramlDir = new Pt3D();
                    SuppoSpecdata.NoramlDir.X = PlaneSurf.Normal.X;
                    SuppoSpecdata.NoramlDir.Y = PlaneSurf.Normal.Y;
                    SuppoSpecdata.NoramlDir.Z = PlaneSurf.Normal.Z;
                }
            }

            //recent change
            SuppoSpecdata.Midpoint = GetSmallerMidPt(FaceDataToProcess);

            SuppoSpecdata.DistCenter = GetLargerEdgeFromPlane(FaceDataToProcess) + GetBottomPartHeight(FaceDataToProcess, BodyBottomPart);

            double SurfArea = 0;
            foreach (var Face in BodyBottomPart.ListFaceData)
            {
                if (SurfArea < Face.SurfaceArea)
                {
                    SurfArea = Face.SurfaceArea;
                }
            }

            List<FaceData> faceDt = new List<FaceData>();

            foreach (var Face in BodyBottomPart.ListFaceData)
            {
                if (Math.Round(SurfArea).Equals(Math.Round(Face.SurfaceArea)))
                {
                    faceDt.Add(Face);
                }
            }

            double Dist = 0;

            foreach (var Face in faceDt)
            {
                if (Dist < Calculate.DistPoint(GetPt3DFromPoint3D(FaceDataToProcess.PtonPlane), GetPt3DFromPoint3D(Face.PtonPlane)))
                {
                    Dist = Calculate.DistPoint(GetPt3DFromPoint3D(FaceDataToProcess.PtonPlane), GetPt3DFromPoint3D(Face.PtonPlane));

                    SuppoSpecdata.BottomPrim = GetPt3DFromPoint3D(Face.PtonPlane);
                }
            }
        }
        void GetDirfromface(FaceData Face, ref SupporSpecData SuppoSpecdata)
        {
            ExternalBoundedSurface ExtBSurf = Face.AcadFace.Surface as ExternalBoundedSurface;

            if (ExtBSurf != null)
            {
                if (ExtBSurf.IsPlane)
                {
                    Plane PlaneSurf = ExtBSurf.BaseSurface as Plane;

                    FillDirVecData(PlaneSurf.GetCoordinateSystem(), ref SuppoSpecdata);
                }
            }
        }

        void FillDirVecData(CoordinateSystem3d CordSys, ref SupporSpecData SuppoSpecdata)
        {
            DirectionVec DirVec = new DirectionVec();
            DirVec.XDirVec = GetPt3DFromVecData(CordSys.Xaxis);
            DirVec.YDirVec = GetPt3DFromVecData(CordSys.Yaxis);
            DirVec.ZDirVec = GetPt3DFromVecData(CordSys.Zaxis);

            SuppoSpecdata.Directionvec = DirVec;

        }

        double GetBottomPartHeight(FaceData FaceDataToProcess, BodyData BodyBottomPart)
        {
            if (BodyBottomPart != null)
            {
                ExternalBoundedSurface ExtBnSurf = FaceDataToProcess.AcadFace.Surface as ExternalBoundedSurface;
                Plane PlaneSurfB = ExtBnSurf.BaseSurface as Plane;
                foreach (FaceData FaceB1 in BodyBottomPart.ListFaceData)
                {
                    ExternalBoundedSurface ExtBnSurf1 = FaceB1.AcadFace.Surface as ExternalBoundedSurface;
                    Plane PlaneSurfB1 = ExtBnSurf1.BaseSurface as Plane;

                    if (PlaneSurfB1.IsParallelTo(PlaneSurfB))
                    {
                        return GetSmallerEdgeFromPlane(FaceB1);
                    }
                }
            }

            return 0;
        }


        Pt3D GetSmallerMidPt(FaceData FaceB1)
        {
            double LenghtCurveold = 0;
            bool IsFirst = true;
            double LengthofVer = 0;
            Pt3D Midpt = new Pt3D();

            foreach (var Loop in FaceB1.AcadFace.Loops)
            {
                if (Loop.LoopType == LoopType.LoopExterior)
                {
                    foreach (Edge AcadEdge in Loop.Edges)
                    {
                        ExternalCurve3d Curve = AcadEdge.Curve as ExternalCurve3d;

                        if (Curve.IsLineSegment)
                        {
                            LineSegment3d LineSeg = Curve.NativeCurve as LineSegment3d;
                            if (IsFirst)
                            {
                                LenghtCurveold = LineSeg.Length;

                                Midpt = GetPt3DFromPoint3D(LineSeg.MidPoint);
                                IsFirst = false;
                            }
                            else if (LenghtCurveold > LineSeg.Length)
                            {
                                LengthofVer = LineSeg.Length;

                                Midpt = GetPt3DFromPoint3D(LineSeg.MidPoint);
                                break;
                            }
                            else if (LenghtCurveold < LineSeg.Length)
                            {
                                LengthofVer = LenghtCurveold;
                                break;
                            }
                        }
                    }
                }
            }

            return Midpt;
        }

        double GetSmallerEdgeFromPlane(FaceData FaceB1)
        {
            double LenghtCurveold = 0;
            bool IsFirst = true;
            double LengthofVer = 0;

            foreach (var Loop in FaceB1.AcadFace.Loops)
            {
                if (Loop.LoopType == LoopType.LoopExterior)
                {
                    foreach (Edge AcadEdge in Loop.Edges)
                    {
                        ExternalCurve3d Curve = AcadEdge.Curve as ExternalCurve3d;

                        if (Curve.IsLineSegment)
                        {
                            LineSegment3d LineSeg = Curve.NativeCurve as LineSegment3d;
                            if (IsFirst)
                            {
                                LenghtCurveold = LineSeg.Length;
                                IsFirst = false;
                            }
                            else if (LenghtCurveold > LineSeg.Length)
                            {
                                LengthofVer = LineSeg.Length;

                                break;
                            }
                            else if (LenghtCurveold < LineSeg.Length)
                            {
                                LengthofVer = LenghtCurveold;
                                break;
                            }
                        }
                    }
                }
            }

            return LengthofVer;
        }

        double GetLargerEdgeFromPlane(FaceData FaceB1)
        {
            double LenghtCurveold = 0;
            bool IsFirst = true;
            double LengthofVer = 0;

            foreach (var Loop in FaceB1.AcadFace.Loops)
            {
                if (Loop.LoopType == LoopType.LoopExterior)
                {
                    foreach (Edge AcadEdge in Loop.Edges)
                    {
                        ExternalCurve3d Curve = AcadEdge.Curve as ExternalCurve3d;

                        if (Curve.IsLineSegment)
                        {
                            LineSegment3d LineSeg = Curve.NativeCurve as LineSegment3d;

                            if (IsFirst)
                            {
                                LenghtCurveold = LineSeg.Length;
                                IsFirst = false;
                            }
                            else if (LenghtCurveold > LineSeg.Length)
                            {
                                LengthofVer = LenghtCurveold;

                                break;
                            }
                            else if (LenghtCurveold < LineSeg.Length)
                            {
                                LengthofVer = LineSeg.Length;

                                break;
                            }
                        }
                    }
                }
            }
            return LengthofVer;
        }

        List<SupporSpecData> GetAllSecondarySupportData(Editor AcadEditor, Transaction AcadTransaction, string LayerName, ref List<SupporSpecData> ListSecondarySuppoData)
        {

            try
            {
                PromptSelectionResult SelectionRes;
                ObjectIdCollection Ents;
                TypedValue[] SelFilterName = new TypedValue[1] { new TypedValue((int)DxfCode.LayerName, LayerName) };
                SelectionFilter SelFilter = new SelectionFilter(SelFilterName);

                SelectionRes = AcadEditor.SelectAll(SelFilter);

                //Getting Object ID of the each selected entiry
                Ents = new ObjectIdCollection(SelectionRes.Value.GetObjectIds());


                int Count = ListSecondarySuppoData.Count + 1;
                foreach (ObjectId Id in Ents)
                {
                    try
                    {
                        var AcEnt = (Entity)AcadTransaction.GetObject(Id, OpenMode.ForRead);
                        dynamic Structureobj = AcEnt.AcadObject;

                        // to explode block of text collect them
                        if (AcEnt.GetType().Name.Contains("ImpCurve"))
                        {
                            SupporSpecData SuppoSpecdata = new SupporSpecData();
                            // Solid3d SLD = AcEnt as Solid3d;

                            SuppoSpecdata.AcadObjID = AcEnt.ObjectId;
                            FillBoundingBox(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.CalculateCentroid();
                            FillDirVec(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.CalculateDist();
                            SuppoSpecdata.CalculateVolume();

                            try
                            {
                                if (Structureobj.PnPClassName == "StructurePlate")
                                {
                                    SuppoSpecdata.Position = new Pt3D(GetPt3DFromArray(Structureobj.PositionPoint));
                                    SuppoSpecdata.SupportName = "PLATE";
                                }
                                else
                                {
                                    double[] StPt = new double[3];
                                    double[] EndPt = new double[3];
                                    SuppoSpecdata.Size = Structureobj.Size;
                                    SuppoSpecdata.StPt = Structureobj.StartPoint;
                                    SuppoSpecdata.EndPt = Structureobj.EndPoint;
                                    SuppoSpecdata.SupportName = Structureobj.PnPClassName;
                                }
                                //  Structureobj.
                            }
                            catch (System.Exception)
                            {
                            }

                            SuppoSpecdata.SuppoId = "S" + Count.ToString();

                            ListSecondarySuppoData.Add(SuppoSpecdata);
                        }
                        else if (AcEnt.GetType() == typeof(Solid3d))
                        {
                            SupporSpecData SuppoSpecdata = new SupporSpecData();
                            Solid3d SLD = AcEnt as Solid3d;

                            SuppoSpecdata.ListfaceData = GetFacesData(SLD);
                            SuppoSpecdata.AcadObjID = AcEnt.ObjectId;
                            GetSmallestEdge(ref SuppoSpecdata);

                            Pt3D Cntrd = new Pt3D();
                            Cntrd.X = Math.Abs(SLD.MassProperties.Centroid[0]);
                            Cntrd.Y = Math.Abs(SLD.MassProperties.Centroid[1]);
                            Cntrd.Z = Math.Abs(SLD.MassProperties.Centroid[2]);
                            SuppoSpecdata.Centroid = Cntrd;
                            FillBoundingBox(AcEnt, ref SuppoSpecdata);
                            FillDirVec(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.Volume = SLD.MassProperties.Volume;
                            SuppoSpecdata.CalculateDist();
                            SuppoSpecdata.SupportName = "PLATE";
                            SuppoSpecdata.SuppoId = "S" + Count.ToString();

                            ListSecondarySuppoData.Add(SuppoSpecdata);
                        }

                        Count++;
                    }
                    catch (System.Exception)
                    {
                    }
                }
            }
            catch (System.Exception)
            {
            }
            return ListSecondarySuppoData;
        }

        void GetSmallestEdge(ref SupporSpecData SuppoSpecdata)
        {
            double EdgeLen = 0.0;
            int inx = 0;
            foreach (FaceData FaCe in SuppoSpecdata.ListfaceData)
            {
                foreach (Edgeinfo Edge in FaCe.ListlinearEdge)
                {
                    if (inx == 0)
                    {
                        EdgeLen = Edge.EdgeLength;
                    }
                    else
                    {
                        if (EdgeLen > Edge.EdgeLength)
                        {
                            EdgeLen = Edge.EdgeLength;
                        }
                    }

                    inx++;
                }
            }

        }

        List<Edgeinfo> GetAllEdgeInfo(Autodesk.AutoCAD.BoundaryRepresentation.Face AcadFace)
        {
            List<Edgeinfo> ListlinearEdge = new List<Edgeinfo>();
            foreach (var Loop in AcadFace.Loops)
            {

                if (Loop.LoopType == LoopType.LoopExterior)
                {
                    foreach (Edge AcadEdge in Loop.Edges)
                    {
                        Edgeinfo EdgeData = new Edgeinfo();
                        ExternalCurve3d Curve = AcadEdge.Curve as ExternalCurve3d;

                        if (Curve.IsLineSegment)
                        {
                            LineSegment3d LineSeg = Curve.NativeCurve as LineSegment3d;

                            EdgeData.DirectionEdge = GetPt3DFromVecData(LineSeg.Direction);
                            EdgeData.StPt = GetPt3DFromPoint3D(LineSeg.StartPoint);
                            EdgeData.EndPt = GetPt3DFromPoint3D(LineSeg.EndPoint);
                            EdgeData.MidPoint = GetPt3DFromPoint3D(LineSeg.MidPoint);
                            EdgeData.EdgeLength = LineSeg.Length;

                            ListlinearEdge.Add(EdgeData);
                        }
                    }
                }
            }

            return ListlinearEdge;
        }

        void CheckforAnchorPlate(Solid3d solid3D, ref SupporSpecData Support)
        {
            int count = 0;
            List<FaceData> AllFaceData = new List<FaceData>();
            using (var Breps = new Autodesk.AutoCAD.BoundaryRepresentation.Brep(solid3D))
            {
                Autodesk.AutoCAD.BoundaryRepresentation.BrepFaceCollection FaceColl = Breps.Faces;

                int Count = FaceColl.Count<Autodesk.AutoCAD.BoundaryRepresentation.Face>();

                // Here we are getting the cuboidal bodies from which we can get diection of the Primary support so we are checking for Faces

                foreach (var FacE in FaceColl)
                {
                    FaceData FaceLoc = new FaceData();

                    FaceLoc.AcadFace = FacE;
                    BoundBlock3d Block3d = FacE.BoundBlock;

                    FaceLoc.SurfaceArea = FacE.GetSurfaceArea();

                    ExternalBoundedSurface ExtBSurf = FacE.Surface as ExternalBoundedSurface;

                    if (ExtBSurf != null)
                    {
                        // ExtBSurf.Is
                        if (ExtBSurf.IsCylinder)
                        {
                            Support.IsAnchor = true;
                            count++;
                        }
                    }
                }
            }

            Support.NoOfAnchoreHole = count;
        }

        List<FaceData> GetFacesData(Solid3d solid3D)
        {
            List<FaceData> AllFaceData = new List<FaceData>();
            using (var Breps = new Autodesk.AutoCAD.BoundaryRepresentation.Brep(solid3D))
            {
                Autodesk.AutoCAD.BoundaryRepresentation.BrepFaceCollection FaceColl = Breps.Faces;

                int Count = FaceColl.Count<Autodesk.AutoCAD.BoundaryRepresentation.Face>();

                // Here we are getting the cuboidal bodies from which we can get diection of the Primary support so we are checking for Faces

                foreach (var FacE in FaceColl)
                {
                    FaceData FaceLoc = new FaceData();

                    FaceLoc.AcadFace = FacE;
                    BoundBlock3d Block3d = FacE.BoundBlock;

                    FaceLoc.SurfaceArea = FacE.GetSurfaceArea();

                    ExternalBoundedSurface ExtBSurf = FacE.Surface as ExternalBoundedSurface;

                    if (ExtBSurf != null)
                    {
                        if (ExtBSurf.IsPlane)
                        {
                            Plane PlaneSurf = ExtBSurf.BaseSurface as Plane;
                            // CoordinateSystem3d CoSym = PlaneSurf.GetCoordinateSystem();
                            GetDirectionFace(ref FaceLoc, PlaneSurf.GetCoordinateSystem());
                            FaceLoc.FaceNormal = PlaneSurf.Normal;
                            FaceLoc.ListlinearEdge = GetAllEdgeInfo(FaceLoc.AcadFace);

                        }
                    }

                    AllFaceData.Add(FaceLoc);
                }
            }

            return AllFaceData;
        }

        void GetDirectionFace(ref FaceData FaceLoc, CoordinateSystem3d CoSym)
        {
            DirectionVec DirVec = new DirectionVec();
            DirVec.XDirVec = GetPt3DFromVecData(CoSym.Xaxis);
            DirVec.YDirVec = GetPt3DFromVecData(CoSym.Yaxis);
            DirVec.ZDirVec = GetPt3DFromVecData(CoSym.Zaxis);

            FaceLoc.Directionvecface = DirVec;
            FaceLoc.AngleData = GetRotationFromVec(DirVec);
        }

        List<SupporSpecData> GetAllConcreteSupportData(Editor AcadEditor, Transaction AcadTransaction, string LayerName, ref List<SupporSpecData> ListConcreteSupportData)
        {
            try
            {
                PromptSelectionResult SelectionRes;
                ObjectIdCollection Ents;
                TypedValue[] SelFilterName = new TypedValue[1] { new TypedValue((int)DxfCode.LayerName, LayerName) };
                SelectionFilter SelFilter = new SelectionFilter(SelFilterName);

                SelectionRes = AcadEditor.SelectAll(SelFilter);

                //Getting Object ID of the each selected entiry
                Ents = new ObjectIdCollection(SelectionRes.Value.GetObjectIds());

                int Count = ListConcreteSupportData.Count + 1;
                foreach (ObjectId Id in Ents)
                {
                    try
                    {
                        var AcEnt = (Entity)AcadTransaction.GetObject(Id, OpenMode.ForRead);

                        // to explode block of text collect them
                        if (AcEnt.GetType() == typeof(Solid3d))
                        {
                            SupporSpecData SuppoSpecdata = new SupporSpecData();
                            Solid3d SLD = AcEnt as Solid3d;

                            SuppoSpecdata.AcadObjID = AcEnt.ObjectId;

                            CheckforAnchorPlate(SLD, ref SuppoSpecdata);
                            SuppoSpecdata.ListfaceData = GetFacesData(SLD);
                            Pt3D Cntrd = new Pt3D();
                            Cntrd.X = Math.Abs(SLD.MassProperties.Centroid[0]);
                            Cntrd.Y = Math.Abs(SLD.MassProperties.Centroid[1]);
                            Cntrd.Z = Math.Abs(SLD.MassProperties.Centroid[2]);
                            SuppoSpecdata.Centroid = Cntrd;
                            FillBoundingBox(AcEnt, ref SuppoSpecdata);
                            FillDirVec(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.Volume = SLD.MassProperties.Volume;
                            SuppoSpecdata.CalculateDist();
                            SuppoSpecdata.SuppoId = "C" + Count.ToString();

                            ListConcreteSupportData.Add(SuppoSpecdata);
                        }
                        else if (AcEnt.GetType().Name.Contains("ImpCurve"))
                        {
                            SupporSpecData SuppoSpecdata = new SupporSpecData();
                            // Solid3d SLD = AcEnt as Solid3d;

                            SuppoSpecdata.AcadObjID = AcEnt.ObjectId;
                            dynamic Structureobj = AcEnt.AcadObject;
                            FillBoundingBox(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.CalculateCentroid();
                            FillDirVec(AcEnt, ref SuppoSpecdata);
                            SuppoSpecdata.CalculateDist();
                            SuppoSpecdata.CalculateVolume();

                            try
                            {
                                if (Structureobj.PnPClassName == "StructurePlate")
                                {
                                    SuppoSpecdata.Position = new Pt3D(GetPt3DFromArray(Structureobj.PositionPoint));
                                    SuppoSpecdata.SupportName = "PLATE";
                                }
                                else
                                {
                                    double[] StPt = new double[3];
                                    double[] EndPt = new double[3];
                                    SuppoSpecdata.Size = Structureobj.Size;
                                    SuppoSpecdata.StPt = Structureobj.StartPoint;
                                    SuppoSpecdata.EndPt = Structureobj.EndPoint;
                                }
                                //  Structureobj.
                            }
                            catch (System.Exception)
                            {
                            }

                            SuppoSpecdata.SuppoId = "C" + Count.ToString();

                            ListConcreteSupportData.Add(SuppoSpecdata);
                        }

                        Count++;
                    }
                    catch (Exception)
                    {
                    }
                }

            }
            catch (Exception)
            {
            }
            return ListConcreteSupportData;
        }

        void CompareSupport()
        {
            //First we need to compare supports types are matching

            IsSupportSizematching();
        }

        bool IsSupportSizematching()
        {
            //Temporarly using Support to compare 

            return false;
        }
        public void ProcessSupportData()
        {
            ProcessSuppoerD();
        }

        public void ProcessSuppoerD()
        {
            int CompletSCountCount = 0;
            int OnlyPrimaryCount = 0;
            int WithoutPrimCount = 0;
            int count = 0;

            foreach (SupportData Data in ListCentalSuppoData)
            {
                CheckRotationtTogetType(Data);
                if (Data.ListConcreteData.Count > 0 && Data.ListPrimarySuppo.Count > 0 && Data.ListSecondrySuppo.Count > 0)
                {
                    CompletSCountCount++;
                }
                else if (Data.ListConcreteData.Count == 0 && Data.ListPrimarySuppo.Count > 0 && Data.ListSecondrySuppo.Count == 0)
                {
                    OnlyPrimaryCount++;
                }
                else if (Data.ListConcreteData.Count > 0 && Data.ListPrimarySuppo.Count == 0 && Data.ListSecondrySuppo.Count > 0)
                {
                    WithoutPrimCount++;
                }
                if (Data.SupportType != null && Data.SupportType.Length > 0)
                {
                    if (Data.SupportType.ToUpper().Equals("SUPPORT13"))
                    {

                    }
                    else
                    {
                        Logger.GetInstance.Debug("Detected Support type =" + Data.SupportType);
                        count++;
                    }

                    if (Data.Name != null && Data.Name.Length > 0)
                    {
                        Logger.GetInstance.Debug("Detected Support type =" + Data.Name);
                    }
                }
            }

#if _DEBUG
            Logger.GetInstance.Debug("Detected Support Count =" + count.ToString());

            Logger.GetInstance.Debug("Complete Support Count =" + CompletSCountCount.ToString());
            Logger.GetInstance.Debug("Only Primary Support Count =" + OnlyPrimaryCount.ToString());
            Logger.GetInstance.Debug("Without Primary Support Count =" + WithoutPrimCount.ToString());
#endif 
        }

        void CheckRotationtTogetType(SupportData SData)
        {
            SupportData SupportData = GetRotationofParts(SData);

            ProcessDicDataToGetType(SupportData);
        }

        int GetAngleCount(SupportData SuppData)
        {
            int AngleCount = 0;
            foreach (var Spart in SuppData.ListSecondrySuppo)
            {
                if (Spart.Size != null && (Spart.Size.ToUpper().Contains("ANGLE") || Spart.Size.ToUpper().Contains("L-") || Spart.Size.ToUpper().Contains("ISA")) && !(Spart.Size.ToUpper().Contains("WEB")))
                {
                    AngleCount++;
                }
            }
            return AngleCount;
        }

        void ProcessDicDataToGetType(SupportData SupportData)
        {
            int CSupportCount = SupportData.ListConcreteData.Count;
            int PSupportCount = SupportData.ListPrimarySuppo.Count;
            int SSupportCount = SupportData.ListSecondrySuppo.Count;

            if (CSupportCount == 0 && PSupportCount == 1 && SSupportCount == 0)
            {
                SupportData.SupportType = "Support13";
            }
            else if (CSupportCount == 0 && PSupportCount == 0 && SSupportCount == 1)
            {
                if (GetAllISMC(SupportData).Count == 1)
                {
                    SupportData.SupportType = "Support57";
                }
            }
            else if (CSupportCount == 0 && PSupportCount == 0 && SSupportCount == 2)
            {
                CheckforTypeSupport54(ref SupportData);
            }
            else if (CSupportCount == 1 && PSupportCount == 0 && SSupportCount == 1)
            {
                CheckforTypeSupport58(ref SupportData);

            }
            else if (CSupportCount == 1 && PSupportCount > 0 && SSupportCount == 1)
            {
                CheckforTypeSupport58(ref SupportData);

            }
            else if (CSupportCount == 3 && SSupportCount == 2)
            {
                CheckforTypeSupport60(ref SupportData);
                Logger.GetInstance.Debug(PSupportCount.ToString() + "Log");
            }
            else if (CSupportCount == 0 && PSupportCount == 1 && SSupportCount == 1)
            {
                if (!CheckforTypeSupport14(ref SupportData))
                {
                    if (SupportData.ListSecondrySuppo[0].Size != null)
                    {
                        if ((SupportData.ListSecondrySuppo[0].Size.ToUpper().Contains("ANGLE") || SupportData.ListSecondrySuppo[0].Size.ToUpper().Contains("L-")) && !(SupportData.ListSecondrySuppo[0].Size.ToUpper().Contains("WEB")))
                        {
                            CheckforTypeSupport35(ref SupportData);
                        }
                    }
                }
            }
            else if (CSupportCount == 1 && PSupportCount == 1 && SSupportCount == 1)
            {
                CheckforTypeSupport14(ref SupportData);
            }
            else if (CSupportCount == 1 && PSupportCount == 2 && SSupportCount == 1)
            {
                CheckforTypeSupport86(ref SupportData);
            }
            else if (CSupportCount == 0 && PSupportCount == 1 && SSupportCount == 2)
            {
                if (!CheckforTypeSupport3(ref SupportData))
                {
                    if (!CheckforTypeSupport2(ref SupportData))
                    {
                        if (!CheckforTypeSupport4(ref SupportData))
                        {
                            if (SupportData.ListSecondrySuppo.Any(x => x.SupportName == "PLATE"))
                            {
                                if (CheckforTypeSupport8(ref SupportData))
                                {

                                }
                            }
                            /*else if (SupportData.ListSecondrySuppo.Any(x => x.Size.ToUpper().Contains("L-")))
                            {
                               // CheckforTypeSupport36()
                            }*/

                        }
                    }
                }
            }
            else if (CSupportCount == 0 && PSupportCount == 1 && SSupportCount == 3)
            {
                int NoofAngles = GetAngleCount(SupportData);
                if (NoofAngles == 3)
                {
                    CheckforTypeSupport38(ref SupportData);
                }
            }
            else if (CSupportCount == 1 && PSupportCount == 1 && SSupportCount == 2)
            {
                if (!CheckforTypeSupport2(ref SupportData))
                {
                    if (!CheckforTypeSupport4(ref SupportData))
                    {
                        if (!CheckforTypeSupport50(ref SupportData))
                        {
                            if (SupportData.ListSecondrySuppo.Any(x => x.SupportName == "PLATE"))
                            {
                                if (!CheckforTypeSupport8(ref SupportData))
                                {

                                }
                            }
                        }
                    }
                }
            }
            else if ((CSupportCount == 2 || CSupportCount == 1) && (PSupportCount == 0 || PSupportCount == 4 || PSupportCount == 2 || PSupportCount == 6 || PSupportCount == 7 || PSupportCount == 3 || PSupportCount == 1 || PSupportCount == 5) && (SSupportCount == 6 || SSupportCount == 2 || SSupportCount == 4 || SSupportCount == 5))
            {
                if (GetGussetCout(ref SupportData) == 4)
                {
                    if (!CheckforTypeSupport50(ref SupportData))
                    {
                        if (!CheckforTypeSupport64(ref SupportData))
                        {
                            if (!CheckforTypeSupport74(ref SupportData))
                            {
                                CheckforTypeSupport80(ref SupportData);
                            }
                        }
                    }
                }
                if (GetGussetCout(ref SupportData) == 0)
                {
                    if (!CheckforTypeSupport50(ref SupportData))
                    {
                        CheckforTypeSupport80(ref SupportData);
                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 9 && SSupportCount == 6 || CSupportCount == 2 && PSupportCount == 8 && SSupportCount == 6 || CSupportCount == 2 && PSupportCount == 4 && SSupportCount == 6
                  || CSupportCount == 2 && PSupportCount == 3 && SSupportCount == 6
                  || CSupportCount == 1 && PSupportCount == 4 && SSupportCount == 2
                  || CSupportCount == 1 && PSupportCount == 2 && SSupportCount == 2)
            {
                if (GetGussetCout(ref SupportData) == 4)
                {
                    if (!CheckforTypeSupport85(ref SupportData))
                    {
                        if (!CheckforTypeSupport64(ref SupportData))
                        {
                            CheckforTypeSupport74(ref SupportData);
                        }
                    }
                }
                /*if (GetGussetCout(ref SupportData) == 0)
                {
                    if (!CheckforTypeSupport50(ref SupportData))
                    {
                        CheckforTypeSupport80(ref SupportData);
                    }
                }*/
            }
            else if (CSupportCount == 2 && PSupportCount == 1 && SSupportCount == 2)
            {
                if (!CheckforTypeSupport2(ref SupportData))
                {
                    if (!CheckforTypeSupport4(ref SupportData))
                    {
                        if (SupportData.ListSecondrySuppo.Any(x => x.SupportName == "PLATE"))
                        {
                            if (CheckforTypeSupport8(ref SupportData))
                            {

                            }
                        }
                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 1 && SSupportCount == 4)
            {
                if (GetGussetCout(ref SupportData) == 2)
                    CheckforTypeSupport34(ref SupportData);
            }
            else if (CSupportCount == 2 && PSupportCount == 2 && SSupportCount == 3)
            {
                if (!CheckforTypeSupport22(ref SupportData))
                {
                    if (!CheckforTypeSupport6(ref SupportData))
                    {
                        if (!CheckforTypeSupport30(ref SupportData))
                        {
                            CheckforTypeSupport74(ref SupportData);
                        }
                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 3 && SSupportCount == 4 || CSupportCount == 2 && PSupportCount == 4 && SSupportCount == 3 || CSupportCount == 2 && PSupportCount == 4 && SSupportCount == 2)
            {
                CheckforTypeSupport74(ref SupportData);
            }
            else if (CSupportCount == 2 && PSupportCount == 2 && SSupportCount == 4)
            {
                CheckforTypeSupport43(ref SupportData);
            }
            else if (CSupportCount == 2 && PSupportCount == 2 && SSupportCount == 2)
            {
                CheckforTypeSupport7(ref SupportData);
            }
            else if ((CSupportCount == 2 || CSupportCount == 1) && (PSupportCount == 1 || PSupportCount == 0 || PSupportCount == 2) && SSupportCount == 3)
            {
                if (!CheckforTypeSupport31(ref SupportData))
                {
                    CheckforTypeSupport64(ref SupportData);
                }
            }
            else if (CSupportCount == 1 && PSupportCount == 0 && SSupportCount == 4)
            {
                CheckforTypeSupport64(ref SupportData);
            }
            else if (CSupportCount == 2 && PSupportCount == 2 && SSupportCount == 3)
            {

            }
            else if (CSupportCount == 1 && PSupportCount == 2 && SSupportCount == 3)
            {
                if (!CheckforTypeSupport22(ref SupportData))
                {
                    if (!CheckforTypeSupport6(ref SupportData))
                    {

                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 3 && SSupportCount == 4)
            {
                if (!CheckforTypeSupport32(ref SupportData))
                {
                    CheckforTypeSupport36(ref SupportData);
                }
            }
            else if (CSupportCount == 1 && PSupportCount == 2 && SSupportCount == 2)
            {
                CheckforTypeSupport7(ref SupportData);
            }
            else if (CSupportCount == 1 && PSupportCount == 2 && SSupportCount == 4)
            {
                try
                {
                    if (Checkforangle(ref SupportData))
                    {
                        CheckforTypeSupport20(ref SupportData);
                    }
                    else
                    {
                        CheckforTypeSupport41(ref SupportData);
                    }

                }
                catch (Exception)
                {
                }
            }
            else if (CSupportCount == 1 && PSupportCount == 3 && SSupportCount == 4)
            {

                CheckforTypeSupport18(ref SupportData);
            }
            else if (CSupportCount == 1 && PSupportCount == 3 && SSupportCount == 5)
            {
                if (!CheckforTypeSupport19(ref SupportData))
                {
                    CheckforTypeSupport80(ref SupportData);
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 1 && SSupportCount == 7 || CSupportCount == 2 && PSupportCount == 2 && SSupportCount == 7)
            {
                if (HasWord(SupportData.ListSecondrySuppo, "NB"))
                {

                    //CheckforTypeSupport28(ref SupportData);
                    //Need to Add Check for Primary Sup
                    CheckforTypeSupport25(ref SupportData);
                }
            }

            else if (CSupportCount == 2 && PSupportCount == 1 && SSupportCount == 7 || CSupportCount == 2 && PSupportCount == 2 && SSupportCount == 7 || CSupportCount == 2 && PSupportCount == 4 && SSupportCount == 7)
            {
                if (HasWord(SupportData.ListSecondrySuppo, "NB"))
                {

                    //CheckforTypeSupport28(ref SupportData);
                    //Need to Add Check for Primary Sup
                    CheckforTypeSupport25(ref SupportData);
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 1 && SSupportCount == 8)
            {
                if (HasWord(SupportData.ListSecondrySuppo, "NB"))
                {
                    if (GetAngleCount(SupportData) == 1)
                    {
                        CheckforTypeSupport29(ref SupportData);
                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 1 && SSupportCount == 9)
            {
                if (HasWord(SupportData.ListSecondrySuppo, "NB"))
                {
                    if (GetAngleCount(SupportData) == 2)
                    {
                        CheckforTypeSupport48(ref SupportData);
                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 2 && SSupportCount == 8)
            {
                if (HasWord(SupportData.ListSecondrySuppo, "NB"))
                {
                    //Need to Add Check for Primary Sup
                    CheckforTypeSupport27(ref SupportData);
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 3 && SSupportCount == 11)
            {
                if (HasWord(SupportData.ListSecondrySuppo, "NB"))
                {
                    if (GetAngleCount(SupportData) == 2)
                    {
                        CheckforTypeSupport47(ref SupportData);
                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 3 && SSupportCount == 10)
            {
                if (HasWord(SupportData.ListSecondrySuppo, "NB"))
                {
                    if (GetAngleCount(SupportData) == 1)
                    {
                        CheckforTypeSupport49(ref SupportData);
                    }
                }
            }
            else if (CSupportCount == 2 && PSupportCount == 0 && SSupportCount == 8 || CSupportCount == 2 && PSupportCount == 0 && SSupportCount == 7 || CSupportCount == 2 && PSupportCount == 7 && SSupportCount == 8
                || CSupportCount == 2 && PSupportCount == 4 && SSupportCount == 8)
            {
                CheckforTypeSupport70(ref SupportData);
            }
        }

        bool CheckforTypeSupport80(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();

            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
            DicMidistPt = CheckforMidDist(SupData);

            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            DicDistConSup = GetminDistFromConcrete(SupData);

            string Id = GetMinDistFromDic(DicDistConSup);

            string VerPartId = "";
            foreach (var Part in CombinedParSupp)
            {
                if (Part.Count == 1)
                {
                    if (Part[0] == Id)
                    {
                        VerPartId = Id;
                        break;
                    }
                }
            }

            if (VerPartId.Length < 1)
            {
                return false;
            }

            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

            List<Vector3D> ListVecData = new List<Vector3D>();

            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

            double maxValue = 0;
            string MaxValueID = "";

            foreach (var DicData in DicDistConSup)
            {
                if (DicData.Value > maxValue)
                {
                    maxValue = DicData.Value;
                    MaxValueID = DicData.Key;
                }
            }

            if (CheckVectorsArePlaner(ListVecData))
            {
                int NevAngleCount = 0;
                int PosAngleCount = 0;
                List<string> ListNevPartId = new List<string>();
                List<string> ListPosPartId = new List<string>();
                foreach (var AngleData in DicAngleData)
                {
                    if (AngleData.Value.Angle.Equals(90))
                    {
                        PosAngleCount++;
                        ListPosPartId.Add(AngleData.Key);
                    }
                    else if (AngleData.Value.Angle.Equals(-90))
                    {
                        NevAngleCount++;
                        ListNevPartId.Add(AngleData.Key);
                    }
                }

                if (DicAngleData.Count == 1 && PosAngleCount == 1)
                {
                    if ((Math.Abs(Math.Round(GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree))).Equals(90) && Math.Abs(Math.Round(GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)) && GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z <= GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z && GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Centroid.Z <= GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z)
                    {
                        SupData.SupportType = "Support80";
                        return true;
                    }
                }
            }
            else
            {
                if ((DicIndexData.Count == 4 || DicIndexData.Count == 5) && CombinedParSupp.Count == 3 && (DicMidistPt.Count == 1 || DicMidistPt.Count == 2))
                {
                    ListVecData = new List<Vector3D>();
                    List<string> SupportstobeExcluded = new List<string>();
                    List<string> ListPerPartID = new List<string>();

                    foreach (var CSuppo in DicMidistPt)
                    {
                        SupportstobeExcluded.Add(CSuppo.Key);
                        ListPerPartID.Add(CSuppo.Key);
                    }

                    DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData, SupportstobeExcluded);

                    if (CheckVectorsArePlaner(ListVecData))
                    {
                        int NevAngleCount = 0;
                        int PosAngleCount = 0;
                        List<string> ListNevPartId = new List<string>();
                        List<string> ListPosPartId = new List<string>();

                        foreach (var AngleData in DicAngleData)
                        {
                            if (AngleData.Value.Angle.Equals(90))
                            {
                                PosAngleCount++;
                                ListPosPartId.Add(AngleData.Key);
                            }
                            else if (AngleData.Value.Angle.Equals(-90))
                            {
                                NevAngleCount++;
                                ListNevPartId.Add(AngleData.Key);
                            }
                        }

                        if (ListPosPartId.Count == 2)
                        {

                            if (ListPerPartID.Count == 1 && DicIndexData.Count == 4)
                            {
                                if (GetTouchingPrimaryCount(GetPartbyId(ListPerPartID[0], SupData.ListSecondrySuppo).ListtouchingParts) == 2 && GetGRPFLGCount(SupData.ListPrimarySuppo) == 2)
                                {
                                    if (GetPartbyId(ListPosPartId[0], SupData.ListSecondrySuppo).Boundingboxmax.Z > GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Boundingboxmax.Z)
                                    {
                                        if (GetPartbyId(ListPerPartID[0], SupData.ListSecondrySuppo).ListtouchingParts.Contains(ListPosPartId[0]))
                                        {
                                            if (Math.Round(GetPartbyId(ListPosPartId[0], SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)) && Math.Abs(Math.Round(GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)).Equals(180))
                                            {
                                                SupData.SupportType = "Support104";
                                            }
                                            else if (SupData.ListPrimarySuppo.Count == 3 && GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).ListtouchingParts.Count == 2 && Math.Round(GetPartbyId(ListPosPartId[0], SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)) && Math.Round(GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)))
                                            {
                                                SupData.SupportType = "Support107";
                                            }
                                        }
                                        else if (GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Boundingboxmax.Z > GetPartbyId(ListPosPartId[0], SupData.ListSecondrySuppo).Boundingboxmax.Z)
                                        {
                                            if (GetPartbyId(ListPerPartID[0], SupData.ListSecondrySuppo).ListtouchingParts.Contains(ListPosPartId[1]))
                                            {
                                                if (Math.Round(GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)) && Math.Abs(Math.Round(GetPartbyId(ListPosPartId[0], SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)).Equals(180))
                                                {
                                                    SupData.SupportType = "Support104";

                                                }
                                                else if (SupData.ListPrimarySuppo.Count == 3 && GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).ListtouchingParts.Count == 2 && Math.Round(GetPartbyId(ListPosPartId[0], SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)) && Math.Round(GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)))
                                                {
                                                    SupData.SupportType = "Support107";
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            else if (ListPerPartID.Count == 2)
                            {
                                if (GetPartbyId(ListPosPartId[0], SupData.ListSecondrySuppo).Angle.ZinDegree.Equals(GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Angle.ZinDegree) && Math.Round(GetPartbyId(ListPosPartId[1], SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree)))
                                {
                                    if (GetTouchingPrimaryCount(GetPartbyId(ListPerPartID[0], SupData.ListSecondrySuppo).ListtouchingParts) == 2 && GetTouchingPrimaryCount(GetPartbyId(ListPerPartID[1], SupData.ListSecondrySuppo).ListtouchingParts) == 2 && SupData.ListPrimarySuppo.Count == 4 && GetGRPFLGCount(SupData.ListPrimarySuppo) == 4)
                                    {
                                        SupData.SupportType = "Support105";

                                    }
                                }
                            }

                            if (SupData.SupportType == "Support105" || SupData.SupportType == "Support104")
                            {
                                foreach (var SData in SupData.ListSecondrySuppo)
                                {
                                    if (SData.SuppoId != null && SData.SuppoId.Equals(VerPartId))
                                    {
                                        SData.PartDirection = "Ver";

                                    }
                                    else if (SData.SuppoId != null && ListPosPartId.Contains(SData.SuppoId) || ListNevPartId.Contains(SData.SuppoId))
                                    {
                                        if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                        {
                                            SData.PartDirection = "Hor";

                                        }
                                    }
                                    else if (SData.SuppoId != null && ListPerPartID.Contains(SData.SuppoId) && DicMidistPt.ElementAt(0).Key.Equals(SData.SuppoId))
                                    {
                                        SData.SuppoId = "3DHOR";
                                    }

                                }

                                return true;
                            }

                        }
                    }

                }
            }
            return false;
        }

        int GetGRPFLGCount(List<SupporSpecData> ListSuppoData)
        {
            int GRPCount = 0;
            foreach (var Sup in ListSuppoData)
            {
                if (Sup.SupportName.ToUpper().Contains("GRP FLG"))
                {
                    GRPCount++;
                }
            }

            return GRPCount;
        }

        bool CheckforTypeSupport74(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();

            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
            DicMidistPt = CheckforMidDist(SupData);

            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            DicDistConSup = GetminDistFromConcrete(SupData);

            string Id = GetMinDistFromDic(DicDistConSup);

            string VerPartId = "";
            foreach (var Part in CombinedParSupp)
            {
                if (Part.Count == 1)
                {
                    if (Part[0] == Id)
                    {
                        VerPartId = Id;
                        break;
                    }
                }
            }

            if (VerPartId.Length < 1)
            {
                return false;
            }

            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

            List<Vector3D> ListVecData = new List<Vector3D>();

            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

            double maxValue = 0;
            string MaxValueID = "";

            foreach (var DicData in DicDistConSup)
            {
                if (DicData.Value > maxValue)
                {
                    maxValue = DicData.Value;
                    MaxValueID = DicData.Key;
                }
            }

            if (CheckVectorsArePlaner(ListVecData))
            {
                int NevAngleCount = 0;
                int PosAngleCount = 0;
                List<string> ListNevPartId = new List<string>();
                List<string> ListPosPartId = new List<string>();
                foreach (var AngleData in DicAngleData)
                {
                    if (AngleData.Value.Angle.Equals(90))
                    {
                        PosAngleCount++;
                        ListPosPartId.Add(AngleData.Key);
                    }
                    else if (AngleData.Value.Angle.Equals(-90))
                    {
                        NevAngleCount++;
                        ListNevPartId.Add(AngleData.Key);
                    }
                }

                if (DicAngleData.Count == 1)
                {
                    if ((Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree))).Equals(180) && Math.Abs(Math.Round(GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(180) && GetTouchingPrimaryCount(GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 4 && GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z <= GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z && GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Centroid.Z <= GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z)
                    {
                        SupData.SupportType = "Support79";
                        return true;
                    }
                }
                else if (DicAngleData.Count == 2)
                {
                    if ((Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree))).Equals(180) && GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree.Equals(Math.Round(GetPartbyId(DicAngleData.ElementAt(1).Key, SupData.ListSecondrySuppo).Angle.XinDegree)) && GetTouchingPrimaryCount(GetPartbyId(DicAngleData.ElementAt(1).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 1 && GetTouchingPrimaryCount(GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 1)
                    {
                        if (NevAngleCount == 2)
                        {
                            SupData.SupportType = "Support74";
                            return true;
                        }
                        else if (PosAngleCount == 2)
                        {
                            SupData.SupportType = "Support76";
                            return true;
                        }
                    }
                    else if ((Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree))).Equals(180) && (GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree.Equals(Math.Round(GetPartbyId(DicAngleData.ElementAt(1).Key, SupData.ListSecondrySuppo).Angle.XinDegree)) || ((Math.Abs(Math.Round(GetPartbyId(DicAngleData.ElementAt(1).Key, SupData.ListSecondrySuppo).Angle.XinDegree - GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree))).Equals(180)) && NevAngleCount == 1 && PosAngleCount == 1))
                    {
                        if (GetTouchingPrimaryCount(GetPartbyId(ListNevPartId[0], SupData.ListSecondrySuppo).ListtouchingParts) == 3 && GetTouchingPrimaryCount(GetPartbyId(ListNevPartId[0], SupData.ListSecondrySuppo).ListtouchingParts) == 1)
                        {
                            double Dist1 = GetPerpendicuarFootDist(ListNevPartId[0], VerPartId, SupData);
                            double Dist2 = GetPerpendicuarFootDist(ListPosPartId[0], VerPartId, SupData);

                            if (Dist1 > Dist2)
                            {
                                SupData.SupportType = "Support78";
                                return true;
                            }
                        }
                    }
                }
                else if (DicAngleData.Count == 3)
                {
                    if ((Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree))).Equals(180) && GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree.Equals(Math.Round(GetPartbyId(DicAngleData.ElementAt(1).Key, SupData.ListSecondrySuppo).Angle.XinDegree)) &&
                         GetPartbyId(DicAngleData.ElementAt(2).Key, SupData.ListSecondrySuppo).Angle.XinDegree.Equals(Math.Round(GetPartbyId(DicAngleData.ElementAt(1).Key, SupData.ListSecondrySuppo).Angle.XinDegree)) && GetTouchingPrimaryCount(GetPartbyId(DicAngleData.ElementAt(1).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 1 && GetTouchingPrimaryCount(GetPartbyId(DicAngleData.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 1 && GetTouchingPrimaryCount(GetPartbyId(DicAngleData.ElementAt(2).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 1)
                    {
                        if (NevAngleCount == 3)
                        {
                            SupData.SupportType = "Support75";
                            return true;
                        }
                        else if (PosAngleCount == 3)
                        {
                            SupData.SupportType = "Support77";
                            return true;
                        }
                    }
                }
            }

            return false;
        }

        double GetPerpendicuarFootDist(string ParId, string VerPart, SupportData SupData)
        {

            double Dist = 0;
            Point3d PerFoot = FindPerpendicularFoot(GetPt3DFromArray(
            GetPartbyId(ParId, SupData.ListSecondrySuppo).StPt), GetPartbyId(VerPart, SupData.ListSecondrySuppo).StPt, GetPartbyId(VerPart, SupData.ListSecondrySuppo).EndPt);


            return Calculate.DistPoint(GetPt3DFromPoint3D(PerFoot), SupData.ListConcreteData[0].Centroid);
        }

        bool CheckforTypeSupport70(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();

            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
            DicMidistPt = CheckforMidDist(SupData);

            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            DicDistConSup = GetminDistFromConcrete(SupData);

            string Id = GetMinDistFromDic(DicDistConSup);

            string VerPartId = "";
            foreach (var Part in CombinedParSupp)
            {
                if (Part.Count == 1)
                {
                    if (Part[0] == Id)
                    {
                        VerPartId = Id;
                        break;
                    }
                }
            }

            if (VerPartId.Length < 1)
            {
                return false;
            }

            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

            List<Vector3D> ListVecData = new List<Vector3D>();

            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

            double maxValue = 0;
            string MaxValueID = "";

            foreach (var DicData in DicDistConSup)
            {
                if (DicData.Value > maxValue)
                {
                    maxValue = DicData.Value;
                    MaxValueID = DicData.Key;
                }
            }

            if (DicMidistPt != null && DicMidistPt.Count == 1 && CheckVectorsArePlaner(ListVecData))
            {
                if ((GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z) <= (GetPartbyId(MaxValueID, SupData.ListSecondrySuppo).Boundingboxmax.Z))
                {
                    if (MaxValueID.Equals(DicMidistPt.ElementAt(0).Key))
                    {
                        int Pos90Count = 0;
                        int Nev90Count = 0;
                        int InclinedPos = 0;
                        int InclinedNev = 0;
                        List<string> PosId = new List<string>();
                        List<string> NevId = new List<string>();
                        List<string> PosIncli = new List<string>();
                        List<string> NevIncli = new List<string>();
                        foreach (var data in DicAngleData)
                        {
                            if (DicMidistPt.ElementAt(0).Key.Equals(data.Key))
                            {
                                continue;
                            }

                            if (Math.Round(data.Value.Angle).Equals(90))
                            {
                                Pos90Count++;
                                PosId.Add(data.Key);
                            }
                            else if (Math.Round(data.Value.Angle).Equals(-90))
                            {
                                Nev90Count++;
                                NevId.Add(data.Key);
                            }
                            else if (Math.Round(data.Value.Angle).Equals(-45))
                            {
                                NevIncli.Add(data.Key);
                                InclinedNev++;
                            }
                            else if (Math.Round(data.Value.Angle).Equals(45))
                            {
                                PosIncli.Add(data.Key);
                                InclinedPos++;
                            }
                        }

                        int HorAngleCount = 0;
                        int InclinedAngle = 0;

                        SupporSpecData SupDataHor = new SupporSpecData();
                        SupporSpecData SupDataVer = new SupporSpecData();
                        SupporSpecData SupDataInc1 = new SupporSpecData();
                        SupporSpecData SupDataInc2 = new SupporSpecData();
                        if (InclinedPos == 1 && InclinedNev == 1)
                        {
                            foreach (var SData in SupData.ListSecondrySuppo)
                            {
                                if (DicMidistPt.ElementAt(0).Key.Equals(SData.SuppoId))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                    SupDataHor = SData;
                                }
                                else if (SData.SuppoId != null && PosId.Contains(SData.SuppoId))
                                {
                                    if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                    {
                                        SData.PartDirection = "Hor";
                                        HorAngleCount++;
                                    }
                                }
                                else if (SData.SuppoId != null && SData.SuppoId.Equals(VerPartId))
                                {
                                    SData.PartDirection = "Ver";
                                    SupDataVer = SData;
                                }
                                else if (SData.SuppoId != null && NevId.Contains(SData.SuppoId))
                                {
                                    if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                    {
                                        SData.PartDirection = "Hor";
                                        HorAngleCount++;
                                    }
                                }
                                else if (SData.SuppoId != null && PosIncli.Contains(SData.SuppoId))
                                {
                                    if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(45) || Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(135))
                                    {
                                        SData.PartDirection = "45Inclined";
                                        InclinedAngle++;

                                        SupDataInc1 = SData;
                                    }
                                }
                                else if (SData.SuppoId != null && NevIncli.Contains(SData.SuppoId))
                                {
                                    if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(45) || Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(135))
                                    {
                                        SData.PartDirection = "45Inclined";
                                        InclinedAngle++;

                                        SupDataInc2 = SData;
                                    }
                                }
                            }

                            if (SupDataHor.ListtouchingParts.Contains(SupDataInc1.SuppoId) && SupDataHor.ListtouchingParts.Contains(SupDataInc1.SuppoId) &&
                                SupDataVer.ListtouchingParts.Contains(SupDataInc1.SuppoId) && SupDataVer.ListtouchingParts.Contains(SupDataInc1.SuppoId) && InclinedAngle == 2)
                            {
                                if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 7)
                                {
                                    SupData.SupportType = "Support92";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 4)
                                {
                                    SupData.SupportType = "Support93";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 0)
                                {
                                    SupData.SupportType = "Support70";
                                    return true;
                                }
                            }
                        }
                        else if (InclinedNev == 1 && Nev90Count == 1)
                        {
                            foreach (var SData in SupData.ListSecondrySuppo)
                            {
                                if (DicMidistPt.ElementAt(0).Key.Equals(SData.SuppoId))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                    SupDataHor = SData;
                                }
                                else if (SData.SuppoId != null && PosId.Contains(SData.SuppoId))
                                {
                                    if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                    {
                                        SData.PartDirection = "Hor";
                                        HorAngleCount++;
                                    }
                                }
                                else if (SData.SuppoId != null && SData.SuppoId.Equals(VerPartId))
                                {
                                    SData.PartDirection = "Ver";
                                    SupDataVer = SData;
                                }
                                else if (SData.SuppoId != null && NevId.Contains(SData.SuppoId))
                                {
                                    if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                    {
                                        SData.PartDirection = "Hor";

                                        HorAngleCount++;
                                    }
                                }

                                else if (SData.SuppoId != null && NevIncli.Contains(SData.SuppoId))
                                {
                                    if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(45) || Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(135))
                                    {
                                        SData.PartDirection = "45Inclined";
                                        InclinedAngle++;

                                        SupDataInc2 = SData;
                                    }
                                }
                            }

                            if (GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z > GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z && GetPartbyId(NevIncli[0], SupData.ListSecondrySuppo).ListtouchingParts.Contains(NevId[0]) && GetPartbyId(NevIncli[0], SupData.ListSecondrySuppo).ListtouchingParts.Contains(VerPartId))
                            {
                                SupData.SupportType = "Support81";
                                return true;
                            }
                        }
                    }
                }
            }
            else if ((DicMidistPt == null || DicMidistPt.Count == 0) && CheckVectorsArePlaner(ListVecData))
            {
                if ((GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z) <= (GetPartbyId(MaxValueID, SupData.ListSecondrySuppo).Boundingboxmax.Z))
                {
                    int Pos90Count = 0;
                    int Nev90Count = 0;
                    int InclinedPos = 0;
                    int InclinedNev = 0;
                    List<string> PosId = new List<string>();
                    List<string> NevId = new List<string>();
                    List<string> PosIncli = new List<string>();
                    List<string> NevIncli = new List<string>();
                    foreach (var data in DicAngleData)
                    {
                        if (Math.Round(data.Value.Angle).Equals(90))
                        {
                            Pos90Count++;
                            PosId.Add(data.Key);
                        }
                        else if (Math.Round(data.Value.Angle).Equals(-90))
                        {
                            Nev90Count++;
                            NevId.Add(data.Key);
                        }
                        else if (Math.Round(data.Value.Angle).Equals(-45))
                        {
                            NevIncli.Add(data.Key);
                            InclinedNev++;
                        }
                        else if (Math.Round(data.Value.Angle).Equals(45))
                        {
                            PosIncli.Add(data.Key);
                            InclinedPos++;
                        }
                    }

                    int HorAngleCount = 0;
                    int InclinedAngle = 0;

                    SupporSpecData SupDataHor = new SupporSpecData();
                    SupporSpecData SupDataVer = new SupporSpecData();
                    SupporSpecData SupDataInc1 = new SupporSpecData();
                    SupporSpecData SupDataInc2 = new SupporSpecData();
                    if (InclinedNev == 1 || InclinedPos == 1)
                    {
                        foreach (var SData in SupData.ListSecondrySuppo)
                        {
                            if (SData.SuppoId != null && PosId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    SData.PartDirection = "Hor";
                                    SupDataHor = SData;
                                    HorAngleCount++;
                                }
                            }
                            else if (SData.SuppoId != null && SData.SuppoId.Equals(VerPartId))
                            {
                                SData.PartDirection = "Ver";
                                SupDataVer = SData;
                            }
                            else if (SData.SuppoId != null && NevId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                }
                            }
                            else if (SData.SuppoId != null && PosIncli.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(45) || Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(135))
                                {
                                    SData.PartDirection = "45Inclined";
                                    InclinedAngle++;

                                    SupDataInc1 = SData;
                                }
                            }
                            else if (SData.SuppoId != null && NevIncli.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(45) || Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(135))
                                {
                                    SData.PartDirection = "45Inclined";
                                    InclinedAngle++;

                                    SupDataInc2 = SData;
                                }
                            }
                        }

                        if (SupDataHor.ListtouchingParts.Contains(SupDataInc1.SuppoId) && SupDataHor.ListtouchingParts.Contains(SupDataInc1.SuppoId) ||
                           (SupDataVer.ListtouchingParts.Contains(SupDataInc2.SuppoId) && SupDataVer.ListtouchingParts.Contains(SupDataInc2.SuppoId)) && InclinedAngle == 1)
                        {
                            SupData.SupportType = "Support82";
                            return true;
                        }
                    }
                }
            }

            return false;
        }

        int GetTouchingPrimaryCount(List<string> ListTouchingPartData)
        {
            int PTouchingParts = 0;

            foreach (string Id in ListTouchingPartData)
            {
                if (Id.Contains("P"))
                {
                    PTouchingParts++;
                }
            }

            return PTouchingParts;
        }

        bool CheckforTypeSupport36(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();

            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
            DicMidistPt = CheckforMidDist(SupData);

            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            DicDistConSup = GetminDistFromConcrete(SupData);

            string Id = GetMinDistFromDic(DicDistConSup);

            string VerPartId = "";
            foreach (var Part in CombinedParSupp)
            {
                if (Part.Count == 1)
                {
                    if (Part[0] == Id)
                    {
                        VerPartId = Id;
                        break;
                    }
                }
            }

            if (VerPartId.Length < 1)
            {
                return false;
            }

            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

            List<Vector3D> ListVecData = new List<Vector3D>();

            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

            double maxValue = 0;
            string MaxValueID = "";

            foreach (var DicData in DicDistConSup)
            {
                if (DicData.Value > maxValue)
                {
                    maxValue = DicData.Value;
                    MaxValueID = DicData.Key;
                }
            }

            if ((GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z) <= (GetPartbyId(MaxValueID, SupData.ListSecondrySuppo).Boundingboxmax.Z))
            {
                if ((DicMidistPt == null || DicMidistPt.Count == 1) && CheckVectorsArePlaner(ListVecData))
                {
                    int Pos90Count = 0;
                    int Nev90Count = 0;
                    List<string> PosId = new List<string>();
                    List<string> NevId = new List<string>();

                    foreach (var data in DicAngleData)
                    {
                        if (DicMidistPt.ElementAt(0).Key == data.Key)
                        {
                            continue;
                        }
                        if (Math.Round(data.Value.Angle).Equals(90))
                        {
                            Pos90Count++;
                            PosId.Add(data.Key);
                        }
                        else if (Math.Round(data.Value.Angle).Equals(-90))
                        {
                            Nev90Count++;
                            NevId.Add(data.Key);
                        }
                    }

                    int HorAngleCount = 0;
                    if (Pos90Count == 2)
                    {
                        foreach (var SData in SupData.ListSecondrySuppo)
                        {
                            if (SData.SuppoId != null && PosId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                }
                            }
                            else if (SData.SuppoId != null && SData.SuppoId.Equals(VerPartId))
                            {
                                SData.PartDirection = "Ver";
                            }
                            else if (SData.SuppoId != null && NevId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                }
                            }
                            else if (SData.SuppoId != null && DicMidistPt.ElementAt(0).Key.Equals(SData.SuppoId))
                            {
                                SData.PartDirection = "Hor";
                                HorAngleCount++;
                            }
                        }

                        if (HorAngleCount == 3)
                        {
                            SupData.SupportType = "Support36";

                            return true;
                        }
                    }
                }
            }

            return false;
        }

        bool CheckforTypeSupport64(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();

            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
            DicMidistPt = CheckforMidDist(SupData);

            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            DicDistConSup = GetminDistFromConcrete(SupData);

            string Id = GetMinDistFromDic(DicDistConSup);

            string VerPartId = "";
            foreach (var Part in CombinedParSupp)
            {
                if (Part.Count == 1)
                {
                    if (Part[0] == Id)
                    {
                        VerPartId = Id;
                        break;
                    }
                }
            }

            if (VerPartId.Length < 1)
            {
                return false;
            }

            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

            List<Vector3D> ListVecData = new List<Vector3D>();

            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

            double maxValue = 0;
            string MaxValueID = "";

            foreach (var DicData in DicDistConSup)
            {
                if (DicData.Value > maxValue)
                {
                    maxValue = DicData.Value;
                    MaxValueID = DicData.Key;
                }
            }

            if ((GetPartbyId(MaxValueID, SupData.ListSecondrySuppo).Boundingboxmax.Z) <= (GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z))
            {
                if ((DicMidistPt == null || DicMidistPt.Count == 0) && CheckVectorsArePlaner(ListVecData))
                {
                    int Pos90Count = 0;
                    int Nev90Count = 0;
                    List<string> PosId = new List<string>();
                    List<string> NevId = new List<string>();

                    foreach (var data in DicAngleData)
                    {
                        if (Math.Round(data.Value.Angle).Equals(90))
                        {
                            Pos90Count++;
                            PosId.Add(data.Key);
                        }
                        else if (Math.Round(data.Value.Angle).Equals(-90))
                        {
                            Nev90Count++;
                            NevId.Add(data.Key);
                        }
                    }

                    int HorAngleCount = 0;

                    // Getting for the 69 type 97 and 98 type
                    string HorId = "";
                    List<string> HorIDs = new List<string>();
                    if (Pos90Count == 2 || Nev90Count == 2 || Pos90Count == 3 || (Pos90Count == 2 && Nev90Count == 1) || Pos90Count == 1)
                    {
                        foreach (var SData in SupData.ListSecondrySuppo)
                        {
                            if (SData.SuppoId != null && PosId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                    HorId = SData.SuppoId;
                                    HorIDs.Add(SData.SuppoId);
                                }
                            }
                            else if (SData.SuppoId != null && SData.SuppoId.Equals(VerPartId))
                            {
                                SData.PartDirection = "Ver";
                            }
                            else if (SData.SuppoId != null && NevId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                    HorIDs.Add(SData.SuppoId);
                                }
                            }
                        }

                        if (Pos90Count == 2 && Nev90Count == 1 && ListIsmc.Count == 4 && HorAngleCount == 3)
                        {
                            if (SupData.ListPrimarySuppo.Count == 0)
                            {
                                SupData.SupportType = "Support66";
                                return true;
                            }
                            else if (SupData.ListPrimarySuppo.Count == 3 && HorIDs.Count == 3)
                            {
                                if (HorIDs[0] != null && HorIDs[0].Length > 0 && GetTouchingPrimaryCount(GetPartbyId(HorIDs[0], SupData.ListSecondrySuppo).ListtouchingParts) == 1 && HorIDs[1] != null && HorIDs[1].Length > 0 && GetTouchingPrimaryCount(GetPartbyId(HorIDs[1], SupData.ListSecondrySuppo).ListtouchingParts) == 1 && HorIDs[2] != null && HorIDs[2].Length > 0 && GetTouchingPrimaryCount(GetPartbyId(HorIDs[2], SupData.ListSecondrySuppo).ListtouchingParts) == 1)
                                {
                                    SupData.SupportType = "Support106";
                                    return true;
                                }
                            }
                        }
                        else if (Pos90Count == 2 && Nev90Count == 1 && ListIsmc.Count == 4 && HorAngleCount == 3)
                        {
                            SupData.SupportType = "Support67";
                            return true;
                        }
                        else if (Pos90Count == 3 && ListIsmc.Count == 4 && HorAngleCount == 3)
                        {
                            SupData.SupportType = "Support65";
                            return true;
                        }
                        /* else if (Nev90Count == 3 && ListIsmc.Count == 4)
                         {
                             SupData.SupportType = "Support69";
                             return true;
                         }*/
                        if (Nev90Count == 2 && ListIsmc.Count == 3 && HorAngleCount == 2)
                        {
                            if (SupData.ListPrimarySuppo.Count == 0)
                            {
                                SupData.SupportType = "Support63";
                                return true;
                            }
                            else if (SupData.ListPrimarySuppo.Count == 2 && HorIDs.Count == 2)
                            {
                                if (HorIDs[0] != null && HorIDs[0].Length > 0 && GetTouchingPrimaryCount(GetPartbyId(HorIDs[0], SupData.ListSecondrySuppo).ListtouchingParts) == 1 && HorIDs[1] != null && HorIDs[1].Length > 0 && GetTouchingPrimaryCount(GetPartbyId(HorIDs[1], SupData.ListSecondrySuppo).ListtouchingParts) == 1)
                                {
                                    SupData.SupportType = "Support103";
                                    return true;
                                }
                            }
                        }
                        else if (Pos90Count == 2 && ListIsmc.Count == 3 && HorAngleCount == 2)
                        {
                            if (SupData.ListPrimarySuppo.Count == 0)
                            {
                                SupData.SupportType = "Support64";
                                return true;
                            }
                            else if (SupData.ListPrimarySuppo.Count == 2 && HorIDs.Count == 2)
                            {
                                if (HorIDs[0] != null && HorIDs[0].Length > 0 && GetTouchingPrimaryCount(GetPartbyId(HorIDs[0], SupData.ListSecondrySuppo).ListtouchingParts) == 1 && HorIDs[1] != null && HorIDs[1].Length > 0 && GetTouchingPrimaryCount(GetPartbyId(HorIDs[1], SupData.ListSecondrySuppo).ListtouchingParts) == 1)
                                {
                                    SupData.SupportType = "Support102";
                                    return true;
                                }
                            }
                        }
                        else if (Pos90Count == 1 && ListIsmc.Count == 2 && HorAngleCount == 1)
                        {
                            if (HorId != null)
                            {

                                if (GetTouchingPrimaryCount(GetPartbyId(HorId, SupData.ListSecondrySuppo).ListtouchingParts) == 0)
                                {
                                    SupData.SupportType = "Support69";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(HorId, SupData.ListSecondrySuppo).ListtouchingParts) == 6)
                                {
                                    SupData.SupportType = "Support97";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(HorId, SupData.ListSecondrySuppo).ListtouchingParts) == 7)
                                {
                                    SupData.SupportType = "Support98";
                                    return true;
                                }
                            }
                        }

                    }

                }
            }
            else
            {
                if ((DicMidistPt == null || DicMidistPt.Count == 0) && CheckVectorsArePlaner(ListVecData))
                {
                    int Pos90Count = 0;
                    int Nev90Count = 0;
                    List<string> PosId = new List<string>();
                    List<string> NevId = new List<string>();

                    foreach (var data in DicAngleData)
                    {
                        if (Math.Round(data.Value.Angle).Equals(90))
                        {
                            Pos90Count++;
                            PosId.Add(data.Key);
                        }
                        else if (Math.Round(data.Value.Angle).Equals(-90))
                        {
                            Nev90Count++;
                            NevId.Add(data.Key);
                        }
                    }

                    int HorAngleCount = 0;

                    SupporSpecData DataHor = new SupporSpecData();
                    SupporSpecData DataVer = new SupporSpecData();
                    if (Pos90Count == 2 || Nev90Count == 2 || Pos90Count == 3 || (Pos90Count == 2 && Nev90Count == 1) || Pos90Count == 1)
                    {
                        foreach (var SData in SupData.ListSecondrySuppo)
                        {
                            if (SData.SuppoId != null && PosId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    DataHor = SData;
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                }
                            }
                            else if (SData.SuppoId != null && SData.SuppoId.Equals(VerPartId))
                            {
                                SData.PartDirection = "Ver";
                                DataVer = SData;
                            }
                            else if (SData.SuppoId != null && NevId.Contains(SData.SuppoId))
                            {
                                if (Math.Abs(Math.Round(SData.Angle.XinDegree)).Equals(90))
                                {
                                    SData.PartDirection = "Hor";
                                    HorAngleCount++;
                                }
                            }
                        }

                        if (Pos90Count == 1 && ListIsmc.Count == 2 && HorAngleCount == 1)
                        {
                            if (DataHor != null && DataVer != null && DataHor.Angle != null && DataVer.Angle != null && Math.Abs(Math.Round(DataHor.Angle.ZinDegree - DataVer.Angle.ZinDegree)).Equals(180))
                            {
                                SupData.SupportType = "Support70";
                                return true;
                            }
                        }

                    }

                }
            }

            return false;
        }
        bool CheckforTypeSupport60(ref SupportData SupData)
        {
            if (GetConcretePlateCount(ref SupData).Equals(3))
            {
                Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

                DicIndexData = GetAllISMC(SupData);

                List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
                List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
                foreach (var Part in DicIndexData)
                {
                    ListIsmc.Add(Part.Value);
                }

                if (ListIsmc.Count == 2)
                {
                    if (Math.Abs(Math.Round(SupData.ListSecondrySuppo[0].Angle.XinDegree)).Equals(90) && (Math.Abs(Math.Round(SupData.ListSecondrySuppo[1].Angle.XinDegree))).Equals(45) || (Math.Abs(Math.Round(SupData.ListSecondrySuppo[1].Angle.XinDegree)).Equals(135)))
                    {
                        int CplateCount = 0;
                        if ((SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 6 && GetTouchingPrimaryCount(SupData.ListSecondrySuppo[0].ListtouchingParts) == 3)
                            || (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 7 && GetTouchingPrimaryCount(SupData.ListSecondrySuppo[0].ListtouchingParts) == 4) || (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 3 || (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 7 && GetTouchingPrimaryCount(SupData.ListSecondrySuppo[0].ListtouchingParts) == 4) || (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 3 || (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 5 && GetTouchingPrimaryCount(SupData.ListSecondrySuppo[0].ListtouchingParts) == 2)) || (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 4 && GetTouchingPrimaryCount(SupData.ListSecondrySuppo[0].ListtouchingParts) == 1)))

                        {
                            foreach (string Id in SupData.ListSecondrySuppo[0].ListtouchingParts)
                            {
                                if (Id.ToUpper().Contains("C"))
                                {
                                    CplateCount++;
                                }
                            }
                        }
                        if (CplateCount == 2 && Math.Round(SupData.ListSecondrySuppo[0].Angle.ZinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[1].Angle.ZinDegree)))
                        {
                            if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 3)
                            {
                                SupData.SupportType = "Support53";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 4)
                            {
                                SupData.SupportType = "Support101";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 5)
                            {
                                SupData.SupportType = "Support99";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 6)
                            {
                                SupData.SupportType = "Support87";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 7)
                            {
                                SupData.SupportType = "Support89";
                                return true;
                            }
                        }

                        if (CplateCount == 2 && Math.Abs(Math.Round(SupData.ListSecondrySuppo[0].Angle.ZinDegree - SupData.ListSecondrySuppo[1].Angle.ZinDegree)).Equals(180))
                        {
                            if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 3)
                            {
                                SupData.SupportType = "Support61";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 4)
                            {
                                SupData.SupportType = "Support94";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 5)
                            {
                                SupData.SupportType = "Support100";
                                return true;
                            }
                        }
                    }
                    else if (Math.Abs(Math.Round(SupData.ListSecondrySuppo[1].Angle.XinDegree)).Equals(90) && (Math.Abs(Math.Round(SupData.ListSecondrySuppo[0].Angle.XinDegree))).Equals(45) || (Math.Abs(Math.Round(SupData.ListSecondrySuppo[0].Angle.XinDegree)).Equals(135)))
                    {
                        int CplateCount = 0;
                        if ((SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 6 && GetTouchingPrimaryCount(SupData.ListSecondrySuppo[1].ListtouchingParts) == 3)
                            || (SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 7 && GetTouchingPrimaryCount(SupData.ListSecondrySuppo[1].ListtouchingParts) == 4) || (SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 3))
                        {
                            foreach (string Id in SupData.ListSecondrySuppo[1].ListtouchingParts)
                            {
                                if (Id.ToUpper().Contains("C"))
                                {
                                    CplateCount++;
                                }
                            }
                        }
                        if (CplateCount == 2 && Math.Round(SupData.ListSecondrySuppo[0].Angle.ZinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[1].Angle.ZinDegree)))
                        {
                            if (SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 3)
                            {
                                SupData.SupportType = "Support53";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 4)
                            {
                                SupData.SupportType = "Support101";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 5)
                            {
                                SupData.SupportType = "Support99";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 6)
                            {
                                SupData.SupportType = "Support87";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[1].ListtouchingParts.Count == 7)
                            {
                                SupData.SupportType = "Support89";
                                return true;
                            }
                        }
                        if (CplateCount == 2 && Math.Abs(Math.Round(SupData.ListSecondrySuppo[0].Angle.ZinDegree - SupData.ListSecondrySuppo[1].Angle.ZinDegree)).Equals(180))
                        {
                            if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 3)
                            {
                                SupData.SupportType = "Support61";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 4)
                            {
                                SupData.SupportType = "Support94";
                                return true;
                            }
                            else if (SupData.ListSecondrySuppo[0].ListtouchingParts.Count == 4)
                            {
                                SupData.SupportType = "Support100";
                                return true;
                            }
                        }
                    }

                }
            }

            return false;
        }

        int GetConcretePlateCount(ref SupportData SupData)
        {
            int Platecount = 0;

            foreach (var SSuppo in SupData.ListConcreteData)
            {
                if (SSuppo != null && SSuppo.SupportName != null && SSuppo.SupportName.ToLower().Equals("plate"))
                {
                    Platecount++;
                }
            }
            return Platecount;
        }

        bool CheckforTypeSupport58(ref SupportData SupData)
        {
            if (GetAllISMC(SupData).Count == 1 && Math.Abs(Math.Round(GetAllISMC(SupData)[0].Angle.XinDegree)).Equals(90))
            {
                SupData.SupportType = "Support108";
                return true;
            }
            return false;
        }

        bool CheckforTypeSupport54(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }

            string Orientation = "";

            if (CheckCentroidInLine(GetDicCentroidBottomPart(SupData), GetDicCentroidPrimaryPart(SupData), GetCentroidFromList(ListIsmc), ref Orientation))
            {

                if (ListIsmc.Count == 2)
                {
                    int MaxHorIndex = 0;
                    int MinVerIndex = 0;
                    if (ListIsmc[0].Centroid.Z > ListIsmc[1].Centroid.Z)
                    {
                        MaxHorIndex = 0;
                        MinVerIndex = 1;
                    }
                    else
                    {
                        MaxHorIndex = 1;
                        MinVerIndex = 0;
                    }

                    if (Math.Round(ListIsmc[MaxHorIndex].Angle.ZinDegree).Equals(Math.Round(ListIsmc[MinVerIndex].Angle.ZinDegree)) && Math.Abs(Math.Round(ListIsmc[MaxHorIndex].Angle.XinDegree)).Equals(90) &&
                        Math.Abs(Math.Round(ListIsmc[MaxHorIndex].Angle.XinDegree - ListIsmc[MinVerIndex].Angle.ZinDegree)).Equals(90))
                    {
                        GetPartbyId(ListIsmc[MaxHorIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Hor";
                        GetPartbyId(ListIsmc[MaxHorIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Ver";
                        SupData.SupportType = "Support54";
                        return true;
                    }

                }
            }
            else
            {
                if (ListIsmc.Count == 2)
                {
                    int MaxHorIndex = 0;
                    int MinVerIndex = 0;
                    if (ListIsmc[0].Centroid.Z > ListIsmc[1].Centroid.Z)
                    {
                        MaxHorIndex = 0;
                        MinVerIndex = 1;
                    }
                    else
                    {
                        MaxHorIndex = 1;
                        MinVerIndex = 0;
                    }

                    if (Math.Round(ListIsmc[MaxHorIndex].Angle.ZinDegree).Equals(Math.Round(ListIsmc[MinVerIndex].Angle.ZinDegree)) && Math.Abs(Math.Round(ListIsmc[MaxHorIndex].Angle.XinDegree)).Equals(90) &&
                        Math.Abs(Math.Round(ListIsmc[MaxHorIndex].Angle.XinDegree - ListIsmc[MinVerIndex].Angle.XinDegree)).Equals(90))
                    {
                        double Dist1 = 0;
                        double Dist2 = 0;

                        if (ListIsmc[MaxHorIndex].StPt != null && ListIsmc[MinVerIndex].StPt != null && ListIsmc[MinVerIndex].EndPt != null)
                        {

                            Dist1 = Calculate.DistPoint(GetPt3DFromArray(ListIsmc[MaxHorIndex].StPt), GetPt3DFromArray(ListIsmc[MinVerIndex].StPt));

                            Dist2 = Calculate.DistPoint(GetPt3DFromArray(ListIsmc[MaxHorIndex].StPt), GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt));


                            if (Dist1 != Dist2)
                            {
                                Vector3D Vec1 = GetVector(GetPt3DFromArray(ListIsmc[MinVerIndex].StPt), GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt));

                                Vector3D Vec2 = GetVector(GetPt3DFromArray(ListIsmc[MaxHorIndex].StPt), GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt));

                                Vector3D Vec3 = new Vector3D(0, 0, 1);

                                Vector3D Vec5 = GetVector(GetPt3DFromArray(ListIsmc[MaxHorIndex].EndPt), GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt));

                                double RotationAngle1 = Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3));

                                double RotationAngle2 = Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec5, Vec3));

                                if (RotationAngle1 < 0 && RotationAngle2 > 0 && Math.Abs(RotationAngle1) > Math.Abs(RotationAngle2))
                                {
                                    GetPartbyId(ListIsmc[MaxHorIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Hor";
                                    GetPartbyId(ListIsmc[MinVerIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Ver";
                                    SupData.SupportType = "Support55";
                                    return true;
                                }
                                else if (RotationAngle1 < 0 && RotationAngle2 > 0 && Math.Abs(RotationAngle1) < Math.Abs(RotationAngle2))
                                {

                                    GetPartbyId(ListIsmc[MaxHorIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Hor";
                                    GetPartbyId(ListIsmc[MinVerIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Ver";
                                    SupData.SupportType = "Support56";
                                    return true;
                                }
                            }
                        }

                    }

                }
            }
            return false;
        }
        bool CheckforTypeSupport50(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }

            string Orientation = "";


            List<Pt3D> PrimPartCent = GetDicCentroidPrimaryPart(SupData);

            if (SupData.ListPrimarySuppo.Count > 1)
            {
                PrimPartCent = new List<Pt3D>();
            }

            if (CheckCentroidInLine(GetDicCentroidBottomPart(SupData), PrimPartCent, GetCentroidFromList(ListIsmc), ref Orientation))
            {
                List<string> ListParSup = new List<string>();
                List<List<string>> CombinedParSupp = new List<List<string>>();

                ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
                DicMidistPt = CheckforMidDist(SupData);

                Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                DicDistConSup = GetminDistFromConcrete(SupData);

                string Id = GetMinDistFromDic(DicDistConSup);

                string VerPartId = "";
                foreach (var Part in CombinedParSupp)
                {
                    if (Part.Count == 1)
                    {
                        if (Part[0] == Id)
                        {
                            VerPartId = Id;
                            break;
                        }
                    }
                }

                if (VerPartId.Length < 1)
                {
                    return false;
                }

                if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)) &&
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z < GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)
                {
                    GetPartbyId(VerPartId, SupData.ListSecondrySuppo).PartDirection = "Ver";

                    GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).PartDirection = "Hor";

                    if (GetGussetCout(ref SupData) == 0)
                    {
                        if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 4)
                        {
                            SupData.SupportType = "Support96";
                            return true;
                        }
                        else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 2)
                        {
                            SupData.SupportType = "Support95";
                            return true;
                        }
                        else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 0)
                        {
                            SupData.SupportType = "Support83";
                            return true;
                        }
                    }
                    else
                    {
                        SupData.SupportType = "Support50";
                        return true;
                    }

                }
                if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)).Equals(180) &&
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z < GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)
                {
                    GetPartbyId(VerPartId, SupData.ListSecondrySuppo).PartDirection = "Ver";

                    GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).PartDirection = "Hor";

                    SupData.SupportType = "Support68";
                    return true;

                }
                else if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)) && Math.Round(
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)))
                {
                    GetPartbyId(VerPartId, SupData.ListSecondrySuppo).PartDirection = "Ver";

                    GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).PartDirection = "Hor";

                    if (SupData.ListPrimarySuppo.Count == 0)
                    {
                        SupData.SupportType = "Support51";
                        return true;
                    }
                    else if (SupData.ListPrimarySuppo.Count > 0)
                    {
                        SupData.SupportType = "Support115";
                        return true;
                    }
                }
                else if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)).Equals(180) && Math.Round(
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)))
                {
                    bool PriamaryCond = true;

                    foreach (var PrimSup in SupData.ListPrimarySuppo)
                    {
                        if (PrimSup.ListtouchingParts.Count != 1 || !PrimSup.ListtouchingParts.Contains(DicMidistPt.ElementAt(0).Key))
                        {
                            PriamaryCond = false;
                        }
                    }


                    if (PriamaryCond)
                    {
                        if (SupData.ListPrimarySuppo.Count == 4)
                        {
                            SupData.SupportType = "Support72";
                            return true;
                        }
                        else if (SupData.ListPrimarySuppo.Count == 2)
                        {
                            SupData.SupportType = "Support73";
                            return true;
                        }

                    }
                }
                else if (SupData.ListPrimarySuppo.Count == 1 && CheckCentroidInLine(GetCentroidFromList(ListEmpty), GetDicCentroidPrimaryPart(SupData), GetCentroidFromList(ListIsmc), ref Orientation))
                {


                }

            }
            else
            {

            }
            return false;

        }

        bool CheckforTypeSupport85(ref SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIndexData = new Dictionary<int, SupporSpecData>();

            DicIndexData = GetAllISMC(SupData);

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListEmpty = new List<SupporSpecData>();
            foreach (var Part in DicIndexData)
            {
                ListIsmc.Add(Part.Value);
            }

            string Orientation = "";


            List<Pt3D> PrimPartCent = GetDicCentroidPrimaryPart(SupData);

            if (SupData.ListPrimarySuppo.Count > 1)
            {
                PrimPartCent = new List<Pt3D>();
            }

            if (CheckCentroidInLine(GetDicCentroidBottomPart(SupData), PrimPartCent, GetCentroidFromList(ListIsmc), ref Orientation))
            {
                List<string> ListParSup = new List<string>();
                List<List<string>> CombinedParSupp = new List<List<string>>();

                ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
                DicMidistPt = CheckforMidDist(SupData);

                Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                DicDistConSup = GetminDistFromConcrete(SupData);

                string Id = GetMinDistFromDic(DicDistConSup);

                string VerPartId = "";
                foreach (var Part in CombinedParSupp)
                {
                    if (Part.Count == 1)
                    {
                        if (Part[0] == Id)
                        {
                            VerPartId = Id;
                            break;
                        }
                    }
                }

                if (VerPartId.Length < 1)
                {
                    return false;
                }

                if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)) &&
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z < GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)
                {
                    GetPartbyId(VerPartId, SupData.ListSecondrySuppo).PartDirection = "Ver";

                    GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).PartDirection = "Hor";

                    if (GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts.Count == 10
                        || GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts.Count == 9 || GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts.Count == 5
                        || GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts.Count == 4 || GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts.Count == 3)
                    {
                        if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 8
                            || GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 9 || GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 4
                            || GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 3 || GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 2)
                        {
                            if (GetGussetCout(ref SupData) == 0)
                            {
                                if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 4)
                                {
                                    SupData.SupportType = "Support96";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 2)
                                {
                                    SupData.SupportType = "Support95";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 0)
                                {
                                    SupData.SupportType = "Support83";
                                    return true;
                                }

                            }
                            else
                            {
                                if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 8)
                                {
                                    SupData.SupportType = "Support88";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 4)
                                {
                                    SupData.SupportType = "Support90";
                                    return true;
                                }
                                else if (GetTouchingPrimaryCount(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).ListtouchingParts) == 3)
                                {
                                    SupData.SupportType = "Support91";
                                    return true;
                                }
                            }
                        }
                    }
                }
                if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)).Equals(180) &&
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z < GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)
                {
                    GetPartbyId(VerPartId, SupData.ListSecondrySuppo).PartDirection = "Ver";

                    GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).PartDirection = "Hor";

                    SupData.SupportType = "Support68";
                    return true;

                }
                else if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)) && Math.Round(
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)))
                {
                    GetPartbyId(VerPartId, SupData.ListSecondrySuppo).PartDirection = "Ver";

                    GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).PartDirection = "Hor";

                    if (SupData.ListPrimarySuppo.Count == 0)
                    {
                        SupData.SupportType = "Support51";
                        return true;
                    }
                    else if (SupData.ListPrimarySuppo.Count > 0)
                    {
                        SupData.SupportType = "Support115";
                        return true;
                    }
                }
                else if (CombinedParSupp.Count == 2 && DicMidistPt.Count == 1 && GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo) != null && GetPartbyId(VerPartId, SupData.ListSecondrySuppo) != null && Math.Abs(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.XinDegree)).Equals(90)
                  && Math.Abs(Math.Round(GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Angle.ZinDegree - GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Angle.ZinDegree)).Equals(180) && Math.Round(
                  GetPartbyId(VerPartId, SupData.ListSecondrySuppo).Boundingboxmax.Z).Equals(Math.Round(GetPartbyId(DicMidistPt.ElementAt(0).Key, SupData.ListSecondrySuppo).Boundingboxmax.Z)))
                {
                    bool PriamaryCond = true;

                    foreach (var PrimSup in SupData.ListPrimarySuppo)
                    {
                        if (PrimSup.ListtouchingParts.Count != 1 || !PrimSup.ListtouchingParts.Contains(DicMidistPt.ElementAt(0).Key))
                        {
                            PriamaryCond = false;
                        }
                    }


                    if (PriamaryCond)
                    {
                        if (SupData.ListPrimarySuppo.Count == 4)
                        {
                            SupData.SupportType = "Support72";
                            return true;
                        }
                        else if (SupData.ListPrimarySuppo.Count == 2)
                        {
                            SupData.SupportType = "Support73";
                            return true;
                        }

                    }
                }
                else if (SupData.ListPrimarySuppo.Count == 1 && CheckCentroidInLine(GetCentroidFromList(ListEmpty), GetDicCentroidPrimaryPart(SupData), GetCentroidFromList(ListIsmc), ref Orientation))
                {


                }

            }
            else
            {
                if (ListIsmc.Count == 2)
                {
                    int MaxHorIndex = 0;
                    int MinVerIndex = 0;
                    if (ListIsmc[0].Centroid.Z > ListIsmc[1].Centroid.Z)
                    {
                        MaxHorIndex = 0;
                        MinVerIndex = 1;
                    }
                    else
                    {
                        MaxHorIndex = 1;
                        MinVerIndex = 0;
                    }

                    if (Math.Round(ListIsmc[MaxHorIndex].Angle.ZinDegree).Equals(Math.Round(ListIsmc[MinVerIndex].Angle.ZinDegree)) && Math.Abs(Math.Round(ListIsmc[MaxHorIndex].Angle.XinDegree)).Equals(90) &&
                        Math.Abs(Math.Round(ListIsmc[MaxHorIndex].Angle.XinDegree - ListIsmc[MinVerIndex].Angle.XinDegree)).Equals(90))
                    {
                        double Dist1 = 0;
                        double Dist2 = 0;

                        if (ListIsmc[MaxHorIndex].StPt != null && ListIsmc[MinVerIndex].StPt != null && ListIsmc[MinVerIndex].EndPt != null)
                        {

                            Dist1 = Calculate.DistPoint(GetPt3DFromArray(ListIsmc[MaxHorIndex].StPt), GetPt3DFromArray(ListIsmc[MinVerIndex].StPt));

                            Dist2 = Calculate.DistPoint(GetPt3DFromArray(ListIsmc[MaxHorIndex].StPt), GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt));


                            if (Dist1 != Dist2)
                            {
                                Vector3D Vec1 = new Vector3D(1, 0, 0);

                                Vector3D Vec2 = new Vector3D(1, 0, 0);

                                Vector3D Vec3 = new Vector3D(0, 0, 1);

                                Vector3D Vec5 = new Vector3D(1, 0, 0);

                                if (Dist1 > Dist2)
                                {
                                    Vec1 = GetVector(GetPt3DFromArray(ListIsmc[MinVerIndex].StPt), GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt));
                                    Vec2 = GetVector(GetPt3DFromArray(ListIsmc[MinVerIndex].StPt), GetPt3DFromArray(ListIsmc[MaxHorIndex].StPt));
                                    Vec5 = GetVector(GetPt3DFromArray(ListIsmc[MinVerIndex].StPt), GetPt3DFromArray(ListIsmc[MaxHorIndex].EndPt));
                                }
                                else
                                {
                                    Vec1 = GetVector(GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt), GetPt3DFromArray(ListIsmc[MinVerIndex].StPt));
                                    Vec2 = GetVector(GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt), GetPt3DFromArray(ListIsmc[MaxHorIndex].StPt));
                                    Vec5 = GetVector(GetPt3DFromArray(ListIsmc[MinVerIndex].EndPt), GetPt3DFromArray(ListIsmc[MaxHorIndex].EndPt));
                                }

                                double RotationAngle1 = Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3));

                                double RotationAngle2 = Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec5, Vec3));

                                if (Math.Abs(RotationAngle1) > Math.Abs(RotationAngle2) && VectorHasNegativeMem(Vec5) || VectorHasNegativeMem(Vec2) && Math.Abs(RotationAngle2) > Math.Abs(RotationAngle1))
                                {
                                    GetPartbyId(ListIsmc[MaxHorIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Hor";
                                    GetPartbyId(ListIsmc[MinVerIndex].SuppoId, SupData.ListSecondrySuppo).PartDirection = "Ver";
                                    if (GetTouchingPrimaryCount(GetPartbyId(ListIsmc[MaxHorIndex].SuppoId, SupData.ListSecondrySuppo).ListtouchingParts) == 9)
                                    {
                                        SupData.SupportType = "Support85";
                                    }
                                }
                            }
                        }

                    }

                }
            }
            return false;

        }

        bool VectorHasNegativeMem(Vector3D Vec3d)
        {
            if (Vec3d.X < 0 || Vec3d.Y < 0 || Vec3d.Z < 0)
            {
                return true;
            }
            return false;
        }

        SupporSpecData GetPartbyId(string Id, List<SupporSpecData> ListSuppo)
        {
            foreach (var Suppo in ListSuppo)
            {
                if (Id.Equals(Suppo.SuppoId))
                {
                    return Suppo;
                }
            }

            return null;
        }

        List<Pt3D> GetCentroidFromList(List<SupporSpecData> SData)
        {
            List<Pt3D> Centroids = new List<Pt3D>();
            if (SData.Count > 0)
            {
                foreach (var Part in SData)
                {
                    Centroids.Add(Part.Centroid);
                }
                return Centroids;
            }

            return null;
        }
        Dictionary<int, SupporSpecData> GetAllISMC(SupportData SupData)
        {
            Dictionary<int, SupporSpecData> DicIdndexIsmc = new Dictionary<int, SupporSpecData>();

            for (int inx = 0; inx < SupData.ListSecondrySuppo.Count; inx++)
            {
                if (SupData.ListSecondrySuppo[inx] != null && SupData.ListSecondrySuppo[inx].Size != null && SupData.ListSecondrySuppo[inx].SupportName != null && SupData.ListSecondrySuppo[inx].SupportName.ToLower().Contains("web") || SupData.ListSecondrySuppo[inx].Size.ToLower().Contains("web") || SupData.ListSecondrySuppo[inx].Size.ToLower().Contains("upe"))
                {
                    DicIdndexIsmc[inx] = SupData.ListSecondrySuppo[inx];
                }
            }
            return DicIdndexIsmc;
        }
        bool CheckforTypeSupport49(ref SupportData SupData)
        {
            int plateCount = 0;
            SupporSpecData NBPart = new SupporSpecData();
            List<SupporSpecData> ChannelC = new List<SupporSpecData>();

            List<SupporSpecData> AngleData = new List<SupporSpecData>();

            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data.SupportName != null && Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    plateCount++;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("NB"))
                {
                    NBPart = Data;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("ISMC"))
                {
                    ChannelC.Add(Data);
                }
                else if (Data.Size != null && (Data.Size.ToUpper().Contains("L-") || Data.Size.ToUpper().Contains("ANGLE") || Data.Size.ToUpper().Contains("ISA")) && (!Data.Size.ToUpper().Contains("WEB")))
                {
                    AngleData.Add(Data);
                }
            }

            if (plateCount == 5 && NBPart != null && ChannelC != null && ChannelC.Count == 3 && AngleData != null && AngleData.Count == 1)
            {
                if (Math.Round(Math.Abs(ChannelC[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(ChannelC[1].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(ChannelC[2].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(AngleData[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90))
                {
                    List<string> ListParSup = new List<string>();
                    List<List<string>> CombinedParSupp = new List<List<string>>();

                    ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                    Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
                    DicMidistPt = CheckforMidDist(SupData);

                    Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                    DicDistConSup = GetminDistFromConcrete(SupData);

                    string Id = GetMinDistFromDic(DicDistConSup);

                    string VerPartId = "";
                    foreach (var Part in CombinedParSupp)
                    {
                        if (Part.Count == 1)
                        {
                            if (Part[0] == Id)
                            {
                                VerPartId = Id;
                                break;
                            }
                        }
                    }

                    if (VerPartId.Length < 1)
                    {
                        return false;
                    }

                    Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

                    List<Vector3D> ListVecData = new List<Vector3D>();

                    DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

                    if (Math.Round(DicAngleData[AngleData[0].SuppoId].Angle).Equals(-90) && Math.Round(DicAngleData[ChannelC[0].SuppoId].Angle).Equals(90) && Math.Round(DicAngleData[ChannelC[1].SuppoId].Angle).Equals(90) && Math.Round(DicAngleData[ChannelC[2].SuppoId].Angle).Equals(90))
                    {
                        if (DicAngleData[AngleData[0].SuppoId].Mindist > DicAngleData[ChannelC[0].SuppoId].Mindist && DicAngleData[AngleData[0].SuppoId].Mindist > DicAngleData[ChannelC[1].SuppoId].Mindist && DicAngleData[AngleData[0].SuppoId].Mindist > DicAngleData[ChannelC[2].SuppoId].Mindist)
                        {
                            if (GettouchigPrimCount(SupData, ChannelC[0]) == 1 && GettouchigPrimCount(SupData, ChannelC[1]) == 1 && GettouchigPrimCount(SupData, ChannelC[2]) == 1)
                            {
                                SupData.SupportType = "Support49";
                                return true;
                            }
                        }
                    }
                }
            }
            return false;
        }
        bool CheckforTypeSupport47(ref SupportData SupData)
        {
            int plateCount = 0;
            SupporSpecData NBPart = new SupporSpecData();
            List<SupporSpecData> ChannelC = new List<SupporSpecData>();

            List<SupporSpecData> AngleData = new List<SupporSpecData>();

            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data.SupportName != null && Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    plateCount++;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("NB"))
                {
                    NBPart = Data;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("ISMC"))
                {
                    ChannelC.Add(Data);
                }
                else if (Data.Size != null && (Data.Size.ToUpper().Contains("L-") || Data.Size.ToUpper().Contains("ANGLE") || Data.Size.ToUpper().Contains("ISA")) && (!Data.Size.ToUpper().Contains("WEB")))
                {
                    AngleData.Add(Data);
                }
            }

            if (plateCount == 5 && NBPart != null && ChannelC != null && ChannelC.Count == 3 && AngleData != null && AngleData.Count == 2)
            {
                if (Math.Round(Math.Abs(ChannelC[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(ChannelC[1].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(ChannelC[2].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(AngleData[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(AngleData[0].Angle.XinDegree).Equals(Math.Round(AngleData[1].Angle.XinDegree)))
                {
                    List<string> ListParSup = new List<string>();
                    List<List<string>> CombinedParSupp = new List<List<string>>();

                    ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                    Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
                    DicMidistPt = CheckforMidDist(SupData);

                    Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                    DicDistConSup = GetminDistFromConcrete(SupData);

                    string Id = GetMinDistFromDic(DicDistConSup);

                    string VerPartId = "";
                    foreach (var Part in CombinedParSupp)
                    {
                        if (Part.Count == 1)
                        {
                            if (Part[0] == Id)
                            {
                                VerPartId = Id;
                                break;
                            }
                        }
                    }

                    if (VerPartId.Length < 1)
                    {
                        return false;
                    }

                    Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

                    List<Vector3D> ListVecData = new List<Vector3D>();

                    DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

                    if (Math.Round(DicAngleData[AngleData[0].SuppoId].Angle).Equals(-90) && (Math.Round(DicAngleData[AngleData[1].SuppoId].Angle)).Equals(-90) && Math.Round(DicAngleData[ChannelC[0].SuppoId].Angle).Equals(90) && Math.Round(DicAngleData[ChannelC[1].SuppoId].Angle).Equals(90) && Math.Round(DicAngleData[ChannelC[2].SuppoId].Angle).Equals(90))
                    {
                        if (DicAngleData[AngleData[0].SuppoId].Mindist > DicAngleData[ChannelC[0].SuppoId].Mindist && DicAngleData[AngleData[0].SuppoId].Mindist > DicAngleData[ChannelC[1].SuppoId].Mindist && DicAngleData[AngleData[0].SuppoId].Mindist > DicAngleData[ChannelC[2].SuppoId].Mindist)
                        {
                            if (GettouchigPrimCount(SupData, ChannelC[0]) == 1 && GettouchigPrimCount(SupData, ChannelC[1]) == 1 && GettouchigPrimCount(SupData, ChannelC[2]) == 1)
                            {
                                SupData.SupportType = "Support47";
                                return true;
                            }
                        }
                    }
                }
            }
            return false;
        }

        bool CheckforTypeSupport38(ref SupportData SupData)
        {
            int inx = 0;
            return false;
        }
        // bool CheckforTypeSupport28(ref SupportData SupData)
        //{
        //}

        int GettouchigPrimCount(SupportData SupData, SupporSpecData ChannelC)
        {
            int Count = 0;
            foreach (var Data in SupData.ListPrimarySuppo)
            {
                if (Data.ListtouchingParts.Contains(ChannelC.SuppoId))
                {
                    Count++;
                }
            }

            return Count;
        }
        bool HasWord(List<SupporSpecData> SecondarySupData, string Word)
        {
            foreach (var Data in SecondarySupData)
            {
                if (Data.Size != null)
                {
                    if (Data.Size.ToUpper().Contains(Word))
                    {
                        return true;
                    }
                }
            }

            return false;
        }


        bool Checkforangle(ref SupportData SupportData)
        {
            foreach (var SSup in SupportData.ListSecondrySuppo)
            {
                if (SSup != null && (SSup.Size.ToLower().Contains("l-") || SSup.Size.ToLower().Contains("angle") || SSup.Size.ToLower().Contains("isa")) && !SSup.Size.ToLower().Contains("web"))
                {
                    return true;
                }
            }
            return false;
        }

        bool CheckforTypeSupport43(ref SupportData SupData)
        {
            List<string> ListFlgId = new List<string>();

            if (SupData.ListPrimarySuppo[0].SupportName.Contains("GRP FLG") && SupData.ListPrimarySuppo[1].SupportName.Contains("GRP FLG"))
            {
                ListFlgId.Add(SupData.ListPrimarySuppo[0].SuppoId);
                ListFlgId.Add(SupData.ListPrimarySuppo[1].SuppoId);
                System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 0, 1);

                Vec1.X = SupData.ListPrimarySuppo[0].NoramlDir.X;
                Vec1.Y = SupData.ListPrimarySuppo[0].NoramlDir.Y;
                Vec1.Z = SupData.ListPrimarySuppo[0].NoramlDir.Z;
                Vec2.X = SupData.ListPrimarySuppo[1].NoramlDir.X;
                Vec2.Y = SupData.ListPrimarySuppo[1].NoramlDir.Y;
                Vec2.Z = SupData.ListPrimarySuppo[1].NoramlDir.Z;

                if (Math.Abs(Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3)))).Equals(180))
                {
                    List<SupporSpecData> ListPlateData = new List<SupporSpecData>();

                    // Need to make this line more safe may cause Exception
                    if (GetPlateFromSecondarySuppo(SupData.ListSecondrySuppo, ref ListPlateData))
                    {
                        if (ListPlateData != null && ListPlateData.Count == 1)
                        {
                            List<string> ListParSup = new List<string>();
                            List<List<string>> CombinedParSupp = new List<List<string>>();

                            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                            Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
                            DicMidistPt = CheckforMidDist(SupData);

                            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                            DicDistConSup = GetminDistFromConcrete(SupData);

                            string Id = GetMinDistFromDic(DicDistConSup);

                            string VerPartId = "";
                            foreach (var Part in CombinedParSupp)
                            {
                                if (Part.Count == 1)
                                {
                                    if (Part[0] == Id)
                                    {
                                        VerPartId = Id;
                                        break;
                                    }
                                }
                            }

                            if (VerPartId.Length < 1)
                            {
                                return false;
                            }

                            string ParttochingVerKey = "";
                            string Parttoplate = "";
                            SupporSpecData VerPart = new SupporSpecData();
                            SupporSpecData PartTouchingtoVer = new SupporSpecData();
                            SupporSpecData PartToucingPlateandpartnextver = new SupporSpecData();
                            foreach (var SSupp in SupData.ListSecondrySuppo)
                            {
                                if (SSupp.SuppoId.Equals(VerPartId))
                                {
                                    VerPart = SSupp;
                                    foreach (string SPart in SSupp.ListtouchingParts)
                                    {
                                        if (DicDistConSup.ContainsKey(SPart))
                                        {
                                            ParttochingVerKey = SPart;
                                        }
                                    }
                                }
                            }

                            foreach (var SSupp in SupData.ListSecondrySuppo)
                            {
                                if (SSupp.SuppoId.Equals(ParttochingVerKey))
                                {
                                    PartTouchingtoVer = SSupp;
                                    foreach (string SPart in SSupp.ListtouchingParts)
                                    {
                                        if (DicDistConSup.ContainsKey(SPart) && SPart != VerPartId)
                                        {
                                            Parttoplate = SPart;
                                        }
                                    }
                                }
                            }

                            try
                            {
                                if (SupData.ListSecondrySuppo.Exists(e => e.SuppoId.Equals(Parttoplate)))
                                {
                                    PartToucingPlateandpartnextver = SupData.ListSecondrySuppo.Find(e => e.SuppoId.Equals(Parttoplate));
                                }
                            }
                            catch (Exception)
                            {
                            }

                            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

                            List<Vector3D> ListVecData = new List<Vector3D>();

                            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

                            if (VerPart != null && PartTouchingtoVer != null && PartToucingPlateandpartnextver != null)
                            {
                                if (DicAngleData[PartTouchingtoVer.SuppoId].Angle.Equals(-90) && Math.Abs(Math.Round(VerPart.Angle.ZinDegree - PartTouchingtoVer.Angle.ZinDegree)).Equals(90) &&
                                    Math.Abs(Math.Round(PartTouchingtoVer.Angle.ZinDegree - PartToucingPlateandpartnextver.Angle.ZinDegree)).Equals(90) && (Math.Round(PartTouchingtoVer.Angle.XinDegree)).Equals((Math.Round(PartToucingPlateandpartnextver.Angle.XinDegree))).Equals(-90))
                                {

                                    foreach (var Data in SupData.ListSecondrySuppo)
                                    {
                                        if (Data.SuppoId != null && (Data.SuppoId.Equals(PartToucingPlateandpartnextver.SuppoId) || Data.SuppoId.Equals(PartTouchingtoVer.SuppoId)))
                                        {
                                            Data.PartDirection = "Hor";
                                        }
                                        else if (Data.SuppoId != null && Data.SuppoId.Equals(VerPartId))
                                        {
                                            Data.PartDirection = "Ver";
                                        }
                                    }
                                    SupData.SupportType = "Support43";
                                    return true;
                                }
                            }

                        }
                    }
                }

            }
            return false;
        }

        bool CheckforTypeSupport41(ref SupportData SupData)
        {
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();

            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            DicDistConSup = GetminDistFromConcrete(SupData);

            string Id = GetMinDistFromDic(DicDistConSup);

            string VerPartId = "";
            foreach (var Part in CombinedParSupp)
            {
                if (Part.Count == 1)
                {
                    if (Part[0] == Id)
                    {
                        VerPartId = Id;
                        break;
                    }
                }
            }

            if (VerPartId.Length < 1)
            {
                return false;
            }

            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

            List<Vector3D> ListVecData = new List<Vector3D>();

            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

            int POS90count = 0;
            int NEV90count = 0;
            string NegativePartId = "";
            List<string> PosPartsId = new List<string>();
            if (DicAngleData.Count == 3)
            {
                foreach (var Data in DicAngleData)
                {
                    if (Math.Round(Data.Value.Angle).Equals(90))
                    {
                        POS90count++;
                        PosPartsId.Add(Data.Key);
                    }
                    else if (Math.Round(Data.Value.Angle).Equals(-90))
                    {
                        NEV90count++;
                        NegativePartId = Data.Key;
                    }
                }
            }


            List<SupporSpecData> PosPartList = new List<SupporSpecData>();
            SupporSpecData NevPartData = new SupporSpecData();
            SupporSpecData VerPartData = new SupporSpecData();

            if (POS90count == 2 && NEV90count == 1 &&
                !CheckVectorsArePlaner(ListVecData))
            {
                foreach (var Data in SupData.ListSecondrySuppo)
                {
                    if (Data.SuppoId != null && PosPartsId.Contains(Data.SuppoId))
                    {
                        PosPartList.Add(Data);
                    }
                    else if (Data.SuppoId != null && Data.SuppoId.Equals(NegativePartId))
                    {
                        NevPartData = Data;
                    }
                    else if (Data.SuppoId != null && Data.SuppoId.Equals(VerPartId))
                    {
                        VerPartData = Data;
                    }
                }
                if (PosPartList.Count == 2 && Math.Round(PosPartList[0].Angle.ZinDegree).Equals(Math.Round(PosPartList[1].Angle.ZinDegree)) && NevPartData != null && VerPartData != null && Math.Round(NevPartData.Angle.ZinDegree).Equals(Math.Round(VerPartData.Angle.ZinDegree)) && Math.Abs(Math.Round(PosPartList[0].Angle.ZinDegree - NevPartData.Angle.ZinDegree)).Equals(90))
                {

                    foreach (var Data in SupData.ListSecondrySuppo)
                    {
                        if (Data.SuppoId != null && PosPartsId.Contains(Data.SuppoId))
                        {
                            Data.PartDirection = "Hor";
                        }
                        else if (Data.SuppoId != null && Data.SuppoId.Equals(NegativePartId))
                        {
                            Data.PartDirection = "Hor";
                        }
                        else if (Data.SuppoId != null && Data.SuppoId.Equals(VerPartId))
                        {
                            Data.PartDirection = "Ver";
                        }
                    }
                    SupData.SupportType = "Support41";
                    return true;
                }

            }

            return false;
        }

        //bool CheckforTypeSupport36(ref SupportData SupportData)
        //{

        // }
        bool CheckforTypeSupport31(ref SupportData SupportData)
        {
            if (Math.Round(SupportData.ListSecondrySuppo[0].Angle.ZinDegree).Equals(Math.Round(SupportData.ListSecondrySuppo[1].Angle.ZinDegree)) && Math.Round(SupportData.ListSecondrySuppo[1].Angle.ZinDegree).Equals(Math.Round(SupportData.ListSecondrySuppo[2].Angle.ZinDegree)) && Math.Round(SupportData.ListSecondrySuppo[0].Angle.YinDegree).Equals(Math.Round(SupportData.ListSecondrySuppo[1].Angle.YinDegree)) && Math.Round(SupportData.ListSecondrySuppo[1].Angle.YinDegree).Equals(Math.Round(SupportData.ListSecondrySuppo[2].Angle.YinDegree)))
            {
                return CheckAnyPartSecInclined(ref SupportData);
            }

            return false;
        }

        int GetGussetCout(ref SupportData SupportData)
        {
            int Count = 0;

            foreach (var SSup in SupportData.ListSecondrySuppo)
            {
                if (SSup.IsGussetplate)
                {
                    Count++;
                }
            }

            return Count;
        }
        bool CheckAnyPartSecInclined(ref SupportData SupportData)
        {

            bool Condition1 = false;
            bool Condition2 = false;
            bool Condition3 = false;
            SupporSpecData HorPart = new SupporSpecData();
            SupporSpecData VerPart = new SupporSpecData();
            foreach (var SecSup in SupportData.ListSecondrySuppo)
            {
                string InclinedId = "";
                if (Math.Abs(Math.Round(SecSup.Angle.XinDegree)).Equals(45) || Math.Abs(Math.Round(SecSup.Angle.XinDegree)).Equals(135))
                {
                    InclinedId = SecSup.SuppoId;

                    SecSup.PartDirection = "45Inclined";
                    Condition1 = true;
                }
                else if (Math.Round(SecSup.Angle.XinDegree).Equals(0))
                {
                    SecSup.PartDirection = "Ver";
                    VerPart = SecSup;
                    Condition2 = true;
                }
                else if (Math.Abs(Math.Round(SecSup.Angle.XinDegree)).Equals(90))
                {
                    SecSup.PartDirection = "Hor";
                    HorPart = SecSup;
                    Condition3 = true;
                }
            }

            if (Condition1 && Condition2 && Condition3)
            {
                if (Math.Round(VerPart.Boundingboxmax.Z) > Math.Round(HorPart.Centroid.Z))
                {
                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    double[] Closestpt = new double[3];
                    if (Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.StPt)))
                    {
                        Vec1.X = HorPart.EndPt[0] - HorPart.StPt[0];
                        Vec1.Y = HorPart.EndPt[1] - HorPart.StPt[1];
                        Vec1.Z = HorPart.EndPt[2] - HorPart.StPt[2];

                        Closestpt = HorPart.StPt;
                    }
                    else
                    {
                        Vec1.X = HorPart.StPt[0] - HorPart.EndPt[0];
                        Vec1.Y = HorPart.StPt[1] - HorPart.EndPt[1];
                        Vec1.Z = HorPart.StPt[2] - HorPart.EndPt[2];

                        Closestpt = HorPart.EndPt;
                    }

                    Vec2.X = VerPart.EndPt[0] - VerPart.StPt[0];
                    Vec2.Y = VerPart.EndPt[1] - VerPart.StPt[1];
                    Vec2.Z = VerPart.EndPt[2] - VerPart.StPt[2];

                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                    {
                        if (SupportData.ListPrimarySuppo == null || SupportData.ListPrimarySuppo.Count == 0)
                        {
                            SupportData.SupportType = "Support63";
                            return true;
                        }
                        else if (Calculate.DistPoint(SupportData.ListPrimarySuppo[0].Centroid, GetPt3DFromArray(VerPart.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(Closestpt)))
                        {
                            SupportData.SupportType = "Support31";
                            return true;
                        }
                    }
                }
                else if (Math.Round(VerPart.Boundingboxmax.Z) < Math.Round(HorPart.Centroid.Z))
                {
                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    double[] Closestpt = new double[3];
                    if (Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.StPt)))
                    {
                        Vec1.X = HorPart.EndPt[0] - HorPart.StPt[0];
                        Vec1.Y = HorPart.EndPt[1] - HorPart.StPt[1];
                        Vec1.Z = HorPart.EndPt[2] - HorPart.StPt[2];

                        Closestpt = HorPart.StPt;
                    }
                    else
                    {
                        Vec1.X = HorPart.StPt[0] - HorPart.EndPt[0];
                        Vec1.Y = HorPart.StPt[1] - HorPart.EndPt[1];
                        Vec1.Z = HorPart.StPt[2] - HorPart.EndPt[2];

                        Closestpt = HorPart.EndPt;
                    }

                    Vec2.X = VerPart.EndPt[0] - VerPart.StPt[0];
                    Vec2.Y = VerPart.EndPt[1] - VerPart.StPt[1];
                    Vec2.Z = VerPart.EndPt[2] - VerPart.StPt[2];

                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                    {

                        SupportData.SupportType = "Support62";
                        return true;
                    }
                }

            }

            return false;
        }
        //Need to Add the some code for the some conditon for the Support30
        bool CheckforTypeSupport30(ref SupportData SupData)
        {
            List<string> ListFlgId = new List<string>();
            if (SupData.ListPrimarySuppo[0].SupportName.Contains("GRP FLG") && SupData.ListPrimarySuppo[1].SupportName.Contains("GRP FLG"))
            {
                ListFlgId.Add(SupData.ListPrimarySuppo[0].SuppoId);
                ListFlgId.Add(SupData.ListPrimarySuppo[1].SuppoId);
                System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 0, 1);

                Vec1.X = SupData.ListPrimarySuppo[0].NoramlDir.X;
                Vec1.Y = SupData.ListPrimarySuppo[0].NoramlDir.Y;
                Vec1.Z = SupData.ListPrimarySuppo[0].NoramlDir.Z;
                Vec2.X = SupData.ListPrimarySuppo[1].NoramlDir.X;
                Vec2.Y = SupData.ListPrimarySuppo[1].NoramlDir.Y;
                Vec2.Z = SupData.ListPrimarySuppo[1].NoramlDir.Z;

                if (Math.Abs(Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3)))).Equals(180))
                {
                    List<SupporSpecData> ListPlateData = new List<SupporSpecData>();

                    // Need to make this line more safe may cause Exception
                    if (GetPlateFromSecondarySuppo(SupData.ListSecondrySuppo, ref ListPlateData))
                    {
                        if (ListPlateData != null && ListPlateData.Count == 1)
                        {
                            List<string> ListParSup = new List<string>();
                            List<List<string>> CombinedParSupp = new List<List<string>>();

                            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                            DicDistConSup = GetminDistFromConcrete(SupData);

                            string Id = GetMinDistFromDic(DicDistConSup);

                            string VerPartId = "";
                            foreach (var Part in CombinedParSupp)
                            {
                                if (Part.Count == 1)
                                {
                                    if (Part[0] == Id)
                                    {
                                        VerPartId = Id;
                                        break;
                                    }
                                }
                            }

                            if (VerPartId.Length < 1)
                            {
                                return false;
                            }

                            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

                            List<Vector3D> ListVecData = new List<Vector3D>();

                            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

                            int POS90count = 0;

                            string NegativePartId = "";
                            List<string> PosPartsId = new List<string>();
                            if (DicAngleData.Count == 1)
                            {
                                foreach (var Data in DicAngleData)
                                {
                                    if (Math.Round(Data.Value.Angle).Equals(90))
                                    {
                                        POS90count++;
                                        PosPartsId.Add(Data.Key);
                                    }
                                }

                                if (POS90count == 1 && CheckVectorsArePlaner(ListVecData))
                                {
                                    SupporSpecData SupData1 = new SupporSpecData();
                                    SupporSpecData SupData2 = new SupporSpecData();

                                    foreach (var Data in SupData.ListSecondrySuppo)
                                    {
                                        if (Data.SuppoId != null && Data.SuppoId == PosPartsId[0])
                                        {
                                            SupData1 = Data;
                                        }
                                        else if (Data.SuppoId != null && Data.SuppoId == VerPartId)
                                        {
                                            SupData2 = Data;
                                        }
                                    }

                                    if (Math.Round(SupData1.Angle.ZinDegree).Equals(Math.Round(SupData2.Angle.ZinDegree)))
                                    {
                                        if (ListPlateData[0].ListtouchingParts.Contains(PosPartsId[0]))
                                        {
                                            foreach (var Data in SupData.ListSecondrySuppo)
                                            {
                                                if (Data.SuppoId != null && DicAngleData.ContainsKey(Data.SuppoId))
                                                {
                                                    Data.PartDirection = "Hor";
                                                }
                                                else if (Data.SuppoId != null && Data.SuppoId == VerPartId)
                                                {
                                                    Data.PartDirection = "Ver";
                                                }
                                            }

                                            SupData.SupportType = "Support30";
                                            return true;
                                        }
                                    }

                                }
                            }
                        }
                    }
                }
            }

            return false;
        }

        bool GetPlateFromSecondarySuppo(List<SupporSpecData> ListSecSuppoData, ref List<SupporSpecData> ListPlateData)
        {
            bool Hasplate = false;

            foreach (var SuppoData in ListSecSuppoData)
            {
                if (SuppoData.SupportName != null && SuppoData.SupportName.ToUpper().Contains("PLATE"))
                {
                    ListPlateData.Add(SuppoData);
                    Hasplate = true;
                }
            }

            return Hasplate;
        }

        List<int> CheckandGetindexesofGRPFLG(ref SupportData SupData)
        {
            List<int> listindex = new List<int>();
            for (int inx = 0; inx < SupData.ListPrimarySuppo.Count; inx++)
            {
                if (SupData.ListPrimarySuppo[inx].SupportName.ToUpper().Contains("GRP FLG"))
                {
                    listindex.Add(inx);
                }
            }

            return listindex;
        }

        bool CheckforTypeSupport32(ref SupportData SupData)
        {
            List<int> listindex = new List<int>();
            listindex = CheckandGetindexesofGRPFLG(ref SupData);
            List<string> ListFlgId = new List<string>();

            if (listindex.Count == 2)
            {
                ListFlgId.Add(SupData.ListPrimarySuppo[listindex[0]].SuppoId);
                ListFlgId.Add(SupData.ListPrimarySuppo[listindex[1]].SuppoId);
                System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 0, 1);

                Vec1.X = SupData.ListPrimarySuppo[listindex[0]].NoramlDir.X;
                Vec1.Y = SupData.ListPrimarySuppo[listindex[0]].NoramlDir.Y;
                Vec1.Z = SupData.ListPrimarySuppo[listindex[0]].NoramlDir.Z;
                Vec2.X = SupData.ListPrimarySuppo[listindex[1]].NoramlDir.X;
                Vec2.Y = SupData.ListPrimarySuppo[listindex[1]].NoramlDir.Y;
                Vec2.Z = SupData.ListPrimarySuppo[listindex[1]].NoramlDir.Z;

                if (Math.Abs(Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3)))).Equals(180))
                {
                    List<SupporSpecData> ListPlateData = new List<SupporSpecData>();

                    // Need to make this line more safe may cause Exception
                    if (GetPlateFromSecondarySuppo(SupData.ListSecondrySuppo, ref ListPlateData))
                    {
                        if (ListPlateData != null && ListPlateData.Count == 1)
                        {
                            List<string> ListParSup = new List<string>();
                            List<List<string>> CombinedParSupp = new List<List<string>>();

                            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                            Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
                            DicMidistPt = CheckforMidDist(SupData);

                            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                            DicDistConSup = GetminDistFromConcrete(SupData);

                            string Id = GetMinDistFromDic(DicDistConSup);

                            string VerPartId = "";
                            foreach (var Part in CombinedParSupp)
                            {
                                if (Part.Count == 1)
                                {
                                    if (Part[0] == Id)
                                    {
                                        VerPartId = Id;
                                        break;
                                    }
                                }
                            }

                            if (VerPartId.Length < 1)
                            {
                                return false;
                            }

                            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

                            List<Vector3D> ListVecData = new List<Vector3D>();

                            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

                            int POS90count = 0;
                            int SymetricCount = 0;

                            string NegativePartId = "";
                            List<string> PosPartsId = new List<string>();
                            if (DicAngleData.Count == 2)
                            {
                                foreach (var Data in DicAngleData)
                                {
                                    if (Math.Round(Data.Value.Angle).Equals(90))
                                    {
                                        POS90count++;
                                        PosPartsId.Add(Data.Key);
                                    }
                                    else if (DicMidistPt.Count == 1 && DicMidistPt.ContainsKey(Data.Key))
                                    {
                                        SymetricCount++;
                                    }
                                }

                                SupporSpecData SupData1 = new SupporSpecData();
                                SupporSpecData SupData2 = new SupporSpecData();
                                SupporSpecData SymPart = new SupporSpecData();
                                if (POS90count == 1 && SymetricCount == 1 && !CheckVectorsArePlaner(ListVecData))
                                {
                                    foreach (var Data in SupData.ListSecondrySuppo)
                                    {
                                        if (Data.SuppoId != null && Data.SuppoId == PosPartsId[0])
                                        {
                                            SupData1 = Data;
                                        }
                                        else if (Data.SuppoId != null && Data.SuppoId == VerPartId)
                                        {
                                            SupData2 = Data;
                                        }
                                        else if (Data.SuppoId != null && Data.SuppoId == DicMidistPt.ElementAt(0).Key)
                                        {
                                            SymPart = Data;
                                        }
                                    }

                                    if (ListPlateData != null && ListPlateData.Count == 1 && SupData1.ListtouchingParts.Contains(ListPlateData[0].SuppoId))
                                    {
                                        if (Math.Abs(Math.Round(SymPart.Angle.ZinDegree - SupData2.Angle.ZinDegree)).Equals(180) && Math.Abs(Math.Round(SupData1.Angle.ZinDegree - SupData2.Angle.ZinDegree)).Equals(90) && (SymPart.Boundingboxmax.Z > SupData2.Boundingboxmax.Z) &&
                                            SymPart.ListtouchingParts.Contains(SupData.ListPrimarySuppo[GetMissingIndex(listindex, SupData)].SuppoId) && Math.Round(SupData1.Angle.XinDegree).Equals(Math.Round(SymPart.Angle.XinDegree)))
                                        {
                                            foreach (var Data in SupData.ListSecondrySuppo)
                                            {
                                                if (Data.SuppoId != null && SupData1.Equals(Data.SuppoId))
                                                {
                                                    Data.PartDirection = "Hor";
                                                }
                                                else if (Data.SuppoId != null && Data.SuppoId == VerPartId)
                                                {
                                                    Data.PartDirection = "Ver";
                                                }
                                                else if (Data.SuppoId != null && Data.SuppoId == SymPart.SuppoId)
                                                {
                                                    Data.PartDirection = "Hor";
                                                }
                                            }

                                            SupData.SupportType = "Support32";
                                            return true;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }

            }
            return false;
        }

        int GetMissingIndex(List<int> listindex, SupportData SupData)
        {
            for (int inx = 0; inx < SupData.ListPrimarySuppo.Count; inx++)
            {
                if (!listindex.Contains(inx))
                {
                    return inx;
                }
            }

            return 0;
        }
        bool CheckforTypeSupport48(ref SupportData SupData)
        {
            int plateCount = 0;
            SupporSpecData NBPart = new SupporSpecData();
            List<SupporSpecData> ChannelC = new List<SupporSpecData>();

            List<SupporSpecData> AngleData = new List<SupporSpecData>();

            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data.SupportName != null && Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    plateCount++;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("NB"))
                {
                    NBPart = Data;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("ISMC"))
                {
                    ChannelC.Add(Data);
                }
                else if (Data.Size != null && (Data.Size.ToUpper().Contains("L-") || Data.Size.ToUpper().Contains("ANGLE") || Data.Size.ToUpper().Contains("ISA")) && (!Data.Size.ToUpper().Contains("WEB")))
                {
                    AngleData.Add(Data);
                }
            }

            if (plateCount == 5 && NBPart != null && ChannelC != null && ChannelC.Count == 1 && AngleData != null && AngleData.Count == 2)
            {
                if (Math.Round(Math.Abs(ChannelC[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(AngleData[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(AngleData[0].Angle.XinDegree).Equals(Math.Round(AngleData[1].Angle.XinDegree)))
                {
                    List<string> ListParSup = new List<string>();
                    List<List<string>> CombinedParSupp = new List<List<string>>();

                    ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

                    Dictionary<string, double> DicMidistPt = new Dictionary<string, double>();
                    DicMidistPt = CheckforMidDist(SupData);

                    Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
                    DicDistConSup = GetminDistFromConcrete(SupData);

                    string Id = GetMinDistFromDic(DicDistConSup);

                    string VerPartId = "";
                    foreach (var Part in CombinedParSupp)
                    {
                        if (Part.Count == 1)
                        {
                            if (Part[0] == Id)
                            {
                                VerPartId = Id;
                                break;
                            }
                        }
                    }

                    if (VerPartId.Length < 1)
                    {
                        return false;
                    }

                    Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

                    List<Vector3D> ListVecData = new List<Vector3D>();

                    DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

                    if (Math.Round(DicAngleData[AngleData[0].SuppoId].Angle).Equals(-90) && (Math.Round(DicAngleData[AngleData[1].SuppoId].Angle)).Equals(-90) && (Math.Round(DicAngleData[NBPart.SuppoId].Angle).Equals(90)) && DicAngleData[AngleData[0].SuppoId].Mindist > DicAngleData[ChannelC[0].SuppoId].Mindist && DicAngleData[AngleData[1].SuppoId].Mindist > DicAngleData[NBPart.SuppoId].Mindist && SupData.ListSecondrySuppo[0].TouchingPartid.Contains(SupData.ListPrimarySuppo[0].SuppoId))
                    {
                        SupData.SupportType = "Support48";
                        return true;
                    }
                }
            }
            return false;
        }
        bool CheckforTypeSupport29(ref SupportData SupData)
        {
            int plateCount = 0;
            SupporSpecData NBPart = new SupporSpecData();
            List<SupporSpecData> ChannelC = new List<SupporSpecData>();

            SupporSpecData AngleData = new SupporSpecData();

            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data.SupportName != null && Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    plateCount++;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("NB"))
                {
                    NBPart = Data;
                }
                else if (Data.Size != null && Data.Size.ToUpper().Contains("ISMC"))
                {
                    ChannelC.Add(Data);
                }
                else if (Data.Size != null && (Data.Size.ToUpper().Contains("L-") || Data.Size.ToUpper().Contains("ANGLE") || Data.Size.ToUpper().Contains("ISA")) && (!Data.Size.ToUpper().Contains("WEB")))
                {
                    AngleData = Data;
                }
            }

            if (plateCount == 5 && NBPart != null && ChannelC != null && ChannelC.Count == 1 && AngleData != null)
            {
                if (Math.Round(Math.Abs(ChannelC[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(AngleData.Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90))
                {
                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    System.Windows.Media.Media3D.Vector3D Vec4 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    Pt3D Point3D1 = new Pt3D();
                    Pt3D Point3DAng = new Pt3D();
                    if (Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(ChannelC[0].EndPt)) > Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(ChannelC[0].StPt)))
                    {

                        Vec1.X = ChannelC[0].EndPt[0] - ChannelC[0].StPt[0];
                        Vec1.Y = ChannelC[0].EndPt[1] - ChannelC[0].StPt[1];
                        Vec1.Z = ChannelC[0].EndPt[2] - ChannelC[0].StPt[2];
                        Point3D1 = GetPt3DFromArray(ChannelC[0].StPt);
                    }
                    else
                    {
                        Vec1.X = ChannelC[0].StPt[0] - ChannelC[0].EndPt[0];
                        Vec1.Y = ChannelC[0].StPt[1] - ChannelC[0].EndPt[1];
                        Vec1.Z = ChannelC[0].StPt[2] - ChannelC[0].EndPt[2];

                        Point3D1 = GetPt3DFromArray(ChannelC[0].EndPt);
                    }

                    if (Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(AngleData.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(AngleData.StPt)))
                    {
                        Vec4.X = AngleData.EndPt[0] - AngleData.StPt[0];
                        Vec4.Y = AngleData.EndPt[1] - AngleData.StPt[1];
                        Vec4.Z = AngleData.EndPt[2] - AngleData.StPt[2];

                        Point3DAng = GetPt3DFromArray(AngleData.StPt);
                    }
                    else
                    {
                        Vec4.X = AngleData.StPt[0] - AngleData.EndPt[0];
                        Vec4.Y = AngleData.StPt[1] - AngleData.EndPt[1];
                        Vec4.Z = AngleData.StPt[2] - AngleData.EndPt[2];
                        Point3DAng = GetPt3DFromArray(AngleData.EndPt);
                    }


                    Vec2.X = NBPart.EndPt[0] - NBPart.StPt[0];
                    Vec2.Y = NBPart.EndPt[1] - NBPart.StPt[1];
                    Vec2.Z = NBPart.EndPt[2] - NBPart.StPt[2];

                    if ((Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90)
                       && Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec4, Vec2, Vec3))).Equals(-90)) ||
                       (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90)
                       && Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec4, Vec2, Vec3))).Equals(90)))
                    {
                        List<Vector3D> ListVecData = new List<Vector3D>();
                        ListVecData.Add(Vec1);
                        ListVecData.Add(Vec2);
                        ListVecData.Add(Vec4);
                        if (CheckVectorsArePlaner(ListVecData))
                        {
                            if (Calculate.DistPoint(SupData.ListConcreteData[0].Centroid, Point3DAng) > Calculate.DistPoint(SupData.ListConcreteData[0].Centroid, Point3D1))
                            {
                                // if (CheckTwoSuppoCollinear(ChannelC[0], ChannelC[1]))
                                {
                                    SupData.SupportType = "Support29";
                                    return true;
                                }
                            }
                        }
                    }

                }
            }
            return false;
        }
        bool CheckforTypeSupport27(ref SupportData SupData)
        {
            int plateCount = 0;
            SupporSpecData NBPart = new SupporSpecData();
            List<SupporSpecData> ChannelC = new List<SupporSpecData>();
            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    plateCount++;
                }
                else if (Data.Size.ToUpper().Contains("NB"))
                {
                    NBPart = Data;
                }
                else if (Data.Size.ToUpper().Contains("ISMC"))
                {
                    ChannelC.Add(Data);
                }
            }

            if (plateCount == 5 && NBPart != null && ChannelC != null && ChannelC.Count == 2)
            {
                if (Math.Round(Math.Abs(ChannelC[0].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90) && Math.Round(Math.Abs(ChannelC[1].Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90))
                {
                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    System.Windows.Media.Media3D.Vector3D Vec4 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    if (Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(ChannelC[0].EndPt)) > Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(ChannelC[0].StPt)))
                    {

                        Vec1.X = ChannelC[0].EndPt[0] - ChannelC[0].StPt[0];
                        Vec1.Y = ChannelC[0].EndPt[1] - ChannelC[0].StPt[1];
                        Vec1.Z = ChannelC[0].EndPt[2] - ChannelC[0].StPt[2];
                    }
                    else
                    {
                        Vec1.X = ChannelC[0].StPt[0] - ChannelC[0].EndPt[0];
                        Vec1.Y = ChannelC[0].StPt[1] - ChannelC[0].EndPt[1];
                        Vec1.Z = ChannelC[0].StPt[2] - ChannelC[0].EndPt[2];
                    }

                    if (Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(ChannelC[1].EndPt)) > Calculate.DistPoint(GetPt3DFromArray(NBPart.EndPt), GetPt3DFromArray(ChannelC[1].StPt)))
                    {
                        Vec4.X = ChannelC[1].EndPt[0] - ChannelC[1].StPt[0];
                        Vec4.Y = ChannelC[1].EndPt[1] - ChannelC[1].StPt[1];
                        Vec4.Z = ChannelC[1].EndPt[2] - ChannelC[1].StPt[2];
                    }
                    else
                    {
                        Vec4.X = ChannelC[1].StPt[0] - ChannelC[1].EndPt[0];
                        Vec4.Y = ChannelC[1].StPt[1] - ChannelC[1].EndPt[1];
                        Vec4.Z = ChannelC[1].StPt[2] - ChannelC[1].EndPt[2];
                    }


                    Vec2.X = NBPart.EndPt[0] - NBPart.StPt[0];
                    Vec2.Y = NBPart.EndPt[1] - NBPart.StPt[1];
                    Vec2.Z = NBPart.EndPt[2] - NBPart.StPt[2];

                    if ((Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90)
                       && Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec4, Vec2, Vec3))).Equals(-90)) ||
                       (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90)
                       && Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec4, Vec2, Vec3))).Equals(90)))
                    {
                        if (CheckforCollinear(ChannelC[0], NBPart) && CheckforCollinear(ChannelC[1], NBPart))
                        {
                            if (CheckTwoSuppoCollinear(ChannelC[0], ChannelC[1]))
                            {
                                SupData.SupportType = "Support27";
                                return true;
                            }
                        }
                    }

                }
            }
            return false;
        }

        bool CheckTwoSuppoCollinear(SupporSpecData ChannelC, SupporSpecData NBPart)
        {
            double dist1 = 0, dist2 = 0, dist3 = 0, dist4 = 0, dist5 = 0, dist6 = 0;
            dist1 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.StPt), GetPt3DFromArray(NBPart.StPt));
            dist2 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.EndPt), GetPt3DFromArray(NBPart.StPt));
            dist3 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.EndPt), GetPt3DFromArray(NBPart.EndPt));
            dist4 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.StPt), GetPt3DFromArray(NBPart.EndPt));

            dist5 = Calculate.DistPoint(GetPt3DFromArray(NBPart.StPt), GetPt3DFromArray(NBPart.EndPt));
            dist6 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.StPt), GetPt3DFromArray(ChannelC.EndPt));
            if (dist2 < dist1 && dist3 < dist1 && dist4 < dist1)
            {
                if (Math.Abs(dist1 - (dist6 + dist5)) < 5)
                {
                    return true;
                }
            }
            else if (dist3 < dist2 && dist1 < dist2 && dist4 < dist2)
            {
                if (Math.Abs(dist2 - (dist6 + dist5)) < 5)
                {
                    return true;
                }
            }
            else if (dist2 < dist3 && dist1 < dist3 && dist4 < dist3)
            {
                if (Math.Abs(dist3 - (dist6 + dist5)) < 5)
                {
                    return true;
                }
            }
            else if (dist2 < dist4 && dist1 < dist4 && dist3 < dist4)
            {
                if (Math.Abs(dist4 - (dist6 + dist5)) < 5)
                {
                    return true;
                }
            }

            return false;
        }

        bool CheckforTypeSupport45(ref SupportData SupData)
        {
            int plateCount = 0;
            SupporSpecData NBPart = new SupporSpecData();
            SupporSpecData ChannelC = new SupporSpecData();
            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    plateCount++;
                }
                else if (Data.Size.ToUpper().Contains("NB"))
                {
                    NBPart = Data;
                }
                else if (Data.Size.ToUpper().Contains("ISMC"))
                {
                    ChannelC = Data;
                }
            }

            if (plateCount == 5 && NBPart != null && ChannelC != null)
            {
                if (Math.Round(Math.Abs(ChannelC.Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90))
                {
                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    Vec1.X = ChannelC.EndPt[0] - ChannelC.StPt[0];
                    Vec1.Y = ChannelC.EndPt[1] - ChannelC.StPt[1];
                    Vec1.Z = ChannelC.EndPt[2] - ChannelC.StPt[2];

                    Vec2.X = NBPart.EndPt[0] - NBPart.StPt[0];
                    Vec2.Y = NBPart.EndPt[1] - NBPart.StPt[1];
                    Vec2.Z = NBPart.EndPt[2] - NBPart.StPt[2];

                    List<Pt3D> BPartCentroids = new List<Pt3D>();
                    List<Pt3D> PPartCentroids = new List<Pt3D>();
                    List<Pt3D> SPartCentroids = new List<Pt3D>();
                    string Orin = "";

                    BPartCentroids = GetDicCentroidBottomPart(SupData);
                    SPartCentroids.Add(NBPart.Centroid);
                    SPartCentroids.Add(ChannelC.Centroid);
                    PPartCentroids = GetDicCentroidPrimaryPart(SupData);


                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                    {
                        if (CheckforCollinear(ChannelC, NBPart))
                        {
                            if (SupData.ListPrimarySuppo.Count == 2)
                            {
                                SupData.SupportType = "Support33";
                                return true;
                            }
                            else
                            {
                                SupData.SupportType = "Support25";
                                return true;
                            }
                        }
                    }

                }
            }
            return false;
        }
        bool CheckforTypeSupport25(ref SupportData SupData)
        {
            int plateCount = 0;
            SupporSpecData NBPart = new SupporSpecData();
            SupporSpecData ChannelC = new SupporSpecData();
            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    plateCount++;
                }
                else if (Data.Size.ToUpper().Contains("NB"))
                {
                    NBPart = Data;
                }
                else if (Data.Size.ToUpper().Contains("ISMC"))
                {
                    ChannelC = Data;
                }
            }

            if (plateCount == 5 && NBPart != null && ChannelC != null)
            {
                if (Math.Round(Math.Abs(ChannelC.Angle.XinDegree - NBPart.Angle.XinDegree)).Equals(90))
                {
                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                    Vec1.X = ChannelC.EndPt[0] - ChannelC.StPt[0];
                    Vec1.Y = ChannelC.EndPt[1] - ChannelC.StPt[1];
                    Vec1.Z = ChannelC.EndPt[2] - ChannelC.StPt[2];

                    Vec2.X = NBPart.EndPt[0] - NBPart.StPt[0];
                    Vec2.Y = NBPart.EndPt[1] - NBPart.StPt[1];
                    Vec2.Z = NBPart.EndPt[2] - NBPart.StPt[2];

                    List<Pt3D> BPartCentroids = new List<Pt3D>();
                    List<Pt3D> PPartCentroids = new List<Pt3D>();
                    List<Pt3D> SPartCentroids = new List<Pt3D>();
                    string Orin = "";

                    BPartCentroids = GetDicCentroidBottomPart(SupData);
                    SPartCentroids.Add(NBPart.Centroid);
                    SPartCentroids.Add(ChannelC.Centroid);
                    PPartCentroids = GetDicCentroidPrimaryPart(SupData);

                    if (CheckCentroidInLine(BPartCentroids, PPartCentroids, SPartCentroids, ref Orin))
                    {
                        SupData.SupportType = "Support28";
                        return true;
                    }
                    else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                    {
                        if (CheckforCollinear(ChannelC, NBPart))
                        {
                            if (SupData.ListPrimarySuppo.Count == 4 && SupData.ListPrimarySuppo[0].SuppoId != null && SupData.ListPrimarySuppo[1].SuppoId != null &&
                                SupData.ListPrimarySuppo[2].SuppoId != null && SupData.ListPrimarySuppo[3].SuppoId != null && ChannelC.SuppoId != null && SupData.ListPrimarySuppo[0].ListtouchingParts[0].Equals(ChannelC.SuppoId)
                                && SupData.ListPrimarySuppo[1].ListtouchingParts[0].Equals(ChannelC.SuppoId)
                                && SupData.ListPrimarySuppo[2].ListtouchingParts[0].Equals(ChannelC.SuppoId)
                                && SupData.ListPrimarySuppo[3].ListtouchingParts[0].Equals(ChannelC.SuppoId)
                                )
                            {
                                SupData.SupportType = "Support45";
                                return true;
                            }
                            else if (SupData.ListPrimarySuppo.Count == 2)
                            {
                                SupData.SupportType = "Support33";
                                return true;
                            }
                            else
                            {
                                SupData.SupportType = "Support25";
                                return true;
                            }
                        }
                    }
                    else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90))
                    {
                        if (CheckforCollinear(ChannelC, NBPart))
                        {
                            SupData.SupportType = "Support26";
                            return true;
                        }
                    }
                }
            }
            return false;
        }

        /// <summary>
        /// Here we will check the closest distancefrom first support is collinear with other or not
        /// </summary>
        /// <param name="ChannelC"></param>
        /// <param name="NBPart"></param>
        /// <returns></returns>
        bool CheckforCollinear(SupporSpecData ChannelC, SupporSpecData NBPart)
        {
            double dist1 = 0, dist2 = 0, dist3 = 0, dist4 = 0;
            dist1 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.StPt), GetPt3DFromArray(NBPart.StPt));
            dist2 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.EndPt), GetPt3DFromArray(NBPart.StPt));

            if (dist2 < dist1)
            {
                dist3 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.EndPt), GetPt3DFromArray(NBPart.EndPt));
                dist4 = Calculate.DistPoint(GetPt3DFromArray(NBPart.StPt), GetPt3DFromArray(NBPart.EndPt));

                if (Math.Abs(dist4 - (dist3 + dist2)) < 5)
                {
                    return true;
                }
            }
            else
            {
                dist3 = Calculate.DistPoint(GetPt3DFromArray(ChannelC.StPt), GetPt3DFromArray(NBPart.EndPt));
                dist4 = Calculate.DistPoint(GetPt3DFromArray(NBPart.StPt), GetPt3DFromArray(NBPart.EndPt));

                if (Math.Abs(dist4 - (dist3 + dist1)) < 5)
                {
                    return true;
                }
            }


            return false;
        }
        bool CheckforTypeSupport20(ref SupportData SupData)
        {
            int ISCMCCount = 0;
            int AngleCount = 0;

            List<SupporSpecData> ListIsmc = new List<SupporSpecData>();
            List<SupporSpecData> ListAngle = new List<SupporSpecData>();

            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if ((Data.Size.ToUpper().Contains("L-") || Data.Size.ToUpper().Contains("ANGLE")) && !Data.Size.ToUpper().Contains("WEB"))
                {
                    AngleCount++;
                    ListAngle.Add(Data);
                }
                else if (Data.Size.ToUpper().Contains("WEB"))
                {
                    ISCMCCount++;
                    ListIsmc.Add(Data);
                }
            }

            //checfor

            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();
            //AnycentroidSecondaryMaching(ref SupData) // will use this later 
            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            DicDistConSup = GetminDistFromConcrete(SupData);

            string Id = GetMinDistFromDic(DicDistConSup);

            string VerPartId = "";
            foreach (var Part in CombinedParSupp)
            {
                if (Part.Count == 1)
                {
                    if (Part[0] == Id)
                    {
                        VerPartId = Id;
                        break;
                    }
                }
            }

            if (VerPartId.Length < 1)
            {
                return false;
            }

            Dictionary<string, MinPtDist> DicAngleData = new Dictionary<string, MinPtDist>();

            List<Vector3D> ListVecData = new List<Vector3D>();

            DicAngleData = GetAngleBetweenSupport(VerPartId, SupData, ref ListVecData);

            int POS90count = 0;
            int NEV90count = 0;
            bool AngleCond = false;
            bool DistCond = false;
            string NegativePartId = "";
            string PosPartId = "";
            if (AngleCount == 1 && DicAngleData.Count == 3)
            {
                foreach (var Data in DicAngleData)
                {
                    if (Data.Key.Equals(ListAngle[0].SuppoId) && Math.Round(Data.Value.Angle).Equals(90))
                    {
                        POS90count++;
                        AngleCond = true;
                    }
                    else if (Math.Round(Data.Value.Angle).Equals(90))
                    {
                        POS90count++;
                        PosPartId = Data.Key;
                        if (Data.Value.Mindist > DicAngleData[ListAngle[0].SuppoId].Mindist)
                        {
                            DistCond = true;
                        }
                    }
                    else if (Math.Round(Data.Value.Angle).Equals(-90))
                    {
                        NEV90count++;
                        NegativePartId = Data.Key;
                    }
                }
            }


            //  CheckVectorsArePlaner(ListVecData);

            if (POS90count == 2 && NEV90count == 1 && AngleCond && DistCond && CheckVectorsArePlaner(ListVecData))
            {
                SupporSpecData SupData1 = new SupporSpecData();
                SupporSpecData SupData2 = new SupporSpecData();

                foreach (var Data in SupData.ListSecondrySuppo)
                {
                    if (Data.SuppoId != null && Data.SuppoId == NegativePartId)
                    {
                        SupData1 = Data;
                    }
                    else if (Data.SuppoId != null && Data.SuppoId == PosPartId)
                    {
                        SupData2 = Data;
                    }
                }

                if (Math.Round(SupData1.Angle.ZinDegree).Equals(Math.Round(SupData2.Angle.ZinDegree)))
                {
                    foreach (var Data in SupData.ListSecondrySuppo)
                    {
                        if (Data.SuppoId != null && DicAngleData.ContainsKey(Data.SuppoId))
                        {
                            Data.PartDirection = "Hor";
                        }
                        else
                        {
                            Data.PartDirection = "Ver";
                        }
                    }
                    SupData.SupportType = "Support20";
                    return true;
                }
                else if (Math.Abs(Math.Round(SupData1.Angle.ZinDegree - SupData2.Angle.ZinDegree)).Equals(180))
                {
                    foreach (var Data in SupData.ListSecondrySuppo)
                    {
                        if (Data.SuppoId != null && DicAngleData.ContainsKey(Data.SuppoId))
                        {
                            Data.PartDirection = "Hor";
                        }
                        else
                        {
                            Data.PartDirection = "Ver";
                        }
                    }
                    SupData.SupportType = "Support40";
                    return true;
                }
            }

            return false;
        }

        bool CheckVectorsArePlaner(List<Vector3D> ListVecData)
        {
            List<bool> ListAreCoplaner = new List<bool>();
            if (ListVecData.Count < 3)
            {
                return true;
            }
            else
            {
                for (int inx = 0; inx < ListVecData.Count - 2; inx++)
                {
                    if (Math.Round(Vector3D.DotProduct(ListVecData[inx], Vector3D.CrossProduct(ListVecData[inx + 1], ListVecData[inx + 2]))) == 0)
                    {
                        ListAreCoplaner.Add(true);
                    }
                    else
                    {
                        ListAreCoplaner.Add(false);
                    }
                }
            }

            if (ListAreCoplaner.Any(x => x.Equals(false)))
            {
                return false;
            }
            else
            {
                return true;
            }
        }

        Dictionary<string, MinPtDist> GetAngleBetweenSupport(string VerPartId, SupportData SupData, ref List<Vector3D> ListVecData, List<string> IdNottobeProcess = null)
        {
            Dictionary<string, MinPtDist> Minptlist = new Dictionary<string, MinPtDist>();

            Pt3D BottomPtofVerPart = new Pt3D();
            Pt3D MaxPt = new Pt3D();
            Vector3D Vec1 = new Vector3D();
            foreach (var SSuppo in SupData.ListSecondrySuppo)
            {
                if (SSuppo.SuppoId.Equals(VerPartId) && !SSuppo.SupportName.ToUpper().Equals("PLATE"))
                {
                    Pt3D MinPartPt = new Pt3D();

                    bool IsSymetricCen = false;
                    FindMinDist(SupData.ListConcreteData[0].Centroid, SSuppo, ref BottomPtofVerPart, ref IsSymetricCen);

                    MaxPt = GetotherPt(SSuppo, BottomPtofVerPart);
                    Vec1 = GetVector(MaxPt, BottomPtofVerPart);
                }
            }

            ListVecData.Add(Vec1);

            foreach (var SSuppo in SupData.ListSecondrySuppo)
            {
                if (!SSuppo.SuppoId.Equals(VerPartId) && !SSuppo.SupportName.ToUpper().Equals("PLATE"))
                {
                    if (IdNottobeProcess != null && IdNottobeProcess.Contains(SSuppo.SuppoId))
                    {
                        continue;
                    }
                    Pt3D MinPartPt = new Pt3D();
                    Pt3D MaxPt1 = new Pt3D();
                    MinPtDist PtandDist = new MinPtDist();
                    Vector3D Vec2 = new Vector3D();
                    bool IsSymetricCen = false;

                    Point3d ProjPt = FindPerpendicularFoot(BottomPtofVerPart, SSuppo.StPt, SSuppo.EndPt);


                    PtandDist.Mindist = FindMinDist(GetPt3DFromPoint3D(ProjPt), SSuppo, ref MinPartPt, ref IsSymetricCen);

                    PtandDist.MinPt = MinPartPt;
                    MaxPt1 = GetotherPt(SSuppo, MinPartPt);
                    Vec2 = GetVector(MaxPt1, MinPartPt);
                    ListVecData.Add(Vec2);
                    PtandDist.Angle = Calculate.ConvertRadiansToDegrees(
                    Calculate.GetSignedRotation(Vec1, Vec2, new Vector3D(1, 0, 0)));

                    Minptlist[SSuppo.SuppoId] = PtandDist;
                }
            }
            return Minptlist;
        }

        Vector3D GetVector(Pt3D MaxPt, Pt3D MinPartPt)
        {
            Vector3D Vec = new Vector3D();

            Vec.X = MaxPt.X - MinPartPt.X;
            Vec.Y = MaxPt.Y - MinPartPt.Y;
            Vec.Z = MaxPt.Z - MinPartPt.Z;

            Vec.Normalize();
            return Vec;
        }
        Pt3D GetotherPt(SupporSpecData SSuppo, Pt3D MinPartPt)
        {
            Pt3D pt3D = new Pt3D();
            if ((Math.Abs(SSuppo.StPt[0] - MinPartPt.X) < 0.1) && (Math.Abs(SSuppo.StPt[1] - MinPartPt.Y) < 0.1) && (Math.Abs(SSuppo.StPt[2] - MinPartPt.Z) < 0.1))
            {
                return GetPt3DFromArray(SSuppo.EndPt);
            }
            else
            {
                return GetPt3DFromArray(SSuppo.StPt);
            }
        }

        string GetMinDistFromDic(Dictionary<string, double> DicDistConSup)
        {
            bool IsFirst = true;
            double MinValue = 0;
            string SuppoId = "";
            foreach (var Data in DicDistConSup)
            {
                if (IsFirst)
                {
                    MinValue = Data.Value;
                    SuppoId = Data.Key;
                    IsFirst = false;
                }
                else
                {
                    if (Data.Value < MinValue)
                    {
                        MinValue = Data.Value;
                        SuppoId = Data.Key;
                    }
                }
            }

            return SuppoId;
        }

        Dictionary<string, double> GetminDistFromConcrete(SupportData SupData)
        {
            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            if (SupData.ListConcreteData != null && SupData.ListConcreteData.Count > 0)
            {
                foreach (var Data in SupData.ListSecondrySuppo)
                {
                    if (Data != null && Data.SuppoId != null && Data.SupportName != null && !Data.SupportName.ToUpper().Equals("PLATE"))
                    {
                        Pt3D MinPtCoordinate = new Pt3D();
                        bool IsSymetricCen = false;
                        DicDistConSup[Data.SuppoId] = FindMinDist(SupData.ListConcreteData[0].Centroid, Data, ref MinPtCoordinate, ref IsSymetricCen);
                    }
                }
            }

            return DicDistConSup;
        }


        Dictionary<string, double> CheckforMidDist(SupportData SupData)
        {
            Dictionary<string, double> DicDistConSup = new Dictionary<string, double>();
            if (SupData.ListConcreteData != null && SupData.ListConcreteData.Count > 0)
            {
                foreach (var Data in SupData.ListSecondrySuppo)
                {
                    if (Data != null && Data.SuppoId != null && Data.SupportName != null && !Data.SupportName.ToUpper().Equals("PLATE"))
                    {
                        Pt3D MinPtCoordinate = new Pt3D();
                        bool IsSymetricCen = false;
                        double Dist = FindMinDist(SupData.ListConcreteData[0].Centroid, Data, ref MinPtCoordinate, ref IsSymetricCen);
                        if (IsSymetricCen)
                        {
                            DicDistConSup[Data.SuppoId] = Dist;
                        }
                    }
                }
            }

            return DicDistConSup;
        }

        double FindMinDist(Pt3D InPt, SupporSpecData SecondarySup, ref Pt3D point, ref bool IsMidPoint)
        {
            double Dist1 = 0;
            double Dist2 = 0;

            if (InPt != null && SecondarySup.StPt != null && SecondarySup.EndPt != null)
            {
                if (SecondarySup.StPt[0] == 0 && SecondarySup.StPt[1] == 0 && SecondarySup.StPt[2] == 0 && SecondarySup.EndPt[0] == 0 && SecondarySup.EndPt[1] == 0 && SecondarySup.EndPt[2] == 0)
                {
                    return 0;
                }

                Dist1 = Calculate.DistPoint(InPt, GetPt3DFromArray(SecondarySup.StPt));

                Dist2 = Calculate.DistPoint(InPt, GetPt3DFromArray(SecondarySup.EndPt));

                if (Math.Round(Dist1).Equals(Math.Round(Dist2)))
                {
                    Pt3D MidPt = new Pt3D();
                    MidPt.X = (SecondarySup.StPt[0] + SecondarySup.EndPt[0]) / 2;
                    MidPt.Y = (SecondarySup.StPt[1] + SecondarySup.EndPt[1]) / 2;
                    MidPt.Z = (SecondarySup.StPt[2] + SecondarySup.EndPt[2]) / 2;
                    Dist1 = Calculate.DistPoint(InPt, MidPt);

                    point = MidPt;
                    IsMidPoint = true;
                    return Dist1;
                }
                else if (Dist1 < Dist2)
                {
                    point = GetPt3DFromArray(SecondarySup.StPt);
                    return Dist1;
                }
                else
                {
                    point = GetPt3DFromArray(SecondarySup.EndPt);
                    return Dist2;
                }
            }

            return 0;
        }

        System.Windows.Media.Media3D.Vector3D GetVecStartfrompnts(SupporSpecData VerSuppo, SupporSpecData SecData)
        {

            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
            if (Calculate.DistPoint(GetPt3DFromArray(VerSuppo.StPt), GetPt3DFromArray(SecData.StPt)) > Calculate.DistPoint(GetPt3DFromArray(VerSuppo.StPt), GetPt3DFromArray(SecData.EndPt)))
            {
                Vec1.X = SecData.StPt[0] - SecData.EndPt[0];
                Vec1.Y = SecData.StPt[1] - SecData.EndPt[1];
                Vec1.Z = SecData.StPt[2] - SecData.EndPt[2];
            }
            else
            {
                Vec1.X = SecData.EndPt[0] - SecData.StPt[0];
                Vec1.Y = SecData.EndPt[1] - SecData.StPt[1];
                Vec1.Z = SecData.EndPt[2] - SecData.StPt[2];
            }


            return Vec1;
        }

        bool CheckforTypeSupport18(ref SupportData SupData)
        {
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();
            //AnycentroidSecondaryMaching(ref SupData) // will use this later 
            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            List<System.Windows.Media.Media3D.Vector3D> ListVec = new List<System.Windows.Media.Media3D.Vector3D>();


            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

            int Count1 = 0;
            int Count2 = 0;

            if (CombinedParSupp.Count == 2)
            {
                if (CombinedParSupp[0].Count == 3 || CombinedParSupp[0].Count == 1 || CombinedParSupp[1].Count == 3 || CombinedParSupp[1].Count == 1)
                {
                    SupporSpecData VerSuppo = new SupporSpecData();

                    if (CombinedParSupp[0].Count == 3)
                    {
                        foreach (var SecData in SupData.ListSecondrySuppo)
                        {
                            if (SecData.SuppoId.Equals(CombinedParSupp[1][0]))
                            {
                                VerSuppo = SecData;
                            }
                        }
                    }
                    else if (CombinedParSupp[0].Count == 1)
                    {
                        foreach (var SecData in SupData.ListSecondrySuppo)
                        {
                            if (SecData.SuppoId.Equals(CombinedParSupp[0][0]))
                            {
                                VerSuppo = SecData;
                            }
                        }
                    }

                    Vec2.X = (VerSuppo.EndPt[0] - VerSuppo.StPt[0]);
                    Vec2.Y = (VerSuppo.EndPt[1] - VerSuppo.StPt[1]);
                    Vec2.Z = (VerSuppo.EndPt[2] - VerSuppo.StPt[2]);

                    Dictionary<string, string> DicIdDir = new Dictionary<string, string>();
                    foreach (var SecData in SupData.ListSecondrySuppo)
                    {
                        if (!SecData.SuppoId.Equals(VerSuppo.SuppoId))
                        {
                            System.Windows.Media.Media3D.Vector3D VecLoc = GetVecStartfrompnts(VerSuppo, SecData);

                            if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(VecLoc, Vec2, Vec3))).Equals(90))
                            {
                                Count1++;

                                DicIdDir[SecData.SuppoId] = "LeftHor";
                            }
                            else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(VecLoc, Vec2, Vec3))).Equals(-90))
                            {
                                Count2++;

                                DicIdDir[SecData.SuppoId] = "RightHor";
                            }
                        }
                        {
                            DicIdDir[SecData.SuppoId] = "Ver";
                        }
                    }

                    List<string> ProecessedPids = new List<string>();

                    if (Count1 == 2 && Count2 == 1)
                    {
                        foreach (var SecData in SupData.ListSecondrySuppo)
                        {
                            foreach (var PsuppoData in SupData.ListPrimarySuppo)
                            {

                                if (ProecessedPids != null && PsuppoData.TouchingPartid != null)
                                {
                                    if ((!ProecessedPids.Contains(PsuppoData.SuppoId)) && PsuppoData.TouchingPartid.Equals(SecData.SuppoId))
                                    {
                                        ProecessedPids.Add(PsuppoData.SuppoId);
                                    }
                                }
                            }
                            SecData.PartDirection = DicIdDir[SecData.SuppoId];
                        }

                        if (ProecessedPids.Count == 3)
                        {
                            SupData.SupportType = "Support18";
                            return true;
                        }
                    }
                }
            }

            return false;
        }

        bool CheckforTypeSupport19(ref SupportData SupData)
        {
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();
            //AnycentroidSecondaryMaching(ref SupData) // will use this later 
            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            List<System.Windows.Media.Media3D.Vector3D> ListVec = new List<System.Windows.Media.Media3D.Vector3D>();


            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

            int Count1 = 0;
            int Count2 = 0;

            if (CombinedParSupp.Count == 2)
            {
                if (CombinedParSupp[0].Count == 4 || CombinedParSupp[0].Count == 1 || CombinedParSupp[1].Count == 4 || CombinedParSupp[1].Count == 1)
                {
                    SupporSpecData VerSuppo = new SupporSpecData();

                    if (CombinedParSupp[0].Count == 4)
                    {
                        foreach (var SecData in SupData.ListSecondrySuppo)
                        {
                            if (SecData.SuppoId.Equals(CombinedParSupp[1][0]))
                            {
                                VerSuppo = SecData;
                            }
                        }
                    }
                    else if (CombinedParSupp[0].Count == 1)
                    {
                        foreach (var SecData in SupData.ListSecondrySuppo)
                        {
                            if (SecData.SuppoId.Equals(CombinedParSupp[0][0]))
                            {
                                VerSuppo = SecData;
                            }
                        }
                    }

                    Vec2.X = (VerSuppo.EndPt[0] - VerSuppo.StPt[0]);
                    Vec2.Y = (VerSuppo.EndPt[1] - VerSuppo.StPt[1]);
                    Vec2.Z = (VerSuppo.EndPt[2] - VerSuppo.StPt[2]);

                    Dictionary<string, string> DicIdDir = new Dictionary<string, string>();
                    foreach (var SecData in SupData.ListSecondrySuppo)
                    {
                        if (!SecData.SuppoId.Equals(VerSuppo.SuppoId))
                        {
                            System.Windows.Media.Media3D.Vector3D VecLoc = GetVecStartfrompnts(VerSuppo, SecData);

                            if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(VecLoc, Vec2, Vec3))).Equals(90))
                            {
                                Count1++;

                                DicIdDir[SecData.SuppoId] = "LeftHor";
                            }
                            else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(VecLoc, Vec2, Vec3))).Equals(-90))
                            {
                                Count2++;

                                DicIdDir[SecData.SuppoId] = "RightHor";
                            }
                        }
                        {
                            DicIdDir[SecData.SuppoId] = "Ver";
                        }
                    }

                    List<string> ProecessedPids = new List<string>();

                    if (Count1 == 2 && Count2 == 2)
                    {
                        foreach (var SecData in SupData.ListSecondrySuppo)
                        {
                            foreach (var PsuppoData in SupData.ListPrimarySuppo)
                            {
                                if ((!ProecessedPids.Contains(PsuppoData.SuppoId)) && PsuppoData.TouchingPartid.Equals(SecData.SuppoId))
                                {
                                    ProecessedPids.Add(PsuppoData.SuppoId);
                                }
                            }
                            SecData.PartDirection = DicIdDir[SecData.SuppoId];
                        }

                        if (ProecessedPids.Count == 4)
                        {
                            SupData.SupportType = "Support19";
                            return true;
                        }
                    }
                }
            }

            return false;
        }

        bool CheckforTypeSupport35(ref SupportData SupportData)
        {
            string Orientation = "";
            if (!AreCentroidsinLine(SupportData, ref Orientation))
            {
                //May be Need to Modify the Support
                System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 0, 1);

                Vec1.X = SupportData.ListPrimarySuppo[0].Directionvec.YDirVec.X;
                Vec1.Y = SupportData.ListPrimarySuppo[0].Directionvec.YDirVec.Y;
                Vec1.Z = SupportData.ListPrimarySuppo[0].Directionvec.YDirVec.Z;

                Vec2.X = (SupportData.ListSecondrySuppo[0].EndPt[0] - SupportData.ListSecondrySuppo[0].StPt[0]);
                Vec2.Y = (SupportData.ListSecondrySuppo[0].EndPt[1] - SupportData.ListSecondrySuppo[0].StPt[1]);
                Vec2.Z = (SupportData.ListSecondrySuppo[0].EndPt[2] - SupportData.ListSecondrySuppo[0].StPt[2]);

                if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(0) || Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(180))
                {
                    SupportData.SupportType = "Support35";
                    return true;
                }
            }
            else
            {
                if (SupportData.ListPrimarySuppo[0].SupportName.ToLower().Contains("custom clamp"))
                    SupportData.SupportType = "Support39";
                return true;
            }
            return false;
        }

        bool CheckforTypeSupport86(ref SupportData SupportData)
        {
            if (GetAllISMC(SupportData).Count == 1)
            {
                List<SupporSpecData> SuppSpecData = new List<SupporSpecData>(0);
                String Orientation = "";
                if (GetAllISMC(SupportData).ElementAt(0).Value.ListtouchingParts.Count == 3)
                {
                    if (!CheckCentroidInLine(GetCentroidFromList(SupportData.ListConcreteData), GetDicCentroidPrimaryPart(SupportData), GetCentroidFromList(SuppSpecData), ref Orientation))
                    {
                        SupportData.SupportType = "Support86";
                        return true;
                    }
                }

            }
            return false;
        }
        bool CheckforTypeSupport14(ref SupportData SupportData)
        {
            if (SupportData.ListPrimarySuppo[0].IsSupportNB)
            {
                string Orientation = "";
                if (!AreCentroidsinLine(SupportData, ref Orientation))
                {
                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 0, 1);

                    Vec1.X = SupportData.ListPrimarySuppo[0].NoramlDir.X;
                    Vec1.Y = SupportData.ListPrimarySuppo[0].NoramlDir.Y;
                    Vec1.Z = SupportData.ListPrimarySuppo[0].NoramlDir.Z;

                    Vec2.X = (SupportData.ListSecondrySuppo[0].EndPt[0] - SupportData.ListSecondrySuppo[0].StPt[0]);
                    Vec2.Y = (SupportData.ListSecondrySuppo[0].EndPt[1] - SupportData.ListSecondrySuppo[0].StPt[1]);
                    Vec2.Z = (SupportData.ListSecondrySuppo[0].EndPt[2] - SupportData.ListSecondrySuppo[0].StPt[2]);

                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90))
                    {
                        SupportData.SupportType = "Support14";
                        return true;
                    }

                }
                else
                {
                    SupportData.SupportType = "Support17";
                    return true;
                }
            }
            else
            {
                string Orientation = "";
                if (!AreCentroidsinLine(SupportData, ref Orientation))
                {
                    SupportData.SupportType = "Support14";
                    return true;
                }
                else
                {
                    SupportData.SupportType = "Support17";
                    return true;
                }

            }
            return false;
        }

        // Temporary Hard Coading the support Compare Later we Check All
        List<string> Checkandgetparllelsupports(ref SupportData SupData, ref List<List<string>> CombinedParSupp)
        {
            CombinedParSupp = new List<List<string>>();
            List<string> PallellpartID = new List<string>();
            List<string> ProcessedIds = new List<string>();

            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

            List<string> ListFirstLineParl = new List<string>();
            List<string> ListSecondLineParl = new List<string>();
            List<string> Listthirlinparl = new List<string>();

            Dictionary<string, System.Windows.Media.Media3D.Vector3D> ListVecData = new Dictionary<string, System.Windows.Media.Media3D.Vector3D>();

            foreach (var Data in SupData.ListSecondrySuppo)
            {
                if (Data == null || Data.SupportName == null || Data.SupportName.ToUpper().Equals("PLATE"))
                {
                    continue;
                }

                System.Windows.Media.Media3D.Vector3D Vecr = new System.Windows.Media.Media3D.Vector3D();

                Vecr.X = Data.EndPt[0] - Data.StPt[0];
                Vecr.Y = Data.EndPt[1] - Data.StPt[1];
                Vecr.Z = Data.EndPt[2] - Data.StPt[2];
                Vecr.Normalize();
                ListVecData[Data.SuppoId] = Vecr;
            }

            while (ProcessedIds.Count < ListVecData.Count)
            {
                bool IsStart = true;
                List<string> listParllelId = new List<string>();

                foreach (var data in ListVecData)
                {
                    if (!ProcessedIds.Contains(data.Key))
                    {
                        if (IsStart)
                        {
                            Vec1 = data.Value;
                            listParllelId.Add(data.Key);
                            ProcessedIds.Add(data.Key);
                            IsStart = false;
                        }
                        else
                        {
                            double Angle = System.Windows.Media.Media3D.Vector3D.AngleBetween(Vec1, data.Value);

                            if (Math.Round(Angle).Equals(0) || Math.Round(Angle).Equals(180))
                            {
                                listParllelId.Add(data.Key);
                                ProcessedIds.Add(data.Key);
                            }
                        }
                    }
                }

                CombinedParSupp.Add(listParllelId);
            }

            if (ListVecData.Count > 2)
            {
                for (int inx = 0; inx < ListVecData.Count; inx++)
                {
                    if (inx > 0)
                    {
                        double Angle = System.Windows.Media.Media3D.Vector3D.AngleBetween(ListVecData.ElementAt(0).Value, ListVecData.ElementAt(inx).Value);

                        if (Math.Round(Angle).Equals(0) || Math.Round(Angle).Equals(180))
                        {
                            ListFirstLineParl.Add(ListVecData.ElementAt(inx).Key);
                        }
                        else
                        {
                            ListSecondLineParl.Add(ListVecData.ElementAt(inx).Key);
                        }
                    }
                    else
                    {
                        ListFirstLineParl.Add(ListVecData.ElementAt(0).Key);
                    }
                }
            }

            if (ListSecondLineParl.Count > 1)
            {
                for (int inx = 0; inx < ListSecondLineParl.Count; inx++)
                {
                    if (inx > 0)
                    {
                        double Angle = System.Windows.Media.Media3D.Vector3D.AngleBetween(ListVecData[ListSecondLineParl[0]], ListVecData[ListSecondLineParl[inx]]);

                        if (Math.Round(Angle).Equals(0) || Math.Round(Angle).Equals(180))
                        {
                            Listthirlinparl.Add(ListSecondLineParl[inx]);
                        }
                    }
                    else
                    {
                        Listthirlinparl.Add(ListSecondLineParl[0]);
                    }
                }
            }

            // List<string> ListParSup = new List<string>();

            /* if (Math.Round(SupData.ListSecondrySuppo[0].Angle.XinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[1].Angle.XinDegree)) && Math.Round(SupData.ListSecondrySuppo[0].Angle.YinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[1].Angle.YinDegree)) && Math.Round(SupData.ListSecondrySuppo[0].Angle.ZinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[1].Angle.ZinDegree)))
             {
                 ListParSup.Add(SupData.ListSecondrySuppo[0].SuppoId);
                 ListParSup.Add(SupData.ListSecondrySuppo[1].SuppoId);
             }
             else if (Math.Round(SupData.ListSecondrySuppo[0].Angle.XinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[2].Angle.XinDegree)) && Math.Round(SupData.ListSecondrySuppo[0].Angle.YinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[2].Angle.YinDegree)) && Math.Round(SupData.ListSecondrySuppo[0].Angle.ZinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[2].Angle.ZinDegree)))
             {
                 ListParSup.Add(SupData.ListSecondrySuppo[0].SuppoId);
                 ListParSup.Add(SupData.ListSecondrySuppo[2].SuppoId);
             }
             else if (Math.Round(SupData.ListSecondrySuppo[1].Angle.XinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[2].Angle.XinDegree)) && Math.Round(SupData.ListSecondrySuppo[1].Angle.YinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[2].Angle.YinDegree)) && Math.Round(SupData.ListSecondrySuppo[1].Angle.ZinDegree).Equals(Math.Round(SupData.ListSecondrySuppo[2].Angle.ZinDegree)))
             {
                 ListParSup.Add(SupData.ListSecondrySuppo[1].SuppoId);
                 ListParSup.Add(SupData.ListSecondrySuppo[2].SuppoId);
             }*/

            return ProcessedIds;
        }

        bool CheckforTypeSupport22(ref SupportData SupData)
        {
            List<List<string>> CombinedParSupp = new List<List<string>>();
            List<string> ListProcessedParts = new List<string>();
            ListProcessedParts = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            if (CombinedParSupp.Count == 2)
            {
                try
                {

                    if (CombinedParSupp[0].Count == 2)
                    {
                        List<Pt3D> BPartCentroids = new List<Pt3D>();
                        List<Pt3D> PPartCentroids = new List<Pt3D>();
                        List<Pt3D> SPartCentroids = new List<Pt3D>();

                        PPartCentroids.Add(SupData.ListPrimarySuppo.Find(X => X.TouchingPartid.Equals(CombinedParSupp[0][0])).Centroid);

                        SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).Centroid);

                        SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).Centroid);

                        if (SupData.ListConcreteData.Count > 0)
                        {
                            BPartCentroids = BPartCentroids = GetDicCentroidBottomPart(SupData);
                        }

                        string Orientation = "";

                        if (!CheckCentroidInLine(BPartCentroids, PPartCentroids, SPartCentroids, ref Orientation))
                        {
                            BPartCentroids.Clear();
                            PPartCentroids.Clear();
                            SPartCentroids.Clear();

                            PPartCentroids.Add(SupData.ListPrimarySuppo.Find(X => X.TouchingPartid.Equals(CombinedParSupp[0][1])).Centroid);

                            SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][1]).Centroid);

                            SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).Centroid);

                            if (SupData.ListConcreteData.Count > 0)
                            {
                                BPartCentroids = BPartCentroids = GetDicCentroidBottomPart(SupData);
                            }

                            Orientation = "";

                            if (CheckCentroidInLine(BPartCentroids, PPartCentroids, SPartCentroids, ref Orientation))
                            {
                                System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                                Vec1.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[0]);
                                Vec1.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[1]);
                                Vec1.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[2]);

                                Vec2.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[0]);
                                Vec2.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[1]);
                                Vec2.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[2]);

                                if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90))
                                {
                                    SupData.SupportType = "Support12";
                                    return true;
                                }
                                else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                                {
                                    SupData.SupportType = "Support1";
                                    return true;
                                }
                                else
                                {
                                    return false;
                                }
                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                            Vec1.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][1]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][1]).StPt[0]);
                            Vec1.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][1]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][1]).StPt[1]);
                            Vec1.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][1]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][1]).StPt[2]);

                            Vec2.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[0]);
                            Vec2.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[1]);
                            Vec2.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[2]);

                            if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90))
                            {
                                SupData.SupportType = "Support12";
                                return true;
                            }
                            else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                            {
                                SupData.SupportType = "Support1";
                                return true;
                            }
                            else
                            {
                                return false;
                            }
                        }
                    }
                    else if (CombinedParSupp[1].Count == 2)
                    {
                        List<Pt3D> BPartCentroids = new List<Pt3D>();
                        List<Pt3D> PPartCentroids = new List<Pt3D>();
                        List<Pt3D> SPartCentroids = new List<Pt3D>();

                        PPartCentroids.Add(SupData.ListPrimarySuppo.Find(X => X.TouchingPartid.Equals(CombinedParSupp[1][0])).Centroid);

                        SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).Centroid);

                        SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).Centroid);

                        if (SupData.ListConcreteData.Count > 0)
                        {
                            BPartCentroids = BPartCentroids = GetDicCentroidBottomPart(SupData);
                        }

                        string Orientation = "";

                        if (!CheckCentroidInLine(BPartCentroids, PPartCentroids, SPartCentroids, ref Orientation))
                        {
                            BPartCentroids.Clear();
                            PPartCentroids.Clear();
                            SPartCentroids.Clear();

                            PPartCentroids.Add(SupData.ListPrimarySuppo.Find(X => X.TouchingPartid.Equals(CombinedParSupp[1][1])).Centroid);

                            SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][1]).Centroid);

                            SPartCentroids.Add(SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).Centroid);

                            if (SupData.ListConcreteData.Count > 0)
                            {
                                BPartCentroids = BPartCentroids = GetDicCentroidBottomPart(SupData);
                            }

                            Orientation = "";

                            if (CheckCentroidInLine(BPartCentroids, PPartCentroids, SPartCentroids, ref Orientation))
                            {
                                System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                                Vec1.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[0]);
                                Vec1.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[1]);
                                Vec1.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][0]).StPt[2]);

                                Vec2.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[0]);
                                Vec2.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[1]);
                                Vec2.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[2]);

                                if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90))
                                {
                                    SupData.SupportType = "Support12";
                                    return true;
                                }
                                else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                                {
                                    SupData.SupportType = "Support1";
                                    return true;
                                }
                                else
                                {
                                    return false;
                                }

                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                            Vec1.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][1]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][1]).StPt[0]);
                            Vec1.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][1]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][1]).StPt[1]);
                            Vec1.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][1]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[1][1]).StPt[2]);

                            Vec2.X = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[0] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[0]);
                            Vec2.Y = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[1] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[1]);
                            Vec2.Z = (SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).EndPt[2] - SupData.ListSecondrySuppo.Find(x => x.SuppoId == CombinedParSupp[0][0]).StPt[2]);

                            if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(-90))
                            {
                                SupData.SupportType = "Support12";
                                return true;
                            }
                            else if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
                            {
                                SupData.SupportType = "Support1";
                                return true;
                            }
                            else
                            {
                                return false;
                            }
                        }
                    }
                }
                catch (Exception)
                {
                }
            }

            return false;
        }

        bool CheckforTypeSupport6(ref SupportData SupData)
        {
            List<string> ListParSup = new List<string>();
            List<List<string>> CombinedParSupp = new List<List<string>>();
            ListParSup = Checkandgetparllelsupports(ref SupData, ref CombinedParSupp);

            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);


            if (ListParSup.Count > 0)
            {
                foreach (var Sup in SupData.ListSecondrySuppo)
                {
                    if (ListParSup.Contains(Sup.SuppoId))
                    {
                        Vec1.X = (Sup.EndPt[0] - Sup.StPt[0]);
                        Vec1.Y = (Sup.EndPt[1] - Sup.StPt[1]);
                        Vec1.Z = (Sup.EndPt[2] - Sup.StPt[2]);

                        //GetTouchingPrim
                    }
                    else
                    {
                        Vec2.X = (Sup.EndPt[0] - Sup.StPt[0]);
                        Vec2.Y = (Sup.EndPt[1] - Sup.StPt[1]);
                        Vec2.Z = (Sup.EndPt[2] - Sup.StPt[2]);
                    }
                }
            }

            if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(90))
            {
                foreach (var Sup in SupData.ListSecondrySuppo)
                {
                    if (ListParSup.Contains(Sup.SuppoId))
                    {
                        Sup.PartDirection = "Hor";
                    }
                    else
                    {
                        Sup.PartDirection = "Ver";
                    }
                }

                SupData.SupportType = "Support6";

                return true;
            }

            return false;
        }

        bool CheckforTypeSupport7(ref SupportData SupData)
        {
            if (SupData.ListPrimarySuppo[0].SupportName.Contains("GRP FLG") && SupData.ListPrimarySuppo[1].SupportName.Contains("GRP FLG"))
            {
                System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 0, 1);

                Vec1.X = SupData.ListPrimarySuppo[0].NoramlDir.X;
                Vec1.Y = SupData.ListPrimarySuppo[0].NoramlDir.Y;
                Vec1.Z = SupData.ListPrimarySuppo[0].NoramlDir.Z;
                Vec2.X = SupData.ListPrimarySuppo[1].NoramlDir.X;
                Vec2.Y = SupData.ListPrimarySuppo[1].NoramlDir.Y;
                Vec2.Z = SupData.ListPrimarySuppo[1].NoramlDir.Z;

                if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3))).Equals(180))
                {
                    if (SupData.ListSecondrySuppo.Any(x => x.SupportName == "PLATE"))
                    {
                        SupData.SupportType = "Support7";
                        return true;
                    }
                }
            }

            return false;
        }

        // we are considering this support int the Positive Z Direction 
        bool CheckforTypeSupport8(ref SupportData SupData)
        {
            string Orientation = "";
            if (AreCentroidsinLine(SupData, ref Orientation))
            {
                if (Orientation.Equals("XY"))
                {
                    if (SupData.ListSecondrySuppo.Any(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")))
                    {
                        if (SupData.ListPrimarySuppo[0].Centroid.Z > SupData.ListSecondrySuppo.Find(x => x.SupportName == "PLATE").Centroid.Z && SupData.ListSecondrySuppo.Find(x => x.SupportName == "PLATE").Centroid.Z > SupData.ListSecondrySuppo.Find(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")).Centroid.Z)
                        {

                            if (SupData.ListPrimarySuppo[0].SupportName.Contains("GRP FLG"))
                            {
                                if (Math.Round(Math.Abs(SupData.ListPrimarySuppo[0].FaceLocalAngle.XinDegree - ((SupData.ListSecondrySuppo.Find(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")).Angle.ZinDegree)))).Equals(180) && Math.Round(Math.Abs((SupData.ListPrimarySuppo[0].FaceLocalAngle.ZinDegree) - (SupData.ListSecondrySuppo.Find(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")).Angle.YinDegree))).Equals(90))
                                {
                                    SupData.SupportType = "Support10";
                                    return true;
                                }
                                else if (Math.Round(Math.Abs(SupData.ListPrimarySuppo[0].FaceLocalAngle.XinDegree)).Equals((SupData.ListSecondrySuppo.Find(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")).Angle.ZinDegree)) && Math.Round(Math.Abs((SupData.ListPrimarySuppo[0].FaceLocalAngle.ZinDegree) - (SupData.ListSecondrySuppo.Find(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")).Angle.YinDegree))).Equals(90))
                                {
                                    //this is Support12
                                    SupData.SupportType = "Support10";
                                    return true;
                                }
                            }
                            else if (SupData.ListPrimarySuppo[0].SupportName.Contains("NB"))
                            {
                                if (Math.Round(Math.Abs((SupData.ListPrimarySuppo[0].Angle.XinDegree) - (SupData.ListSecondrySuppo.Find(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")).Angle.XinDegree))).Equals(90) && Math.Round(Math.Abs((SupData.ListPrimarySuppo[0].Angle.ZinDegree) - (SupData.ListSecondrySuppo.Find(x => x.Size != null && x.Size.ToUpper().Contains("SLOPING CHANNEL")).Angle.ZinDegree))).Equals(90))
                                {
                                    SupData.SupportType = "Support8";
                                    return true;
                                }
                            }
                        }
                    }
                }
            }
            else
            {
                return false;
            }

            return false;
        }


        bool CheckforTypeSupport4(ref SupportData SupportData)
        {
            if (Math.Round(SupportData.ListSecondrySuppo[0].Angle.ZinDegree).Equals(Math.Round(SupportData.ListSecondrySuppo[1].Angle.ZinDegree)))
            {
                if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree) > Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree).Equals(90))
                    {
                        if (SupportData.ListSecondrySuppo[0].Centroid.Z > SupportData.ListSecondrySuppo[1].Centroid.Z)
                        {
                            SupporSpecData HorPart = new SupporSpecData();
                            SupporSpecData VerPart = new SupporSpecData();

                            HorPart = SupportData.ListSecondrySuppo[0];
                            VerPart = SupportData.ListSecondrySuppo[1];
                            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                            double[] Closestpt = new double[3];
                            if (Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.StPt)))
                            {
                                Vec1.X = HorPart.EndPt[0] - HorPart.StPt[0];
                                Vec1.Y = HorPart.EndPt[1] - HorPart.StPt[1];
                                Vec1.Z = HorPart.EndPt[2] - HorPart.StPt[2];

                                Closestpt = HorPart.StPt;
                            }
                            else
                            {
                                Vec1.X = HorPart.StPt[0] - HorPart.EndPt[0];
                                Vec1.Y = HorPart.StPt[1] - HorPart.EndPt[1];
                                Vec1.Z = HorPart.StPt[2] - HorPart.EndPt[2];

                                Closestpt = HorPart.EndPt;
                            }

                            Vec2.X = VerPart.EndPt[0] - VerPart.StPt[0];
                            Vec2.Y = VerPart.EndPt[1] - VerPart.StPt[1];
                            Vec2.Z = VerPart.EndPt[2] - VerPart.StPt[2];

                            if (Math.Abs(Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3)))).Equals(90))
                            {
                                if (Calculate.DistPoint(SupportData.ListPrimarySuppo[0].Centroid, GetPt3DFromArray(VerPart.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(Closestpt)))
                                {
                                    if (Math.Round(SupportData.ListSecondrySuppo[1].Boundingboxmax.Z) > Math.Round(SupportData.ListSecondrySuppo[0].Centroid.Z))
                                    {
                                        SupportData.SupportType = "Support5";
                                    }
                                    else
                                    {
                                        SupportData.SupportType = "Support4";
                                    }
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";

                                    return true;
                                }
                            }

                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        return false;
                    }
                }
                else
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree).Equals(90))
                    {
                        if (SupportData.ListSecondrySuppo[0].Centroid.Z < SupportData.ListSecondrySuppo[1].Centroid.Z)
                        {
                            SupporSpecData HorPart = new SupporSpecData();
                            SupporSpecData VerPart = new SupporSpecData();

                            HorPart = SupportData.ListSecondrySuppo[1];
                            VerPart = SupportData.ListSecondrySuppo[0];
                            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);

                            double[] Closestpt = new double[3];
                            if (Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(HorPart.StPt)))
                            {
                                Vec1.X = HorPart.EndPt[0] - HorPart.StPt[0];
                                Vec1.Y = HorPart.EndPt[1] - HorPart.StPt[1];
                                Vec1.Z = HorPart.EndPt[2] - HorPart.StPt[2];

                                Closestpt = HorPart.StPt;
                            }
                            else
                            {
                                Vec1.X = HorPart.StPt[0] - HorPart.EndPt[0];
                                Vec1.Y = HorPart.StPt[1] - HorPart.EndPt[1];
                                Vec1.Z = HorPart.StPt[2] - HorPart.EndPt[2];

                                Closestpt = HorPart.EndPt;
                            }

                            Vec2.X = VerPart.EndPt[0] - VerPart.StPt[0];
                            Vec2.Y = VerPart.EndPt[1] - VerPart.StPt[1];
                            Vec2.Z = VerPart.EndPt[2] - VerPart.StPt[2];

                            if (Math.Abs(Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3)))).Equals(90))
                            {
                                if (Calculate.DistPoint(SupportData.ListPrimarySuppo[0].Centroid, GetPt3DFromArray(VerPart.EndPt)) > Calculate.DistPoint(GetPt3DFromArray(VerPart.EndPt), GetPt3DFromArray(Closestpt)))
                                {
                                    if (Math.Round(SupportData.ListSecondrySuppo[0].Boundingboxmax.Z) > Math.Round(SupportData.ListSecondrySuppo[1].Centroid.Z))
                                    {
                                        SupportData.SupportType = "Support5";
                                    }
                                    else
                                    {
                                        SupportData.SupportType = "Support4";
                                    }
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Ver";

                                    return true;
                                }
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        return false;
                    }
                }
            }

            return false;
        }

        bool CheckforTypeSupport3(ref SupportData SupportData)
        {
            if (SupportData.ListSecondrySuppo[0].Angle.YinDegree.Equals(0) && SupportData.ListSecondrySuppo[1].Angle.YinDegree.Equals(0))
            {
                if (SupportData.ListSecondrySuppo[0].Angle.ZinDegree.Equals(SupportData.ListSecondrySuppo[1].Angle.ZinDegree))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree) > Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree))
                    {
                        if (Math.Abs(Math.Round(SupportData.ListSecondrySuppo[0].Angle.XinDegree - SupportData.ListSecondrySuppo[1].Angle.XinDegree)).Equals(45))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].StPt[0]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].StPt[0])) || Math.Round(SupportData.ListSecondrySuppo[0].EndPt[0]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].EndPt[0])) || (Math.Round(SupportData.ListSecondrySuppo[0].StPt[1]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].StPt[1])) || Math.Round(SupportData.ListSecondrySuppo[0].EndPt[1]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].EndPt[1]))) || (Math.Round(SupportData.ListSecondrySuppo[0].StPt[2]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].StPt[2])) || Math.Round(SupportData.ListSecondrySuppo[0].EndPt[2]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].EndPt[2]))))
                            {
                                SupportData.ListSecondrySuppo[1].PartDirection = "45Inclined";
                                SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                SupportData.SupportType = "Support3";
                                return true;
                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        if (Math.Abs(Math.Round(SupportData.ListSecondrySuppo[1].Angle.XinDegree)).Equals(90) && Math.Abs(Math.Round(SupportData.ListSecondrySuppo[0].Angle.XinDegree)).Equals(45))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].StPt[0]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].StPt[0])) || Math.Round(SupportData.ListSecondrySuppo[0].EndPt[0]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].EndPt[0])) || (Math.Round(SupportData.ListSecondrySuppo[0].StPt[1]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].StPt[1])) || Math.Round(SupportData.ListSecondrySuppo[0].EndPt[1]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].EndPt[1]))) || (Math.Round(SupportData.ListSecondrySuppo[0].StPt[2]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].StPt[2])) || Math.Round(SupportData.ListSecondrySuppo[0].EndPt[2]).Equals(Math.Round(SupportData.ListSecondrySuppo[1].EndPt[2]))))
                            {
                                SupportData.ListSecondrySuppo[0].PartDirection = "45Inclined";
                                SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                SupportData.SupportType = "Support3";
                                return true;
                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }
            }
            return false;
        }

        bool CheckforTypeSupport34(ref SupportData SupportData)
        {
            int Index0 = 0;
            int Index1 = 0;

            bool IsIndex0 = false;

            for (int inx = 0; inx < SupportData.ListSecondrySuppo.Count; inx++)
            {
                if (SupportData.ListSecondrySuppo[inx].Size != null && SupportData.ListSecondrySuppo[inx].Size.ToLower().Contains("web"))
                {
                    if (!IsIndex0)
                    {
                        Index0 = inx;
                        IsIndex0 = true;
                    }
                    else
                    {
                        Index1 = inx;
                    }
                }
            }

            if (SupportData.ListSecondrySuppo[Index0].Angle.YinDegree.Equals(0) && SupportData.ListSecondrySuppo[Index1].Angle.YinDegree.Equals(0))
            {
                if (SupportData.ListSecondrySuppo[Index0].Angle.ZinDegree.Equals(SupportData.ListSecondrySuppo[Index1].Angle.ZinDegree))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[Index0].Angle.XinDegree) > Math.Abs(SupportData.ListSecondrySuppo[Index1].Angle.XinDegree))
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[Index0].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[Index0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[Index1].Centroid.X) && SupportData.ListSecondrySuppo[Index0].Centroid.Z > SupportData.ListSecondrySuppo[Index1].Centroid.Z)
                            {

                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {


                                }
                                else
                                {

                                    SupportData.SupportType = "Support34";
                                    SupportData.ListSecondrySuppo[Index0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[Index1].PartDirection = "Ver";
                                    return true;
                                }
                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[Index1].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[Index0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[Index1].Centroid.X) && SupportData.ListSecondrySuppo[Index0].Centroid.Z < SupportData.ListSecondrySuppo[Index1].Centroid.Z)
                            {
                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                }
                                else
                                {

                                    SupportData.SupportType = "Support34";
                                    SupportData.ListSecondrySuppo[Index1].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[Index0].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }
                else if (Math.Round(Math.Abs((SupportData.ListSecondrySuppo[0].Angle.ZinDegree) - (SupportData.ListSecondrySuppo[1].Angle.ZinDegree))).Equals(180))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree) > Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree))
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.X) && SupportData.ListSecondrySuppo[0].Centroid.Z > SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {

                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[1].EndPt[0] - SupportData.ListSecondrySuppo[1].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[1].EndPt[1] - SupportData.ListSecondrySuppo[1].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[1].EndPt[2] - SupportData.ListSecondrySuppo[1].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support15";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), SupportData.ListSecondrySuppo[0].StPt, SupportData.ListSecondrySuppo[0].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.X) && SupportData.ListSecondrySuppo[0].Centroid.Z < SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {
                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[0].EndPt[0] - SupportData.ListSecondrySuppo[0].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[0].EndPt[1] - SupportData.ListSecondrySuppo[0].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[0].EndPt[2] - SupportData.ListSecondrySuppo[0].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support15";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), SupportData.ListSecondrySuppo[1].StPt, SupportData.ListSecondrySuppo[1].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }
                else if (Math.Round(Math.Abs((SupportData.ListSecondrySuppo[0].Angle.ZinDegree) - (SupportData.ListSecondrySuppo[1].Angle.ZinDegree))).Equals(90))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree) < Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree))
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.Y) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.Y) && SupportData.ListSecondrySuppo[0].Centroid.Z < SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {

                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[1].EndPt[0] - SupportData.ListSecondrySuppo[1].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[1].EndPt[1] - SupportData.ListSecondrySuppo[1].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[1].EndPt[2] - SupportData.ListSecondrySuppo[1].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support23";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), SupportData.ListSecondrySuppo[0].StPt, SupportData.ListSecondrySuppo[0].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.Y) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.Y) && SupportData.ListSecondrySuppo[0].Centroid.Z > SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {
                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[0].EndPt[0] - SupportData.ListSecondrySuppo[0].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[0].EndPt[1] - SupportData.ListSecondrySuppo[0].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[0].EndPt[2] - SupportData.ListSecondrySuppo[0].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-180))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(180))
                                    {
                                        SupportData.SupportType = "Support23";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), SupportData.ListSecondrySuppo[1].StPt, SupportData.ListSecondrySuppo[1].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }
            }

            if (SupportData.ListSecondrySuppo.Any(Y => Y.Size.ToLower().Contains("angle")))
            {
                string Orientation = "";
                if (AreCentroidsinLine(SupportData, ref Orientation))
                {

                }


            }

            return false;
        }
        bool CheckforTypeSupport2(ref SupportData SupportData)
        {
            if (SupportData.ListSecondrySuppo[0].Angle.YinDegree.Equals(0) && SupportData.ListSecondrySuppo[1].Angle.YinDegree.Equals(0))
            {
                if (SupportData.ListSecondrySuppo[0].Angle.ZinDegree.Equals(SupportData.ListSecondrySuppo[1].Angle.ZinDegree))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree) > Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree))
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.X) && SupportData.ListSecondrySuppo[0].Centroid.Z > SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {

                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[1].EndPt[0] - SupportData.ListSecondrySuppo[1].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[1].EndPt[1] - SupportData.ListSecondrySuppo[1].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[1].EndPt[2] - SupportData.ListSecondrySuppo[1].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support15";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }
                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.X) && SupportData.ListSecondrySuppo[0].Centroid.Z < SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {
                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[0].EndPt[0] - SupportData.ListSecondrySuppo[0].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[0].EndPt[1] - SupportData.ListSecondrySuppo[0].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[0].EndPt[2] - SupportData.ListSecondrySuppo[0].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support15";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }
                else if (Math.Round(Math.Abs((SupportData.ListSecondrySuppo[0].Angle.ZinDegree) - (SupportData.ListSecondrySuppo[1].Angle.ZinDegree))).Equals(180))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree) > Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree))
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.X) && SupportData.ListSecondrySuppo[0].Centroid.Z > SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {

                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[1].EndPt[0] - SupportData.ListSecondrySuppo[1].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[1].EndPt[1] - SupportData.ListSecondrySuppo[1].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[1].EndPt[2] - SupportData.ListSecondrySuppo[1].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support15";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), SupportData.ListSecondrySuppo[0].StPt, SupportData.ListSecondrySuppo[0].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.X) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.X) && SupportData.ListSecondrySuppo[0].Centroid.Z < SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {
                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[0].EndPt[0] - SupportData.ListSecondrySuppo[0].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[0].EndPt[1] - SupportData.ListSecondrySuppo[0].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[0].EndPt[2] - SupportData.ListSecondrySuppo[0].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support15";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), SupportData.ListSecondrySuppo[1].StPt, SupportData.ListSecondrySuppo[1].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }
                else if (Math.Round(Math.Abs((SupportData.ListSecondrySuppo[0].Angle.ZinDegree) - (SupportData.ListSecondrySuppo[1].Angle.ZinDegree))).Equals(90))
                {
                    if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree) < Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree))
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[0].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.Y) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.Y) && SupportData.ListSecondrySuppo[0].Centroid.Z < SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {

                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[1].EndPt[0] - SupportData.ListSecondrySuppo[1].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[1].EndPt[1] - SupportData.ListSecondrySuppo[1].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[1].EndPt[2] - SupportData.ListSecondrySuppo[1].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-90))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(90))
                                    {
                                        SupportData.SupportType = "Support23";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), SupportData.ListSecondrySuppo[0].StPt, SupportData.ListSecondrySuppo[0].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                    else
                    {
                        if (Math.Abs(SupportData.ListSecondrySuppo[1].Angle.XinDegree).Equals(90))
                        {
                            if (Math.Round(SupportData.ListSecondrySuppo[0].Centroid.Y) == Math.Round(SupportData.ListSecondrySuppo[1].Centroid.Y) && SupportData.ListSecondrySuppo[0].Centroid.Z > SupportData.ListSecondrySuppo[1].Centroid.Z)
                            {
                                string Orientation = "";
                                if (!AreCentroidsinLine(SupportData, ref Orientation))
                                {

                                    System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
                                    Vec1.X = (SupportData.ListPrimarySuppo[0].Centroid.X - SupportData.ListSecondrySuppo[0].Centroid.X);
                                    Vec1.Y = (SupportData.ListPrimarySuppo[0].Centroid.Y - SupportData.ListSecondrySuppo[0].Centroid.Y);
                                    Vec1.Z = 0;

                                    Vec2.X = (SupportData.ListSecondrySuppo[0].EndPt[0] - SupportData.ListSecondrySuppo[0].StPt[0]);
                                    Vec2.Y = (SupportData.ListSecondrySuppo[0].EndPt[1] - SupportData.ListSecondrySuppo[0].StPt[1]);
                                    Vec2.Z = (SupportData.ListSecondrySuppo[0].EndPt[2] - SupportData.ListSecondrySuppo[0].StPt[2]);

                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(-180))
                                    {
                                        SupportData.SupportType = "Support16";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                    if (Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec2, Vec1, Vec3))).Equals(180))
                                    {
                                        SupportData.SupportType = "Support23";
                                        SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                        SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                        return true;
                                    }
                                }
                                else
                                {

                                    SupportData.SupportType = "Support2";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Ver";
                                    return true;
                                }


                            }
                            else
                            {

                                var MidPt = FindPerpendicularFoot(GetPt3DFromArray(SupportData.ListSecondrySuppo[0].EndPt), SupportData.ListSecondrySuppo[1].StPt, SupportData.ListSecondrySuppo[1].EndPt);

                                double Dist1 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromPoint3D(MidPt));

                                double Dist2 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt), GetPt3DFromPoint3D(MidPt));

                                double Dist3 = Calculate.DistPoint(GetPt3DFromArray(SupportData.ListSecondrySuppo[1].StPt), GetPt3DFromArray(SupportData.ListSecondrySuppo[1].EndPt));

                                if (Math.Round(Dist3).Equals(Math.Round(Dist2 + Dist1)))
                                {

                                    SupportData.SupportType = "Support24";
                                    SupportData.ListSecondrySuppo[0].PartDirection = "Hor";
                                    SupportData.ListSecondrySuppo[1].PartDirection = "Ver";
                                    return true;
                                }

                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }
            }

            //if (SupportData.ListSecondrySuppo.Any(Y => Y.Size.ToLower().Contains("angle")))
            //{
            //    string Orientation = "";
            //    if (AreCentroidsinLine(SupportData, ref Orientation))
            //    {

            //    }


            //}

            return false;
        }
        /// <summary> 
        /// Here we will add the Key for dictionary 
        /// the key will contain first letter i.e prefix of support type 
        /// Next letters to the prefix will be Number of that support
        /// </summary>
        /// 
        SupportData GetRotationofParts(SupportData SData)
        {
            SupportData SupportAnglesData = new SupportData();

            if (SData.ListConcreteData.Count > 0)
            {
                for (int inx = 0; inx < SData.ListConcreteData.Count; inx++)
                {
                    SData.ListConcreteData[inx].Angle =
                    GetRotationFromVec(SData.ListConcreteData[inx].Directionvec);

                    //SupportAnglesData.ListConcreteData.Add(Data.ListConcreteData[inx]);
                }
            }

            if (SData.ListPrimarySuppo.Count > 0)
            {
                //Will b modified depending upon the reading 
                for (int inx = 0; inx < SData.ListPrimarySuppo.Count; inx++)
                {
                    // DicPartAngles[SData.ListPrimarySuppo[inx].SuppoId] = GetRotationFromVec(SData.ListPrimarySuppo[inx].Directionvec);

                    SData.ListPrimarySuppo[inx].Angle =
                       GetRotationFromVec(SData.ListPrimarySuppo[inx].Directionvec);

                    // DicPartAngles[SData.ListPrimarySuppo[inx].SuppoId] = SData.ListPrimarySuppo[inx];
                }
            }

            if (SData.ListSecondrySuppo.Count > 0)
            {
                for (int inx = 0; inx < SData.ListSecondrySuppo.Count; inx++)
                {
                    // DicPartAngles[SData.ListSecondrySuppo[inx].SuppoId] = GetRotationFromVec(SData.ListSecondrySuppo[inx].Directionvec);

                    SData.ListSecondrySuppo[inx].Angle =
                           GetRotationFromVec(SData.ListSecondrySuppo[inx].Directionvec);

                    //DicPartAngles[SData.ListSecondrySuppo[inx].SuppoId] = SData.ListSecondrySuppo[inx];
                }
            }

            return SData;
        }
        Angles GetRotationFromVec(DirectionVec Dirvec)
        {
            Angles AngleData = new Angles();

            double[,] MatrixArr = GetArrayFromVec(Dirvec);

            double[] AngleinRadian = Calculate.RotM2Eul(MatrixArr, AxisSequence.XYZ, AngleUnit.Radiant);

            // we need to change some logic here because we can use formula directly here of convert degree to work faster
            double[] AngleinDegree = Calculate.RotM2Eul(MatrixArr, AxisSequence.XYZ, AngleUnit.Degrees);

            if (AngleinRadian.GetLength(0) == 3)
            {
                AngleData.XinRadian = AngleinRadian[0];
                AngleData.YinRadian = AngleinRadian[1];
                AngleData.ZinRadian = AngleinRadian[2];
            }

            if (AngleinDegree.GetLength(0) == 3)
            {
                AngleData.XinDegree = AngleinDegree[0];
                AngleData.YinDegree = AngleinDegree[1];
                AngleData.ZinDegree = AngleinDegree[2];
            }

            return AngleData;
        }

        double[,] GetArrayFromVec(DirectionVec Dirvec)
        {
            //Dirvec.
            double[,] ArrayVec = new double[3, 3];

            ArrayVec[0, 0] = Dirvec.XDirVec.X;
            ArrayVec[0, 1] = Dirvec.XDirVec.Y;
            ArrayVec[0, 2] = Dirvec.XDirVec.Z;
            ArrayVec[1, 0] = Dirvec.YDirVec.X;
            ArrayVec[1, 1] = Dirvec.YDirVec.Y;
            ArrayVec[1, 2] = Dirvec.YDirVec.Z;
            ArrayVec[2, 0] = Dirvec.ZDirVec.X;
            ArrayVec[2, 1] = Dirvec.ZDirVec.Y;
            ArrayVec[2, 2] = Dirvec.ZDirVec.Z;

            return ArrayVec;
        }

        bool AreCentroidsinLine(SupportData SData, ref string Orientation)
        {
            List<Pt3D> BPartCentroids = new List<Pt3D>();
            List<Pt3D> PPartCentroids = new List<Pt3D>();
            List<Pt3D> SPartCentroids = new List<Pt3D>();

            BPartCentroids = GetDicCentroidBottomPart(SData);
            PPartCentroids = GetDicCentroidPrimaryPart(SData);
            SPartCentroids = GetDicCentroidSPart(SData);

            return CheckCentroidInLine(BPartCentroids, PPartCentroids, SPartCentroids, ref Orientation);
        }

        bool CheckCentroidInLine(List<Pt3D> BPartCentroids, List<Pt3D> PPartCentroids, List<Pt3D> SPartCentroids, ref string Orientation)
        {
            bool AllXAreinLine = true;
            bool AllYAreinLine = true;
            bool AllZAreinLine = true;
            List<double> ListXPt = new List<double>();
            List<double> ListYPt = new List<double>();
            List<double> ListZPt = new List<double>();

            ListXPt = GetAllPtList(BPartCentroids, PPartCentroids, SPartCentroids, "X");
            ListYPt = GetAllPtList(BPartCentroids, PPartCentroids, SPartCentroids, "Y");
            ListZPt = GetAllPtList(BPartCentroids, PPartCentroids, SPartCentroids, "Z");

            for (int inx = 0; inx < ListXPt.Count; inx++)
            {
                if (Math.Abs(ListXPt[0] - ListXPt[inx]) > 5)
                {
                    AllXAreinLine = false;
                    break;
                }
            }

            for (int inx = 0; inx < ListYPt.Count; inx++)
            {
                if (Math.Abs(ListYPt[0] - ListYPt[inx]) > 5)
                {
                    AllYAreinLine = false;
                    break;
                }
            }

            for (int inx = 0; inx < ListZPt.Count; inx++)
            {
                if (Math.Abs(ListZPt[0] - ListZPt[inx]) > 5)
                {
                    AllZAreinLine = false;
                    break;
                }
            }

            if (AllXAreinLine && AllYAreinLine)
            {
                Orientation = "XY";
                return true;
            }
            else if (AllXAreinLine && AllZAreinLine)
            {
                Orientation = "XZ";
                return true;
            }
            else if (AllYAreinLine && AllZAreinLine)
            {
                Orientation = "YZ";
                return true;
            }

            return false;
        }

        List<double> GetAllPtList(List<Pt3D> BPartCentroids, List<Pt3D> PPartCentroids, List<Pt3D> SPartCentroids, string Coordinate)
        {
            List<double> ListCordinate = new List<double>();
            if (BPartCentroids != null && BPartCentroids.Count > 0)
            {
                foreach (Pt3D Pnt in BPartCentroids)
                {
                    if (Coordinate == "X")
                    {
                        ListCordinate.Add(Pnt.X);
                    }
                    else if (Coordinate == "Y")
                    {
                        ListCordinate.Add(Pnt.Y);
                    }
                    else if (Coordinate == "Z")
                    {
                        ListCordinate.Add(Pnt.Z);
                    }
                }
            }

            if (PPartCentroids != null && PPartCentroids.Count > 0)
            {
                foreach (Pt3D Pnt in PPartCentroids)
                {
                    if (Coordinate == "X")
                    {
                        ListCordinate.Add(Pnt.X);
                    }
                    else if (Coordinate == "Y")
                    {
                        ListCordinate.Add(Pnt.Y);
                    }
                    else if (Coordinate == "Z")
                    {
                        ListCordinate.Add(Pnt.Z);
                    }
                }
            }

            if (SPartCentroids != null && SPartCentroids.Count > 0)
            {
                foreach (Pt3D Pnt in SPartCentroids)
                {
                    if (Coordinate == "X")
                    {
                        ListCordinate.Add(Pnt.X);
                    }
                    else if (Coordinate == "Y")
                    {
                        ListCordinate.Add(Pnt.Y);
                    }
                    else if (Coordinate == "Z")
                    {
                        ListCordinate.Add(Pnt.Z);
                    }
                }
            }

            return ListCordinate;
        }

        List<Pt3D> GetDicCentroidPrimaryPart(SupportData SData)
        {
            List<Pt3D> Centroids = new List<Pt3D>();
            if (SData.ListPrimarySuppo.Count > 0)
            {
                foreach (var BPart in SData.ListPrimarySuppo)
                {
                    Centroids.Add(BPart.Centroid);
                }

                return Centroids;
            }

            return null;
        }

        List<Pt3D> GetDicCentroidSPart(SupportData SData)
        {
            List<Pt3D> Centroids = new List<Pt3D>();
            if (SData.ListSecondrySuppo.Count > 0)
            {
                foreach (var BPart in SData.ListSecondrySuppo)
                {
                    if (!BPart.IsGussetplate)
                    {
                        Centroids.Add(BPart.Centroid);
                    }
                }

                return Centroids;
            }

            return null;
        }

        List<Pt3D> GetDicCentroidBottomPart(SupportData SData)
        {
            List<Pt3D> Centroids = new List<Pt3D>();
            if (SData.ListConcreteData.Count > 0)
            {
                foreach (var BPart in SData.ListConcreteData)
                {
                    Centroids.Add(BPart.Centroid);
                }
                return Centroids;
            }

            return null;
        }

        double GetQuantityofParts(List<double> ListLenght)
        {
            double sum = 0.0;
            foreach (double value in ListLenght)
            {
                sum += value;
            }

            return sum / 1000;
        }

        public void MakeBlockwithTag()
        {
            Document AcadDoc = null;
            Database AcadDatabase = null;
            Document Document2D = null;

            AcadDoc = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument;
            string Filename = AcadDoc.Name;
            AcadDatabase = AcadDoc.Database;

            /*
            using (AcadDoc.LockDocument())
            {
                using (Transaction AcadTransaction = AcadDatabase.TransactionManager.StartTransaction())
                {
                    int tnx = 1;
                    for (int inx=0; inx<ListCentalSuppoData.Count; inx++)
                    {
                        BlockTable BTable = AcadTransaction.GetObject(AcadDatabase.BlockTableId, OpenMode.ForRead) as BlockTable;

                        tnx = inx;
                        while (BTable.Has("TS-"+tnx))
                        {
                            tnx++;
                        }

                        if (!BTable.Has("TS-" + tnx))
                        {
                            BlockTableRecord AcadBTableRec = new BlockTableRecord();
                            AcadBTableRec.Name = "TS-" + tnx;

                            // Add the new block to the block table

                            BTable.UpgradeOpen();

                            ObjectId btrId = BTable.Add(AcadBTableRec);

                            //tr.AddNewlyCreatedDBObject(btr, true);



                           


                           // DBObjectCollection ents = SquareOfLines(5);

                            //foreach (Entity ent in ents)

                           // {

                                btr.AppendEntity(ent);

                                tr.AddNewlyCreatedDBObject(ent, true);

                           // }



                            // Add a block reference to the model space



                            BlockTableRecord ms =

                              (BlockTableRecord)tr.GetObject(

                                bt[BlockTableRecord.ModelSpace],

                                OpenMode.ForWrite

                              );



                            BlockReference br =

                              new BlockReference(Point3d.Origin, btrId);



                            ms.AppendEntity(br);

                            tr.AddNewlyCreatedDBObject(br, true);


                        }

                        Suppo.ListConcreteData.
                    }
                }
            }*/
        }

        [Obsolete]
        public void Create2D()
        {

            Document AcadDoc = null;
            Database AcadDatabase = null;
            Document Document2D = null;

            AcadDoc = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument;
            string Filename = AcadDoc.Name;
            AcadDatabase = AcadDoc.Database;

            using (AcadDoc.LockDocument())
            {
                using (Transaction AcadTransaction = AcadDatabase.TransactionManager.StartTransaction())
                {
                    try
                    {
                        DocumentCollection AcadDocumentCollection = Application.DocumentManager;
                        Document2D = AcadDocumentCollection.Add("acad.dwt");
                    }
                    catch (Exception)
                    {
                    }
                }
            }

            //Creates 2D View
            Create2DViewWithTemp(Document2D);
            //Create2DView(Document2D);
            LastLog();
            Database newDb = AcadDatabase.Wblock();
            string Path = System.IO.Path.GetDirectoryName(Filename);
            newDb.SaveAs(Path + "2d.dwg", DwgVersion.Current);
            Thread t = new Thread(SP);
            t.Start();
            t.Join();
            Document2D.CloseAndSave(Path + "2d.dwg");
        }

        void LastLog()
        {
            List<string> NotExtractedSup = new List<string>();
            int CountCreted = 0;
            int CountNotCreted = 0;
            foreach (var Tag in DicTextPos)
            {
                if (Created_TAG.Contains(Tag.Key))
                {
                    CountCreted++;
                }
                else
                {
                    NotExtractedSup.Add(Tag.Key);
                    CountNotCreted++;
                }
            }

            Logger.GetInstance.Debug("Total Tags in drawing: " + DicTextPos.Count.ToString());
            Logger.GetInstance.Debug("Created Support with Tag: " + CountCreted.ToString());

            Logger.GetInstance.Debug("Total supports created :" + Created_TAG.Count.ToString());

            Logger.GetInstance.Debug("Supports not Created but having Tag Count :" + NotExtractedSup.ToString());

            Logger.GetInstance.Debug("Not Created Supports:" + CountNotCreted.ToString());
            string Name = "";
            int Count = 0;
            foreach (string SupName in NotExtractedSup)
            {
                Name = Name + SupName + ",";

                if (Count == 20)
                {
                    Logger.GetInstance.Debug("Tag No of Not Created Support:" + Name);
                    Name = "";
                    Count++;
                }
                Count++;
            }
            Logger.GetInstance.Debug("Tag No of Not Created Support:" + Name);
        }
        public void CreateConcreteBOM()
        {

#if _DEBUG
            return;
#endif
            Document AcadDoc = null;
            Database AcadDatabase = null;
            Document Document2D = null;

            AcadDoc = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument;
            string Filename = AcadDoc.Name;
            AcadDatabase = AcadDoc.Database;

            using (AcadDoc.LockDocument())
            {
                using (Transaction AcadTransaction = AcadDatabase.TransactionManager.StartTransaction())
                {
                    try
                    {
                        DocumentCollection AcadDocumentCollection = Application.DocumentManager;
                        Document2D = AcadDocumentCollection.Add("acad.dwt");
                    }
                    catch (Exception)
                    {
                    }
                }
            }



            //Creates 2D View
            Create2DForConcreteBOM(Document2D);
            //Create2DView(Document2D);




            Database newDb = AcadDatabase.Wblock();
            string Path = System.IO.Path.GetDirectoryName(Filename);
            newDb.SaveAs(Path + "ConcreteBOM.dwg", DwgVersion.Current);
            Thread t = new Thread(SP);
            t.Start();
            t.Join();
            Document2D.CloseAndSave(Path + "ConcreteBOM.dwg");
        }

        List<Table> CreateBomPedestal(Dictionary<string, PedastalData> BomData)
        {
            int CountBOMData = 0;
            int Level = 0;

            List<Table> ListBomTable = new List<Table>();

            for (int dnx = CountBOMData; (dnx + (150 * Level)) < BomData.Count; dnx++)
            {
                Table BomTable = new Table();
                BomTable.SetSize(150 + 2, 7);
                string[,] str = new string[150 + 2, 7];
                str[0, 0] = "SUPPORT PEDESTAL NO.";
                str[0, 1] = "L";
                str[0, 2] = "W";
                str[0, 3] = "H";
                str[0, 4] = "INSERT PLATE NO";
                str[0, 5] = "QTY";

                //Autodesk.AutoCAD.DatabaseServices.CellRange rowFirst = Autodesk.AutoCAD.DatabaseServices.CellRange.Create(BomTable, 0, 0, 0, 6);
                // BomTable.MergeCells(rowFirst);

                for (int iCo1 = 0; iCo1 < BomTable.Rows.Count; iCo1++)
                    BomTable.Rows[iCo1].Height = 400;

                for (int iCo1 = 0; iCo1 < 6; iCo1++)
                {
                    BomTable.Columns[iCo1].Width = 1000;
                    /* if (iCo1 == 0)
                     {
                         BomTable.Columns[iCo1].Width = 1000;
                     }
                     else if (iCo1 == 1 || iCo1 == 2)
                     {
                         BomTable.Columns[iCo1].Width = 2500;
                     }
                     else if (iCo1 == 3 || iCo1 == 5 || iCo1 == 6)
                     {
                         BomTable.Columns[iCo1].Width = 1500;
                     }
                     else if (iCo1 == 8)
                     {
                         BomTable.Columns[iCo1].Width = 1;
                     }
                     else
                     {
                         BomTable.Columns[iCo1].Width = 1000;
                     }*/
                }

                int iNo = 1;

                for (int inx = 0; inx < 150 && (inx + (150 * Level)) < BomData.Count; inx++)
                {
                    for (int iCount1 = 0; iCount1 < 8; iCount1++)
                    {
                        if (iCount1 == 0)
                            str[iNo, iCount1] = BomData.ElementAt(inx).Key;
                        if (iCount1 == 1)
                            str[iNo, iCount1] = (Math.Round(BomData.ElementAt(inx + (150 * Level)).Value.L)).ToString();
                        if (iCount1 == 2)
                            str[iNo, iCount1] = (Math.Round(BomData.ElementAt(inx + (150 * Level)).Value.W)).ToString();
                        if (iCount1 == 3)
                            str[iNo, iCount1] = (Math.Round(BomData.ElementAt(inx + (150 * Level)).Value.H)).ToString();
                        if (iCount1 == 4)
                            str[iNo, iCount1] = "";
                        if (iCount1 == 5)
                            str[iNo, iCount1] = "1";
                        if (iCount1 == 6)
                            str[iNo, iCount1] = "";
                    }

                    iNo++;
                }

                for (int i = 0; i < BomTable.Rows.Count; i++)
                {
                    for (int j = 0; j < 6; j++)
                    {
                        BomTable.Cells[i, j].TextHeight = 140;
                        BomTable.Cells[i, j].Contents[0].TextString = "{\\fArial;" + str[i, j] + "}";
                        BomTable.Cells[i, j].Alignment = CellAlignment.MiddleCenter;
                    }
                }

                BomTable.DeleteColumns(BomTable.Columns.Count - 1, 1);
                //BomTable.Position = new Point3d(tracex, -BomTable.Height + spaceY, 0);

                ListBomTable.Add(BomTable);
                Level++;
            }
            // AcadBlockTableRecord.AppendEntity(BomTable);
            //AcadTransaction.AddNewlyCreatedDBObject(BomTable, true);

            return ListBomTable;
        }
        Dictionary<string, PedastalData> GetBomData()
        {
            Dictionary<string, PedastalData> BomDic = new Dictionary<string, PedastalData>();

            for (int i = 0; i < ListCentalSuppoData.Count; i++)
            {
                if (ListCentalSuppoData[i].Name != null && ListCentalSuppoData[i].Name.Length > 0)
                {
                    PedastalData PestalSize = new PedastalData();
                    if (ListCentalSuppoData[i].ListConcreteData.Count == 1)
                    {
                        PestalSize = GetSize(ListCentalSuppoData[i].ListConcreteData[0]);
                    }
                    else if (ListCentalSuppoData[i].ListConcreteData.Count == 2)
                    {
                        if ((ListCentalSuppoData[i].ListConcreteData != null) && ListCentalSuppoData[i].ListConcreteData[1].BoxData != null && ListCentalSuppoData[i].ListConcreteData[0].BoxData != null && ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z > ListCentalSuppoData[i].ListConcreteData[1].BoxData.Z)
                        {
                            PestalSize = GetSize(ListCentalSuppoData[i].ListConcreteData[0]);
                        }
                        else
                        {
                            PestalSize = GetSize(ListCentalSuppoData[i].ListConcreteData[1]);
                        }
                    }

                    if (ListCentalSuppoData[i].Name != null && PestalSize != null)
                    {
                        BomDic[ListCentalSuppoData[i].Name] = PestalSize;
                    }
                }
            }

            return BomDic;
        }

        PedastalData GetSize(SupporSpecData Suppo)
        {
            PedastalData PestalSize = new PedastalData();
            if (Suppo.BoxData != null)
            {
                PestalSize.H = Suppo.BoxData.Z;

                if (Suppo.ListfaceData != null)
                {
                    foreach (var face in Suppo.ListfaceData)
                    {
                        if (Math.Abs(face.FaceNormal.X - 0) < 0.02 && Math.Abs(face.FaceNormal.Y - 0) < 0.02 && Math.Abs(face.FaceNormal.Y + 1) < 0.02)
                        {
                            List<double> ListEdgeLen = new List<double>();

                            foreach (var Edge in face.ListlinearEdge)
                            {
                                ListEdgeLen.Add(Edge.EdgeLength);
                            }

                            ListEdgeLen.Sort();

                            if (ListEdgeLen.Count == 4)
                            {
                                PestalSize.L = ListEdgeLen[3];
                                PestalSize.W = ListEdgeLen[1];
                            }


                        }
                    }
                }

                if (PestalSize.L == 0 && PestalSize.W == 0)
                {
                    PestalSize.L = Suppo.BoxData.X;
                    PestalSize.W = Suppo.BoxData.Y;
                }
            }
            return PestalSize;
        }

        string GetSizeofPlate(List<FaceData> ListfaceData)
        {
            string Size = "";
            List<double> ListEdgeLen = new List<double>();
            foreach (var face in ListfaceData)
            {
                foreach (var Edge in face.ListlinearEdge)
                {
                    ListEdgeLen.Add(Edge.EdgeLength);
                }
            }

            ListEdgeLen.Sort();

            if (ListEdgeLen.Count == 24)
            {
                Size = Math.Abs(ListEdgeLen[16]).ToString() + "x" + Math.Abs(ListEdgeLen[8]).ToString() + "x" + Math.Abs(ListEdgeLen[0]).ToString();
            }

            return Size;
        }
        void Create2DView(Document Document2D)
        {
            Database AcadDatabase = Document2D.Database;
            Transaction AcadTransaction = null;
            BlockTable AcadBlockTable = null;
            BlockTableRecord AcadBlockTableRecord = null;

            using (Document2D.LockDocument())
            {
                AcadTransaction = AcadDatabase.TransactionManager.StartTransaction();

                AcadBlockTable = AcadTransaction.GetObject(AcadDatabase.BlockTableId,
                                                               OpenMode.ForRead) as BlockTable;

                AcadBlockTableRecord = AcadTransaction.GetObject(AcadBlockTable[BlockTableRecord.ModelSpace],
                                                OpenMode.ForWrite) as BlockTableRecord;

                var SupportLine = new Polyline();

                Point2d Pt2D = new Point2d(0, 0);

                SupportLine.AddVertexAt(0, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(10, 0);
                SupportLine.AddVertexAt(1, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(10, 10);
                SupportLine.AddVertexAt(2, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(0, 10);
                SupportLine.AddVertexAt(3, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(0, 0);
                SupportLine.AddVertexAt(4, Pt2D, 0, 0, 0);

                SupportLine.Color = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Red);

                AcadBlockTableRecord.AppendEntity(SupportLine);
                AcadTransaction.AddNewlyCreatedDBObject(SupportLine, true);

                AcadTransaction.Commit();
            }
        }

        [Obsolete]
        void Create2DViewWithTemp(Document Document2D)
        {
            Database AcadDatabase = Document2D.Database;
            Transaction AcadTransaction = null;
            BlockTable AcadBlockTable = null;
            BlockTableRecord AcadBlockTableRecord = null;

            using (Document2D.LockDocument())
            {
                AcadTransaction = AcadDatabase.TransactionManager.StartTransaction();

                AcadBlockTable = AcadTransaction.GetObject(AcadDatabase.BlockTableId,
                                                               OpenMode.ForRead) as BlockTable;

                AcadBlockTableRecord = AcadTransaction.GetObject(AcadBlockTable[BlockTableRecord.ModelSpace],
                                                OpenMode.ForWrite) as BlockTableRecord;


                SupportData firstSupport = ListCentalSuppoData.FirstOrDefault();

                // gets the template
                // CopyPasteTemplateFile("Temp1", Document2D, 0);

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", 0, 0, 1);

                //GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,0);

                //adding values to c section dictionary
                Csectiondetails.Add("75x40 ", "ISMC 75");
                Csectiondetails.Add("100x50", "ISMC 100 ");
                Csectiondetails.Add("125x65 ", "ISMC 125");
                Csectiondetails.Add("125x66 ", "ISMC 125*");
                Csectiondetails.Add("150x75 ", "ISMC 150");
                Csectiondetails.Add("150x76 ", "ISMC 150*");
                Csectiondetails.Add("175x75 ", "ISMC 175");
                Csectiondetails.Add("175x76 ", "ISMC 175*");
                Csectiondetails.Add("200x75 ", "ISMC 200");
                Csectiondetails.Add("200x76 ", "ISMC 200*");
                Csectiondetails.Add("225x80 ", "ISMC 225");
                Csectiondetails.Add("225x82 ", "ISMC 225*");
                Csectiondetails.Add("250x80 ", "ISMC 250");
                Csectiondetails.Add("250x82 ", "ISMC 250*");
                Csectiondetails.Add("250x83 ", "ISMC 250*");
                Csectiondetails.Add("300x90 ", "ISMC 300");
                Csectiondetails.Add("300x92 ", "ISMC 300*");
                Csectiondetails.Add("300x93 ", "ISMC 300*");
                Csectiondetails.Add("350x100", "ISMC 350");
                Csectiondetails.Add("400x100", "ISMC 400");



                //adding values to L section dictionary


                /*  Lsectiondetails.Add(" 75 40", "ISLC 75");
                  Lsectiondetails.Add(" 100 50", "ISLC 100 ");
                  Lsectiondetails.Add("125 65 ", "ISLC 125");
                  Lsectiondetails.Add("125 65 ", "ISLC(P) 125");
                  Lsectiondetails.Add("150 75 ", "ISLC 150");
                  Lsectiondetails.Add("150 75 ", "ISLC(P) 150");
                  Lsectiondetails.Add("175 75 ", "ISLC 175");
                  Lsectiondetails.Add("200 75 ", "ISLC 200");
                  Lsectiondetails.Add("200 75 ", "ISLC(P) 200");
                  Lsectiondetails.Add("225 90 ", "ISLC 225");
                  Lsectiondetails.Add("250 100", "ISLC 250");
                  Lsectiondetails.Add("300 100", "ISLC 300");
                  Lsectiondetails.Add("300 90 ", "ISLC(P) 300");
                  Lsectiondetails.Add("350 100", "ISLC 350");
                  Lsectiondetails.Add("400 100", "ISLC 400");*/

                ListDimStylesCommand();
                //logic for adding block      

                //9869.9480;                  
                //67542.6980;
                //adding blocks here

                double boxlen = 17299.3016;
                double boxht = 12734.3388;

                double tracex = 619.1209;

                string suptype = ListCentalSuppoData[0].SupportType;

                Dictionary<string, double> DicWtData = new Dictionary<string, double>();
                DicWtData["ISMC75"] = 7.14;
                DicWtData["ISMC100"] = 9.56;
                DicWtData["ISMC125"] = 13.1;
                DicWtData["ISMC125*"] = 13.7;
                DicWtData["ISMC150"] = 16.8;
                DicWtData["ISMC150*"] = 17.7;
                DicWtData["ISMC175"] = 19.6;
                DicWtData["ISMC175*"] = 22.7;
                DicWtData["ISMC200"] = 22.3;
                DicWtData["ISMC200*"] = 24.3;
                DicWtData["ISMC225"] = 26.1;
                DicWtData["ISMC225*"] = 30.7;
                DicWtData["ISMC250"] = 30.6;
                DicWtData["ISMC250*"] = 34.2;
                DicWtData["ISMC250**"] = 36.1;
                DicWtData["ISMC300"] = 36.3;
                DicWtData["ISMC300*"] = 41.5;
                DicWtData["ISMC300**"] = 46.2;
                DicWtData["ISMC350"] = 42.7;
                DicWtData["ISMC400"] = 50.1;
                Dictionary<string, double> DicSurfaceAData = new Dictionary<string, double>();


                DicSurfaceAData["ISMC75"] = 0.31;
                DicSurfaceAData["ISMC100"] = 0.40;
                DicSurfaceAData["ISMC125"] = 0.51;
                DicSurfaceAData["ISMC150"] = 0.60;
                DicSurfaceAData["ISMC200"] = 0.70;
                DicSurfaceAData["ISMC225"] = 0.77;
                DicSurfaceAData["ISMC250"] = 0.82;
                DicSurfaceAData["ISMC300"] = 0.96;
                DicSurfaceAData["ISMC400"] = 1.20;


                //for valcuating datum level
                List<double> datum = new List<double>();
                //string suptype = ListCentalSuppoData[0].SupportType;
                for (int i = 0; i < ListCentalSuppoData.Count; i++)
                {
                    foreach (SupporSpecData sp in ListCentalSuppoData[i].ListConcreteData)
                    {
                        datum.Add(sp.Boundingboxmin.Z);
                    }

                    //datum.Add(ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z);
                }

                if (datum.Count > 0)
                {
                    datum_level = MillimetersToMeters(Math.Round(datum.Min()));
                }



                //for (int j = 0; j <= 1; j++)
                //{
                for (int i = 0; i < ListCentalSuppoData.Count; i++)
                {
                    CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
#if _DEBUG
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support81");
                CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support92");
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support103");
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support104");
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support105");
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support106");
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support107");
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support108");
                //CreateFullBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, "Support115");
#endif

                Dictionary<string, List<double>> ListBomData = new Dictionary<string, List<double>>();

                Dictionary<string, int> UClampData = new Dictionary<string, int>();

                int AnchorHoles = 0;
                foreach (var SData in ListCentalSuppoData)
                {
                    if (SData.SupportType != null)
                    {
                        foreach (var SType in SData.ListSecondrySuppo)
                        {
                            if (SType.SupportName != null && SType.SupportName.ToLower().Equals("plate") && SType.IsGussetplate)
                            {
                                string Size = "GUSSET PLATE";

                                int count = 1;
                                if (Size != null && Size.Length > 0)
                                {
                                    if (UClampData.ContainsKey(Size))
                                    {
                                        count = UClampData[Size];
                                        count++;
                                        UClampData[Size] = count;
                                    }
                                    else
                                    {
                                        UClampData[Size] = count;
                                    }
                                }
                            }
                            else if (SType.Size != null && SType.Size.ToLower().Contains("web"))
                            {
                                string Size = GettheISMC(SType.Size);
                                if (Size == "")
                                {
                                    Size = "ISMC" + CSECTIONSIZE(SType.Size);
                                }

                                List<double> Temp = new List<double>();
                                double Dist = Calculate.DistPoint(GetPt3DFromArray(SType.StPt), GetPt3DFromArray(SType.EndPt));

                                if (ListBomData.ContainsKey(Size))
                                {
                                    Temp = ListBomData[Size];
                                    Temp.Add(Dist);

                                    ListBomData[Size] = Temp;
                                }
                                else
                                {
                                    Temp.Add(Dist);

                                    ListBomData[Size] = Temp;
                                }
                            }
                        }
                        foreach (var PType in SData.ListPrimarySuppo)
                        {
                            if (PType.SupportName.ToLower().Contains("clamp"))
                            {
                                string Size = PType.Size + "NB";

                                int count = 1;
                                if (Size != null && Size.Length > 0)
                                {
                                    if (UClampData.ContainsKey(Size))
                                    {
                                        count = UClampData[Size];
                                        count++;
                                        UClampData[Size] = count;
                                    }
                                    else
                                    {
                                        UClampData[Size] = count;
                                    }
                                }
                            }
                        }

                        foreach (var CType in SData.ListConcreteData)
                        {
                            if (CType.IsAnchor)
                            {
                                string Size = GetSizeofPlate(CType.ListfaceData);

                                if (Size != null && Size.Length > 0 && CType.NoOfAnchoreHole > 0)
                                {
                                    Size = "ANCHOR PLATE" + Size + " THK";
                                    int count = 1;
                                    if (Size != null && Size.Length > 0)
                                    {
                                        if (UClampData.ContainsKey(Size))
                                        {
                                            count = UClampData[Size];
                                            count++;
                                            UClampData[Size] = count;
                                        }
                                        else
                                        {
                                            UClampData[Size] = count;
                                        }
                                    }
                                }
                                AnchorHoles = AnchorHoles + CType.NoOfAnchoreHole;
                            }
                        }

                        if (AnchorHoles > 0)
                        {
                            UClampData["ANCHOR FASTNER"] = AnchorHoles;
                        }
                    }
                }

                Table BomTable = new Table();

                BomTable.SetSize(UClampData.Count + ListBomData.Count + 3, 9);
                string[,] str = new string[UClampData.Count + ListBomData.Count + 3, 9];

                str[0, 0] = "BOM";
                str[1, 0] = "SR. No.";
                str[1, 1] = "ITEM DESCRIPTION";
                str[1, 2] = "MATERIAL";
                str[1, 3] = "QTY";
                str[1, 4] = "UOM";
                str[1, 5] = "WEIGHT(KG)";
                str[1, 6] = "PAINTING AREA (METER sq.)";
                str[1, 7] = "Remark";

                Autodesk.AutoCAD.DatabaseServices.CellRange rowFirst = Autodesk.AutoCAD.DatabaseServices.CellRange.Create(BomTable, 0, 0, 0, 8);
                BomTable.MergeCells(rowFirst);

                for (int iCo1 = 0; iCo1 < BomTable.Rows.Count; iCo1++)
                    BomTable.Rows[iCo1].Height = 400;

                for (int iCo1 = 0; iCo1 < 9; iCo1++)
                {
                    if (iCo1 == 0)
                    {
                        BomTable.Columns[iCo1].Width = 1000;
                    }
                    else if (iCo1 == 1 || iCo1 == 2)
                    {
                        BomTable.Columns[iCo1].Width = 2500;
                    }
                    else if (iCo1 == 3 || iCo1 == 5 || iCo1 == 6)
                    {
                        BomTable.Columns[iCo1].Width = 1500;
                    }
                    else if (iCo1 == 8)
                    {
                        BomTable.Columns[iCo1].Width = 1;
                    }

                    else
                    {
                        BomTable.Columns[iCo1].Width = 1000;
                    }
                }

                double Weight = 0.0;
                double SurfaceArea = 0.0;

                BomTable.Cells[0, 0].ContentColor = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Black);
                BomTable.Cells[0, 0].BackgroundColor = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Yellow);
                BomTable.SetContentColor(Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.LightGray), 1);

                int iNo = 2;

                for (int inx = 0; inx < ListBomData.Count; inx++)
                {
                    for (int iCount1 = 0; iCount1 < 8; iCount1++)
                    {
                        if (iCount1 == 0)
                            str[iNo, iCount1] = (inx + 1).ToString();
                        if (iCount1 == 1)
                            str[iNo, iCount1] = ListBomData.ElementAt(inx).Key;
                        if (iCount1 == 2)
                            str[iNo, iCount1] = "IS:2062 Gr.E250A";
                        if (iCount1 == 3)
                            str[iNo, iCount1] = (Math.Round(GetQuantityofParts(ListBomData.ElementAt(inx).Value), 1)).ToString();
                        if (iCount1 == 4)
                            str[iNo, iCount1] = "M";
                        if (iCount1 == 5)
                            str[iNo, iCount1] = (Math.Round(GetQuantityofParts(ListBomData.ElementAt(inx).Value) * DicWtData[ListBomData.ElementAt(inx).Key], 2)).ToString();
                        if (iCount1 == 6)
                            str[iNo, iCount1] = (Math.Round((DicSurfaceAData.ContainsKey(ListBomData.ElementAt(inx).Key) ? DicSurfaceAData[ListBomData.ElementAt(inx).Key] : 0) * GetQuantityofParts(ListBomData.ElementAt(inx).Value), 1)).ToString();

                        if (iCount1 == 7)
                            str[iNo, iCount1] = " ";
                    }
                    Weight = Weight + Math.Round(GetQuantityofParts(ListBomData.ElementAt(inx).Value) * DicWtData[ListBomData.ElementAt(inx).Key], 2);

                    SurfaceArea = SurfaceArea + Math.Round((DicSurfaceAData.ContainsKey(ListBomData.ElementAt(inx).Key) ? DicSurfaceAData[ListBomData.ElementAt(inx).Key] : 0) * GetQuantityofParts(ListBomData.ElementAt(inx).Value), 1);
                    iNo++;
                }

                for (int inx = 0; inx < UClampData.Count; inx++)
                {
                    for (int iCount1 = 0; iCount1 < 8; iCount1++)
                    {
                        if (iCount1 == 0)
                            str[iNo, iCount1] = (iNo - 1).ToString();
                        if (iCount1 == 1)
                            str[iNo, iCount1] = UClampData.ElementAt(inx).Key.ToUpper().Contains("NB") ? "'U'" + "  Clamp" + UClampData.ElementAt(inx).Key : UClampData.ElementAt(inx).Key;
                        if (iCount1 == 2)
                            str[iNo, iCount1] = "IS:2062 Gr.E250A";
                        if (iCount1 == 3)
                            str[iNo, iCount1] = (UClampData.ElementAt(inx).Value).ToString();
                        if (iCount1 == 4)
                            str[iNo, iCount1] = UClampData.ElementAt(inx).Value == 1 ? "NO" : "NOS";
                        if (iCount1 == 5)
                            str[iNo, iCount1] = " ";
                        if (iCount1 == 6)
                            str[iNo, iCount1] = " ";

                        if (iCount1 == 7)
                            str[iNo, iCount1] = " ";
                    }

                    iNo++;
                }

                for (int i = 0; i < BomTable.Rows.Count; i++)
                {
                    if (i == BomTable.Rows.Count - 1)
                    {
                        BomTable.Cells[i, 0].TextHeight = 140;
                        BomTable.Cells[i, 0].Contents[0].TextString = "{\\fArial;" + "Total" + "}";
                        BomTable.Cells[i, 0].Alignment = CellAlignment.MiddleCenter;

                        BomTable.Cells[i, 5].TextHeight = 140;
                        BomTable.Cells[i, 5].Contents[0].TextString = "{\\fArial;" + Weight.ToString() + "}";
                        BomTable.Cells[i, 5].Alignment = CellAlignment.MiddleCenter;

                        BomTable.Cells[i, 6].TextHeight = 140;
                        BomTable.Cells[i, 6].Contents[0].TextString = "{\\fArial;" + SurfaceArea.ToString() + "}";
                        BomTable.Cells[i, 6].Alignment = CellAlignment.MiddleCenter;
                    }
                    else
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            BomTable.Cells[i, j].TextHeight = 140;
                            BomTable.Cells[i, j].Contents[0].TextString = "{\\fArial;" + str[i, j] + "}";
                            BomTable.Cells[i, j].Alignment = CellAlignment.MiddleCenter;
                        }
                    }
                }

                BomTable.DeleteColumns(BomTable.Columns.Count - 1, 1);
                BomTable.Position = new Point3d(tracex, -BomTable.Height + spaceY, 0);

                BomTable.GenerateLayout();
                AcadBlockTableRecord.AppendEntity(BomTable);
                AcadTransaction.AddNewlyCreatedDBObject(BomTable, true);

                //Point3d startPoint = new Point3d(0, 0, 0);
                //Point3d endPoint = new Point3d(50, 50, 0);
                //Point3d landingPoint = new Point3d(100, 50, 0);
                //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Defalut text", startPoint, endPoint, landingPoint);
                //startPoint = new Point3d(0, 0, 0);
                //endPoint = new Point3d(500, 500, 0);
                //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Defalut text", startPoint, endPoint);

                //}


                /*List<SupporSpecData> PrimarySupport = firstSupport.ListPrimarySuppo;
                SupporSpecData prmsupport = PrimarySupport.FirstOrDefault();
                double height1 = GetHeight(prmsupport);
                CreateSecondarySupportBottom(prmsupport, height1, AcadTransaction, AcadBlockTableRecord, AcadDatabase);

                SupporSpecData prmsupport1 = PrimarySupport[1];
                double newheight = prmsupport1.Boundingboxmax.Z - prmsupport1.Boundingboxmin.Z;
                CreateSecondarySupportTop(prmsupport1, newheight, height1, AcadTransaction, AcadDatabase, AcadBlockTableRecord);

                //CreateSecondarySupportTopOuter(prmsupport1, newheight, height1, AcadTransaction, AcadDatabase, AcadBlockTableRecord);

                //Create Pedestial support
                //CreateBottomSupportTop(prmsupport1, newheight, 0, AcadTransaction, AcadDatabase, AcadBlockTableRecord);
                CreateBottomSupportTopType2(prmsupport1, newheight, 0, AcadTransaction, AcadDatabase, AcadBlockTableRecord);

                //to create primary support
                List<SupporSpecData> SecondSupport = firstSupport.ListSecondrySuppo;
                double add = height1 + newheight;
                //CreatePrimarySupport(SecondSupport, add, AcadBlockTableRecord, AcadTransaction, AcadDatabase);
                CreatePrimarySupportwithvertex(SecondSupport, add, AcadBlockTableRecord, AcadTransaction, AcadDatabase, prmsupport1);

                //CreateLeaderfromfile(AcadBlockTableRecord, AcadTransaction, AcadDatabase);


                CreateSingleLeadrwidtxt(AcadBlockTableRecord, AcadTransaction, AcadDatabase);

                //SupporSpecData Sesupport = SecondSupport.FirstOrDefault();*/
                AddDimStyleToDimensions();
                AcadTransaction.Commit();
            }
        }


        void Create2DForConcreteBOM(Document Document2D)
        {
            Database AcadDatabase = Document2D.Database;
            Transaction AcadTransaction = null;
            BlockTable AcadBlockTable = null;
            BlockTableRecord AcadBlockTableRecord = null;

            using (Document2D.LockDocument())
            {
                AcadTransaction = AcadDatabase.TransactionManager.StartTransaction();

                AcadBlockTable = AcadTransaction.GetObject(AcadDatabase.BlockTableId,
                                                               OpenMode.ForRead) as BlockTable;

                AcadBlockTableRecord = AcadTransaction.GetObject(AcadBlockTable[BlockTableRecord.ModelSpace],
                                                OpenMode.ForWrite) as BlockTableRecord;


                SupportData firstSupport = ListCentalSuppoData.FirstOrDefault();

                // gets the template
                // CopyPasteTemplateFile("Temp1", Document2D, 0);

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", 0, 0, 1);

                //GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,0);

                //logic for adding block      

                //9869.9480;                  
                //67542.6980;
                //adding blocks here

                spaceX = 81971.6112;
                spaceY = 71075.0829;

                tempX = 101659.6570;
                tempY = 71694.2039;


                double boxlen = 13483.4661;  //for concrete 17299.3016;
                double boxht = 12734.3388;

                double tracex = 619.1209;

                string suptype = "";

                Dictionary<string, double> DicWtData = new Dictionary<string, double>();
                DicWtData["ISMC75"] = 7.14;
                DicWtData["ISMC100"] = 9.56;
                DicWtData["ISMC125"] = 13.1;
                DicWtData["ISMC125*"] = 13.7;
                DicWtData["ISMC150"] = 16.8;
                DicWtData["ISMC150*"] = 17.7;
                DicWtData["ISMC175"] = 19.6;
                DicWtData["ISMC175*"] = 22.7;
                DicWtData["ISMC200"] = 22.3;
                DicWtData["ISMC200*"] = 24.3;
                DicWtData["ISMC225"] = 26.1;
                DicWtData["ISMC225*"] = 30.7;
                DicWtData["ISMC250"] = 30.6;
                DicWtData["ISMC250*"] = 34.2;
                DicWtData["ISMC250**"] = 36.1;
                DicWtData["ISMC300"] = 36.3;
                DicWtData["ISMC300*"] = 41.5;
                DicWtData["ISMC300**"] = 46.2;
                DicWtData["ISMC350"] = 42.7;
                DicWtData["ISMC400"] = 50.1;
                Dictionary<string, double> DicSurfaceAData = new Dictionary<string, double>();


                DicSurfaceAData["ISMC75"] = 0.31;
                DicSurfaceAData["ISMC100"] = 0.40;
                DicSurfaceAData["ISMC125"] = 0.51;
                DicSurfaceAData["ISMC150"] = 0.60;
                DicSurfaceAData["ISMC200"] = 0.70;
                DicSurfaceAData["ISMC225"] = 0.77;
                DicSurfaceAData["ISMC250"] = 0.82;
                DicSurfaceAData["ISMC300"] = 0.96;
                DicSurfaceAData["ISMC400"] = 1.20;


                //for valcuating datum level
                List<double> datum = new List<double>();
                //string suptype = ListCentalSuppoData[0].SupportType;

                try
                {
                    for (int i = 0; i < ListCentalSuppoData.Count; i++)
                    {
                        if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
                        {
                            var concrete_sup = ListCentalSuppoData[i].ListConcreteData.OrderByDescending(e => e.BoxData.Z);
                            //foreach (SupporSpecData sp in ListCentalSuppoData[i].ListConcreteData)
                            //{

                            datum.Add(concrete_sup.ElementAt(0).Boundingboxmin.Z);
                            //}
                            AddConcretBOM(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i, concrete_sup);
                            ConcreteSize_WithTAG.Add(ListCentalSuppoData[i].Name, Math.Round(MillimetersToMeters(concrete_sup.ElementAt(0).Boundingboxmin.Z), 2));
                            //datum.Add(ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z);
                        }

                    }
                }
                catch (Exception)
                {

                }

                if (datum.Count > 0)
                {
                    datum_level = MillimetersToMeters(Math.Round(datum.Min()));
                }

                Dictionary<string, PedastalData> BomData = new Dictionary<string, PedastalData>();

                List<Table> BomTables = new List<Table>();

                BomData = GetBomData();
                BomTables = CreateBomPedestal(BomData);

                spaceY = 71075.0829;
                tracex = tempX + 10000 + 619.1209;

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);

                for (int mnx = 0; mnx < BomTables.Count; mnx++)
                {
                    BomTables[mnx].Position = new Point3d(tracex + 619.1209 + (mnx * 8000), spaceY, 0);

                    BomTables[mnx].GenerateLayout();
                    AcadBlockTableRecord.AppendEntity(BomTables[mnx]);
                    AcadTransaction.AddNewlyCreatedDBObject(BomTables[mnx], true);
                }
                AcadTransaction.Commit();
            }
        }

        void CreateSingleLeadrwidtxt(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase)
        {
            // Create the MText annotation
            MText acMText = new MText();
            acMText.SetDatabaseDefaults();
            acMText.Contents = "DECK PANEL";
            acMText.Location = new Point3d(153334.4278 + 1500, 117162.4417, 0);
            //acMText.Width = 2;
            acMText.TextHeight = 80;
            // Add the new object to Model space and the transaction
            AcadBlockTableRecord.AppendEntity(acMText);
            AcadTransaction.AddNewlyCreatedDBObject(acMText, true);
            //ObjectId objectIds1 = SymbolUtilityServices.GetBlockModelSpaceId(AcadDatabase);

            // objectIds1.Add(acMText.Id); 
            Leader acLdr = new Leader();
            acLdr.SetDatabaseDefaults();
            acLdr.AppendVertex(new Point3d(153334.4278, 117162.4417, 0));
            acLdr.AppendVertex(new Point3d(153334.4278 + 1500, 117162.4417, 0));
            acLdr.HasArrowHead = true;
            //acLd.

            TextStyleTable acTStyleTbl = AcadTransaction.GetObject(AcadDatabase.TextStyleTableId, OpenMode.ForRead) as TextStyleTable;

            DimStyleTable acDimStyleTbl = AcadTransaction.GetObject(AcadDatabase.DimStyleTableId, OpenMode.ForRead) as DimStyleTable;

            // Get the index of the dimension style named "ISO-25"
            //int iso25Index = acDimStyleTbl.FindIndex("ISO-25");

            // Get the dimension style at the specified index
            //ObjectId acDimStyleId = acDimStyleTbl[iso25Index];

            ObjectId acDimStyleId = acDimStyleTbl["ISO-25"];

            acLdr.TextStyleId = acDimStyleId;

            acLdr.Color = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Cyan);
            //acLdr.Dimclrd = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Green);                     //Add the new object to Model space and the transaction
            AcadBlockTableRecord.AppendEntity(acLdr);
            AcadTransaction.AddNewlyCreatedDBObject(acLdr, true);
            acLdr.Annotation = acMText.ObjectId;
            acLdr.EvaluateLeader();
        }

        private void CreatePrimarySupportwithvertex(List<SupporSpecData> SecondSupport, double add, BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, SupporSpecData prmsupport1)
        {
            foreach (SupporSpecData Sesupport in SecondSupport)
            {
                double seheight1 = Sesupport.Boundingboxmax.Z - Sesupport.Boundingboxmin.Z;
                //Point3d center = new Point3d(Sesupport.Boundingboxmin.X + Sesupport.Boundingboxmax.X / 2, Sesupport.Boundingboxmin.Y + Sesupport.Boundingboxmax.Y / 2+add,0);
                Point3d center = new Point3d(Sesupport.Centroid.X, Sesupport.Centroid.Y + add + 200, 0);
                Point2d min = new Point2d(Sesupport.Boundingboxmin.X, Sesupport.Boundingboxmin.Y);
                Point2d max = new Point2d(Sesupport.Boundingboxmax.X, Sesupport.Boundingboxmax.Y);
                double radius = max.GetDistanceTo(min) / 4;
                LinetypeTable acLineTypTbl;
                acLineTypTbl = AcadTransaction.GetObject(AcadDatabase.LinetypeTableId,
                                                       OpenMode.ForRead) as LinetypeTable;
                string sLineTypName = "PHANTOM2";
                if (acLineTypTbl.Has(sLineTypName) == false)
                {
                    AcadDatabase.LoadLineTypeFile(sLineTypName, "acad.lin");
                }
                //double radius = height1/2;
                Circle circle = new Circle();
                Circle secCircle = new Circle();
                circle.Radius = radius;
                circle.Center = center;
                circle.Linetype = sLineTypName;
                circle.LinetypeScale = 0.2;
                circle.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);

                AcadBlockTableRecord.AppendEntity(circle);
                AcadTransaction.AddNewlyCreatedDBObject(circle, true);

                secCircle.Radius = radius - 5;
                secCircle.Center = center;
                secCircle.Linetype = sLineTypName;
                secCircle.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
                secCircle.LinetypeScale = 0.2;
                AcadBlockTableRecord.AppendEntity(secCircle);
                AcadTransaction.AddNewlyCreatedDBObject(secCircle, true);
                //Adds the arc and line to an object id collection
                ObjectIdCollection acObjIdColl = new ObjectIdCollection();
                acObjIdColl.Add(circle.ObjectId);
                ObjectIdCollection acObjectColl1 = new ObjectIdCollection();
                acObjectColl1.Add(secCircle.ObjectId);
                // Create the hatch object and append it to the block table record
                Hatch acHatch = new Hatch();
                AcadBlockTableRecord.AppendEntity(acHatch);
                AcadTransaction.AddNewlyCreatedDBObject(acHatch, true);

                // Set the properties of the hatch object
                // Associative must be set after the hatch object is appended to the 
                // block table record and before AppendLoop
                acHatch.SetDatabaseDefaults();
                acHatch.SetHatchPattern(HatchPatternType.PreDefined, "ANSI31");
                acHatch.Associative = true;
                acHatch.AppendLoop(HatchLoopTypes.Outermost, acObjIdColl);
                acHatch.AppendLoop(HatchLoopTypes.Outermost, acObjectColl1);
                acHatch.HatchStyle = HatchStyle.Normal;
                acHatch.Linetype = sLineTypName;
                acHatch.LinetypeScale = 0.2;
                acHatch.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
                // Evaluate the hatch
                acHatch.EvaluateHatch(true);

                // Increase the pattern scale by 2 and re-evaluate the hatch
                acHatch.PatternScale = acHatch.PatternScale + 69.23;
                acHatch.SetHatchPattern(acHatch.PatternType, acHatch.PatternName);
                acHatch.EvaluateHatch(true);

                //lines below circle
                //Pt2D1 = new Point2d(prmsupport1.Boundingboxmax.X, prmsupport1.Boundingboxmin.Y + newheight + height1);

                //Pt2D1 = new Point2d(prmsupport1.Boundingboxmin.X, prmsupport1.Boundingboxmin.Y + height1 + newheight);
                Point3d lpt1 = new Point3d(Sesupport.Centroid.X - radius * 0.75, prmsupport1.Boundingboxmin.Y + add, 0);
                Point3d lpt2 = new Point3d(Sesupport.Centroid.X - radius * 0.75, Sesupport.Centroid.Y + add + 200, 0);
                Line line1 = new Line(lpt1, lpt2);
                Point3dCollection intersectionPoints = new Point3dCollection();
                line1.IntersectWith(circle, Intersect.OnBothOperands, intersectionPoints, IntPtr.Zero, IntPtr.Zero);
                if (intersectionPoints.Count > 0)
                {
                    line1.EndPoint = intersectionPoints[0];
                }
                AcadBlockTableRecord.AppendEntity(line1);
                line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(line1, true);

                Point3d lpt3 = new Point3d(Sesupport.Centroid.X + radius * 0.75, prmsupport1.Boundingboxmin.Y + add, 0);
                Point3d lpt4 = new Point3d(Sesupport.Centroid.X + radius * 0.75, Sesupport.Centroid.Y + add + 200, 0);
                Line line2 = new Line(lpt3, lpt4);
                Point3dCollection intersectionPoints2 = new Point3dCollection();
                line2.IntersectWith(circle, Intersect.OnBothOperands, intersectionPoints2, IntPtr.Zero, IntPtr.Zero);
                if (intersectionPoints2.Count > 0)
                {
                    line2.EndPoint = intersectionPoints2[0];
                }
                AcadBlockTableRecord.AppendEntity(line2);
                line2.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(line2, true);
            }
        }

        private void CreateBottomSupportTopType2(SupporSpecData prmsupport1, double newheight, int v, Transaction acadTransaction, Database acadDatabase, BlockTableRecord acadBlockTableRecord)
        {
            var newline = new Polyline();
            Point2d Pt2D1 = new Point2d(prmsupport1.Boundingboxmin.X - 120, prmsupport1.Boundingboxmin.Y - newheight - 100);
            newline.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmax.X + 120, prmsupport1.Boundingboxmin.Y - newheight - 100);
            newline.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmax.X + 120, prmsupport1.Boundingboxmin.Y);
            newline.AddVertexAt(2, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmin.X - 120, prmsupport1.Boundingboxmin.Y);
            newline.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmin.X - 120, prmsupport1.Boundingboxmin.Y - newheight - 100);
            newline.AddVertexAt(4, Pt2D1, 0, 0, 0);
            newline.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);

            LinetypeTable acLineTypTbl;
            acLineTypTbl = acadTransaction.GetObject(acadDatabase.LinetypeTableId,
                                                   OpenMode.ForRead) as LinetypeTable;
            string sLineTypName = "DASHED";
            if (acLineTypTbl.Has(sLineTypName) == false)
            {
                acadDatabase.LoadLineTypeFile(sLineTypName, "acad.lin");


            }
            newline.Linetype = sLineTypName;
            acadBlockTableRecord.AppendEntity(newline);
            acadTransaction.AddNewlyCreatedDBObject(newline, true);

            //inside upper block
            double offsetht = 50;
            double offsetinside = 150;
            var insideupperblock = new Polyline();
            Point2d Pt2D2 = new Point2d(prmsupport1.Boundingboxmin.X - 120 + offsetinside, prmsupport1.Boundingboxmin.Y - offsetht);
            insideupperblock.AddVertexAt(0, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(prmsupport1.Boundingboxmax.X + 120 - offsetinside, prmsupport1.Boundingboxmin.Y - offsetht);
            insideupperblock.AddVertexAt(1, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(prmsupport1.Boundingboxmax.X + 120 - offsetinside, prmsupport1.Boundingboxmin.Y);
            insideupperblock.AddVertexAt(2, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(prmsupport1.Boundingboxmin.X - 120 + offsetinside, prmsupport1.Boundingboxmin.Y);
            insideupperblock.AddVertexAt(3, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(prmsupport1.Boundingboxmin.X - 120 + offsetinside, prmsupport1.Boundingboxmin.Y - offsetht);
            insideupperblock.AddVertexAt(4, Pt2D2, 0, 0, 0);
            insideupperblock.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);


            if (acLineTypTbl.Has(sLineTypName) == true)
            {
                //acadDatabase.LoadLineTypeFile(sLineTypName, "acad.lin");
                insideupperblock.Linetype = sLineTypName;
            }
            acadBlockTableRecord.AppendEntity(insideupperblock);
            acadTransaction.AddNewlyCreatedDBObject(insideupperblock, true);

            //vertical side lines 
            Point3d pt1 = new Point3d(prmsupport1.Boundingboxmin.X - 120 + 2 * offsetinside, prmsupport1.Boundingboxmin.Y - offsetht, 0);
            Point3d Pt2 = new Point3d(prmsupport1.Boundingboxmin.X - 120 + 2 * offsetinside, prmsupport1.Boundingboxmin.Y - offsetht - offsetht, 0);
            Line line = new Line(pt1, Pt2);
            acadBlockTableRecord.AppendEntity(line);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadTransaction.AddNewlyCreatedDBObject(line, true);

            Point3d pt12 = new Point3d(prmsupport1.Boundingboxmax.X + 120 - 2 * offsetinside, prmsupport1.Boundingboxmin.Y - offsetht, 0);
            Point3d Pt22 = new Point3d(prmsupport1.Boundingboxmax.X + 120 - 2 * offsetinside, prmsupport1.Boundingboxmin.Y - offsetht - offsetht, 0);
            Line line2 = new Line(pt12, Pt22);
            acadBlockTableRecord.AppendEntity(line2);
            line2.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadTransaction.AddNewlyCreatedDBObject(line2, true);

            //horizontal side lines
            Point3d pt3 = new Point3d(prmsupport1.Boundingboxmin.X - 120 + 2 * offsetinside, prmsupport1.Boundingboxmin.Y - offsetht - offsetht, 0);
            Point3d Pt4 = new Point3d(prmsupport1.Boundingboxmin.X - 120, prmsupport1.Boundingboxmin.Y - offsetht - offsetht, 0);
            Line lineh1 = new Line(pt3, Pt4);
            acadBlockTableRecord.AppendEntity(lineh1);
            lineh1.Color = Color.FromColorIndex(ColorMethod.ByAci, 83);
            acadTransaction.AddNewlyCreatedDBObject(lineh1, true);

            //horizontal side lines
            Point3d pt5 = new Point3d(prmsupport1.Boundingboxmax.X + 120 - 2 * offsetinside, prmsupport1.Boundingboxmin.Y - offsetht - offsetht, 0);
            Point3d Pt6 = new Point3d(prmsupport1.Boundingboxmax.X + 120, prmsupport1.Boundingboxmin.Y - offsetht - offsetht, 0);
            Line lineh2 = new Line(pt5, Pt6);
            acadBlockTableRecord.AppendEntity(lineh2);
            lineh2.Color = Color.FromColorIndex(ColorMethod.ByAci, 83);
            acadTransaction.AddNewlyCreatedDBObject(lineh2, true);
        }

        private void CreateSecondarySupportTop(SupporSpecData prmsupport1, double newheight, double height1, Transaction acadTransaction, Database acadDatabase, BlockTableRecord acadBlockTableRecord)
        {
            var newline = new Polyline();
            //rectangular polyline
            Point2d Pt2D1 = new Point2d(prmsupport1.Boundingboxmin.X, prmsupport1.Boundingboxmin.Y + height1);
            newline.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmax.X, prmsupport1.Boundingboxmin.Y + height1);
            newline.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmax.X, prmsupport1.Boundingboxmin.Y + newheight + height1);
            newline.AddVertexAt(2, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmin.X, prmsupport1.Boundingboxmin.Y + height1 + newheight);
            newline.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport1.Boundingboxmin.X, prmsupport1.Boundingboxmin.Y + height1);
            newline.AddVertexAt(4, Pt2D1, 0, 0, 0);
            newline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadBlockTableRecord.AppendEntity(newline);
            acadTransaction.AddNewlyCreatedDBObject(newline, true);

            //other two lines in rectangle

            Point3d pt1 = new Point3d(prmsupport1.Boundingboxmin.X, prmsupport1.Boundingboxmin.Y + 20 + height1, 0);
            Point3d Pt2 = new Point3d(prmsupport1.Boundingboxmax.X, prmsupport1.Boundingboxmin.Y + 20 + height1, 0);
            Line line = new Line(pt1, Pt2);
            acadBlockTableRecord.AppendEntity(line);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadTransaction.AddNewlyCreatedDBObject(line, true);

            Point3d lpt1 = new Point3d(prmsupport1.Boundingboxmin.X, prmsupport1.Boundingboxmin.Y - 20 + height1 + newheight, 0);
            Point3d lpt2 = new Point3d(prmsupport1.Boundingboxmax.X, prmsupport1.Boundingboxmin.Y - 20 + height1 + newheight, 0);
            Line line1 = new Line(lpt1, lpt2);
            acadBlockTableRecord.AppendEntity(line1);
            line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadTransaction.AddNewlyCreatedDBObject(line1, true);
        }

        private void CreateSecondarySupportBottom(SupporSpecData prmsupport, double height1, Transaction AcadTransaction, BlockTableRecord acadBlockTableRecord, Database acadDatabase)
        {
            var line = new Polyline();
            //double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            Point2d Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X, prmsupport.Boundingboxmin.Y);
            line.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport.Boundingboxmax.X, prmsupport.Boundingboxmin.Y);
            line.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport.Boundingboxmax.X, prmsupport.Boundingboxmin.Y + height1);
            line.AddVertexAt(2, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X, prmsupport.Boundingboxmin.Y + height1);
            line.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X, prmsupport.Boundingboxmin.Y);
            line.AddVertexAt(4, Pt2D1, 0, 0, 0);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadBlockTableRecord.AppendEntity(line);
            AcadTransaction.AddNewlyCreatedDBObject(line, true);

            Point3d pt1 = new Point3d(prmsupport.Boundingboxmin.X + 20, prmsupport.Boundingboxmin.Y, 0);
            Point3d Pt2 = new Point3d(prmsupport.Boundingboxmin.X + 20, prmsupport.Boundingboxmin.Y + height1, 0);
            Line innerLine = new Line(pt1, Pt2);
            acadBlockTableRecord.AppendEntity(innerLine);
            innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);

            Point3d lpt1 = new Point3d(prmsupport.Boundingboxmax.X - 20, prmsupport.Boundingboxmin.Y, 0);
            Point3d lpt2 = new Point3d(prmsupport.Boundingboxmax.X - 20, prmsupport.Boundingboxmin.Y + height1, 0);
            Line line1 = new Line(lpt1, lpt2);
            acadBlockTableRecord.AppendEntity(line1);
            line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(line1, true);

            CreateSideSecondarySupportBottom(prmsupport, height1, AcadTransaction, acadBlockTableRecord, acadDatabase, "Left");
        }

        private void CreateSideSecondarySupportBottom(SupporSpecData prmsupport, double height1, Transaction AcadTransaction, BlockTableRecord acadBlockTableRecord, Database acadDatabase, string side)
        {
            double horilen = 1000;
            double vertilen = 300;
            double gap = 400;
            var line = new Polyline();

            //double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            if (side == "Left")
            {
                Point2d Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X, prmsupport.Boundingboxmin.Y + gap);
                line.AddVertexAt(0, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X - horilen, prmsupport.Boundingboxmin.Y + gap);
                line.AddVertexAt(1, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X - horilen, prmsupport.Boundingboxmin.Y + vertilen + gap);
                line.AddVertexAt(2, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X, prmsupport.Boundingboxmin.Y + vertilen + gap);
                line.AddVertexAt(3, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmin.X, prmsupport.Boundingboxmin.Y + gap);
                line.AddVertexAt(4, Pt2D1, 0, 0, 0);
                line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                acadBlockTableRecord.AppendEntity(line);
                AcadTransaction.AddNewlyCreatedDBObject(line, true);

                //offset line
                Point3d pt1 = new Point3d(prmsupport.Boundingboxmin.X - horilen, prmsupport.Boundingboxmin.Y + vertilen * 0.75 + gap, 0);
                Point3d Pt2 = new Point3d(prmsupport.Boundingboxmin.X, prmsupport.Boundingboxmin.Y + vertilen * 0.75 + gap, 0);
                Line innerLine = new Line(pt1, Pt2);
                acadBlockTableRecord.AppendEntity(innerLine);
                innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);
            }
            else if (side == "Right")
            {
                Point2d Pt2D1 = new Point2d(prmsupport.Boundingboxmax.X, prmsupport.Boundingboxmin.Y + gap);
                line.AddVertexAt(0, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmax.X + horilen, prmsupport.Boundingboxmin.Y + gap);
                line.AddVertexAt(1, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmax.X + horilen, prmsupport.Boundingboxmin.Y + gap + vertilen);
                line.AddVertexAt(2, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmax.X, prmsupport.Boundingboxmin.Y + gap + vertilen);
                line.AddVertexAt(3, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(prmsupport.Boundingboxmax.X, prmsupport.Boundingboxmin.Y + gap);
                line.AddVertexAt(4, Pt2D1, 0, 0, 0);
                line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                acadBlockTableRecord.AppendEntity(line);
                AcadTransaction.AddNewlyCreatedDBObject(line, true);

                //offset line
                Point3d pt1 = new Point3d(prmsupport.Boundingboxmax.X + horilen, prmsupport.Boundingboxmin.Y + gap + vertilen * 0.75, 0);
                Point3d Pt2 = new Point3d(prmsupport.Boundingboxmax.X, prmsupport.Boundingboxmin.Y + gap + vertilen * 0.75, 0);
                Line innerLine = new Line(pt1, Pt2);
                acadBlockTableRecord.AppendEntity(innerLine);
                innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);
            }
            else
            {

            }
        }

        private double GetHeight(SupporSpecData prmsupport)
        {
            double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            return height1;
        }


        [Obsolete]
        public void CreateFullBlock(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            info.Clear();
            info.Add(Defination.Prim_Radius, 0);
            info[Defination.Prim_Radius] = 500;
            info[Defination.Prim_ht] = 500;
            info[Defination.Concrete_l] = 3000;
            info[Defination.Concrete_b] = 1000;

            if (SupType == SupportType.Support1.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS1(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    // CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);

                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS1(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support2.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS2(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    // CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);

                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS2(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.SL_Tyep.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    double upperYgap = 3500;

                    double centerX = tracex + boxlen / 2;  // 9869.9480;
                    double centerY = spaceY - upperYgap;
                    //box boundaries
                    //vertical line
                    Point3d pt1 = new Point3d(tracex + boxlen, spaceY + 619.1209, 0);
                    Point3d Pt2 = new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0);
                    Line line = new Line(pt1, Pt2);
                    AcadBlockTableRecord.AppendEntity(line);
                    line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                    AcadTransaction.AddNewlyCreatedDBObject(line, true);


                    //hori line
                    Point3d pt11 = new Point3d(tracex, spaceY - boxht + 619.1209, 0);
                    Point3d Pt21 = new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0);
                    Line line1 = new Line(pt11, Pt21);
                    AcadBlockTableRecord.AppendEntity(line1);
                    line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                    AcadTransaction.AddNewlyCreatedDBObject(line1, true);

                    //height = 3000;
                    //length = 1000;

                    //  FixCreateBottomSupportTopType2(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length);
                    FixCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, "Left");
                    FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

                    tracex += boxlen;
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                }
            }

            else if (SupType == SupportType.SR_Tyep.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    double upperYgap = 3500;

                    double centerX = tracex + boxlen / 2;  // 9869.9480;
                    double centerY = spaceY - upperYgap;
                    //box boundaries
                    //vertical line
                    Point3d pt1 = new Point3d(tracex + boxlen, spaceY + 619.1209, 0);
                    Point3d Pt2 = new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0);
                    Line line = new Line(pt1, Pt2);
                    AcadBlockTableRecord.AppendEntity(line);
                    line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                    AcadTransaction.AddNewlyCreatedDBObject(line, true);


                    //hori line
                    Point3d pt11 = new Point3d(tracex, spaceY - boxht + 619.1209, 0);
                    Point3d Pt21 = new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0);
                    Line line1 = new Line(pt11, Pt21);
                    AcadBlockTableRecord.AppendEntity(line1);
                    line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                    AcadTransaction.AddNewlyCreatedDBObject(line1, true);

                    // height = 3000;
                    // length = 1000;

                    // FixCreateBottomSupportTopType2(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length);
                    FixCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, "Right");
                    FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

                    tracex += boxlen;
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);


                    // CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                }
            }

            else if (SupType == SupportType.Support3.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS3(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);


                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS3(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support4.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS4(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);


                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS4(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support5.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS5(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    // CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS5(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support6.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS6(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    // CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS6(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support7.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS7(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS7(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support8.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS8(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    // CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS8(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }


            else if (SupType == SupportType.Support9.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS9(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS9(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support10.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS10(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS10(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }


            else if (SupType == SupportType.Support11.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS11(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS11(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support13.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    try
                    {
                        DRS13(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                    }
                    catch (Exception)
                    {

                    }
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    try
                    {
                        DRS13(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                    }
                    catch (Exception)
                    {

                    }
                }
            }
            else if (SupType == SupportType.Support14.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS14(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS14(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support15.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS15(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS15(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support16.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS16(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS16(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support17.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS17(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS17(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support18.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS18(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS18(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support19.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS19(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS19(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support20.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS20(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS20(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support21.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS21(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS21(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support22.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS22(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS22(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support23.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS23(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS23(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support24.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS24(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS24(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support25.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS25(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS25(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support26.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS26(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS26(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support27.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS27(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS27(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support28.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS28(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS28(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }

            else if (SupType == SupportType.Support29.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS29(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS29(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support30.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS30(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS30(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support31.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS31(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS31(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support32.ToString())
            {
                boxlen = 30162;// 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS32(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS32(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support33.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS33(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS33(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support34.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS34(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS34(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support35.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS35(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS35(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support36.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS36(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS36(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support37.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS37(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS37(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support38.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS38(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS38(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support39.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS39(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS39(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support40.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS40(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS40(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support41.ToString())
            {
                boxlen = 30162;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS41(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS41(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support42.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS42(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS42(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support43.ToString())
            {
                boxlen = 30162;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS43(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS43(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support44.ToString())
            {
                boxlen = 30162;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS44(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS44(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support45.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS45(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS45(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support46.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS46(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS46(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support47.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS47(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS47(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support48.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS48(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS48(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support49.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS49(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS49(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support50.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS50(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS50(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support51.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS51(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS51(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support52.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS52(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS52(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support53.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS53(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS53(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support54.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS54(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS54(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support55.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS55(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS55(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support56.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS56(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS56(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support57.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS57(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS57(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support58.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS58(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS58(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support59.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS59(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS59(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support61.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS61(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS61(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support62.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS62(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS62(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support63.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS63(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS63(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support64.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS64(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS64(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support65.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS65(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS65(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support66.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS66(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS66(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support67.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS67(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS67(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support68.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS68(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS68(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support69.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS69(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS69(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support70.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS70(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS70(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support71.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS71(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS71(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support72.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS72(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS72(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support73.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS73(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS73(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support74.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS74(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS74(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support75.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS75(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS75(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support76.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS76(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS76(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support77.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS77(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS77(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support79.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS79(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS79(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support80.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS80(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS80(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support81.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS81(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS81(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support82.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS82(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS82(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support83.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS83(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS83(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support85.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS85(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS85(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support86.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS86(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS86(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support87.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS87(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS87(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support88.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS88(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS88(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support89.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS89(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS89(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support90.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS90(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS90(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support91.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS91(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS91(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support92.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS92(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS92(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support93.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS93(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS93(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support94.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS94(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS94(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support95.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS95(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS95(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support96.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS96(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS96(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support97.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS97(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS97(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support98.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS98(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS98(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support99.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS99(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS99(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support100.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS100(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS100(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support101.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS101(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS101(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support102.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS102(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS102(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support103.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS103(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS103(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support104.ToString())
            {
                boxlen = 30162;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS104(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS104(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support105.ToString())
            {
                boxlen = 30162;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS105(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS105(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support106.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS106(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS106(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support107.ToString())
            {
                boxlen = 30162;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS107(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS107(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support108.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS108(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS108(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
            else if (SupType == SupportType.Support115.ToString())
            {
                boxlen = 17299.3016;
                boxht = 12734.3388;
                if (tracex >= spaceX - boxlen)
                {
                    spaceY -= boxht;
                    tracex = tempX - 101659.6570 + 619.1209;
                }
                if (spaceY > boxht)
                {
                    DRS115(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
                else
                {

                    spaceY = 71075.0829;
                    tracex = tempX + 10000 + 619.1209;//gaps
                                                      // gets the template
                                                      // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                    //CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);
                    tempX += 101659.6570 + 10000;
                    spaceX = tempX - 19068.9248;
                    DRS115(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, Document2D, ListCentalSuppoData[i].SupportType, i);
                }
            }
        }

        public void AddConcretBOM(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i, [Optional] IOrderedEnumerable<SupporSpecData> desc_list)
        {
            //boxlen = 17299.3016;
            //value came by scaling block to a height
            boxlen = 13483.4661;
            boxht = 12734;
            if (tracex >= spaceX - boxlen)
            {
                spaceY -= boxht;
                tracex = tempX - 101659.6570 + 619.1209;
            }
            if (spaceY > boxht)
            {
                BLOCK_WITH_ATTRIBUTES(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Concrete_BOM", ref tracex, ref spaceY, 1, desc_list: desc_list, i: i);
                tracex += boxlen;
            }
            else
            {

                spaceY = 71075.0829;
                tracex = tempX + 10000 + 619.1209;//gaps
                                                  // gets the template
                                                  // GetTemplate(AcadBlockTableRecord, AcadTransaction, AcadDatabase,tracex- 619.1209);

                // CopyPasteTemplateFile("Temp1", Document2D, tracex - 619.1209);
                BLOCK_WITH_ATTRIBUTES(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Concrete_BOM", ref tracex, ref spaceY, 1, desc_list: desc_list, i: i);

                tempX += 101659.6570 + 10000;
                spaceX = tempX - 19068.9248;

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Mtemp", tracex - 619.1209, 0, 1);

                tracex += boxlen;
            }
        }

        [Obsolete]
        void CreateLeaderfromfile(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, double insertptX, double insertptY)
        {


            string codeBase = Assembly.GetExecutingAssembly().CodeBase;
            UriBuilder uri = new UriBuilder(codeBase);
            string path = Uri.UnescapeDataString(uri.Path);

            string workingDirectory = Path.GetDirectoryName(path);

            // Get the project file path by searching for the .csproj file in the working directory
            string projectFilePath = Directory.GetFiles(workingDirectory, "LeaderBlock.dwg").FirstOrDefault();

            //string dwgPath = "D:\\Projects\\Plant 3D\\LeaderBlock.dwg";


            // Create a new database object
            Database db = new Database(true, true);
            db.ReadDwgFile(projectFilePath, FileOpenMode.OpenForReadAndWriteNoShare, true, "");

            Transaction tr2 = db.TransactionManager.StartTransaction();
            // Open the Block table for read
            BlockTable btsrc = tr2.GetObject(db.BlockTableId, OpenMode.ForRead) as BlockTable;

            // Get the current space
            BlockTableRecord btrsrc = tr2.GetObject(btsrc[BlockTableRecord.ModelSpace], OpenMode.ForWrite) as BlockTableRecord;

            // get the model space object ids for both dbs
            ObjectId sourceMsId = SymbolUtilityServices.GetBlockModelSpaceId(db);
            ObjectId destDbMsId = SymbolUtilityServices.GetBlockModelSpaceId(AcadDatabase);

            // now create an array of object ids to hold the source objects to copy
            ObjectIdCollection sourceIds = new ObjectIdCollection();

            // open the sourceDb ModelSpace (current autocad dwg)

            BlockTableRecord ms = sourceMsId.Open(OpenMode.ForRead) as BlockTableRecord;

            // loop all the entities and record their ids


            foreach (ObjectId id in ms)
            {
                Point3d strpt = new Point3d(0, 0, 0);
                Vector3d destvect = strpt.GetVectorTo(new Point3d(insertptX, insertptY, 0));

                var ent = (Entity)tr2.GetObject(id, OpenMode.ForWrite);
                var ent2 = (Entity)tr2.GetObject(id, OpenMode.ForRead);
                ent.TransformBy(Matrix3d.Displacement(destvect));
                // Point3d pos=ent2.Position
                //ent.TransformBy(Matrix3d.);
                sourceIds.Add(id);
            }

            // next prepare to deepclone the recorded ids to the destdb
            IdMapping mapping = new IdMapping();
            // now clone the objects into the destdb

            db.WblockCloneObjects(sourceIds, destDbMsId, mapping, DuplicateRecordCloning.Replace, false);
            tr2.Commit();
            db.Dispose();

        }



        [Obsolete]
        void InsertblockScale(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, string blockname, double insertptX, double insertptY, double scaleFactor = 1)
        {


            string codeBase = Assembly.GetExecutingAssembly().CodeBase;
            UriBuilder uri = new UriBuilder(codeBase);
            string path = Uri.UnescapeDataString(uri.Path);

            string workingDirectory = Path.GetDirectoryName(path);

            // Get the project file path by searching for the .csproj file in the working directory
            string projectFilePath = Directory.GetFiles(workingDirectory, blockname + ".dwg").FirstOrDefault();

            //string dwgPath = "D:\\Projects\\Plant 3D\\LeaderBlock.dwg";


            // Create a new database object
            Database db = new Database(true, true);
            db.ReadDwgFile(projectFilePath, FileOpenMode.OpenForReadAndWriteNoShare, true, "");

            Transaction tr2 = db.TransactionManager.StartTransaction();
            // Open the Block table for read
            BlockTable btsrc = tr2.GetObject(db.BlockTableId, OpenMode.ForRead) as BlockTable;


            // get the model space object ids for both dbs
            ObjectId sourceMsId = SymbolUtilityServices.GetBlockModelSpaceId(db);
            ObjectId destDbMsId = SymbolUtilityServices.GetBlockModelSpaceId(AcadDatabase);

            // now create an array of object ids to hold the source objects to copy
            ObjectIdCollection sourceIds = new ObjectIdCollection();

            // open the sourceDb ModelSpace (current autocad dwg)

            BlockTableRecord ms = sourceMsId.Open(OpenMode.ForRead) as BlockTableRecord;

            // loop all the entities and record their ids


            foreach (ObjectId id in ms)
            {
                Point3d strpt = new Point3d(0, 0, 0);
                Vector3d destvect = strpt.GetVectorTo(new Point3d(insertptX, insertptY, 0));

                var ent = (Entity)tr2.GetObject(id, OpenMode.ForWrite);
                // var ent2 = (Entity)tr2.GetObject(id, OpenMode.ForRead);

                Matrix3d scaleMatrix = Matrix3d.Scaling(scaleFactor, new Point3d(0, 0, 0));

                // Apply the scaling matrix to the entity
                ent.TransformBy(scaleMatrix);

                ent.TransformBy(Matrix3d.Displacement(destvect));
                // Point3d pos=ent2.Position
                //ent.TransformBy(Matrix3d.);
                sourceIds.Add(id);
            }
            tr2.Commit();
            // next prepare to deepclone the recorded ids to the destdb
            IdMapping mapping = new IdMapping();
            // now clone the objects into the destdb

            db.WblockCloneObjects(sourceIds, destDbMsId, mapping, DuplicateRecordCloning.Replace, false);

            db.Dispose();

        }



        public void CopyAndModifyEntities(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, string sourceDwg, double insertptX, double insertptY, double scaleFactor, [Optional] double rotationAngle, [Optional] Point3d rotationPoint)
        {

            string codeBase = Assembly.GetExecutingAssembly().CodeBase;
            UriBuilder uri = new UriBuilder(codeBase);
            string path = Uri.UnescapeDataString(uri.Path);

            string workingDirectory = Path.GetDirectoryName(path);

            // Get the project file path by searching for the .csproj file in the working directory
            string sourceDwgPath = Directory.GetFiles(workingDirectory, sourceDwg + ".dwg").FirstOrDefault();

            // Start a transaction

            // Get the BlockTableRecord of the model space in the destination database
            //BlockTableRecord destModelSpace = (BlockTableRecord)tr.GetObject(SymbolUtilityServices.GetBlockModelSpaceId(destDb), OpenMode.ForWrite);

            // Create a new Database object for the source DWG file
            Database sourceDb = new Database(false, true);
            sourceDb.ReadDwgFile(sourceDwgPath, FileOpenMode.OpenForReadAndWriteNoShare, true, "");


            Transaction tr2 = sourceDb.TransactionManager.StartTransaction();

            // Open the BlockTableRecord of the model space in the source database
            BlockTableRecord sourceModelSpace = (BlockTableRecord)sourceDb.TransactionManager.GetObject(sourceDb.CurrentSpaceId, OpenMode.ForWrite);

            // Create an ObjectIdCollection to hold the source object IDs
            ObjectIdCollection sourceObjectIds = new ObjectIdCollection();

            // Loop through the entities in the source model space
            foreach (ObjectId sourceObjectId in sourceModelSpace)
            {
                // Add the source ObjectId to the collection
                sourceObjectIds.Add(sourceObjectId);

                // Modify the entity as needed
                Entity sourceEntity = (Entity)tr2.GetObject(sourceObjectId, OpenMode.ForWrite);
                ColorMethod colorMethod = ColorMethod.ByLayer;
                int colorMethodCode = (int)colorMethod;
                sourceEntity.ColorIndex = colorMethodCode;

                Point3d strpt = new Point3d(0, 0, 0);
                Vector3d destvect = strpt.GetVectorTo(new Point3d(insertptX, insertptY, 0));

                // var ent = (Entity)AcadTransaction.GetObject(sourceObjectId, OpenMode.ForWrite);
                //var ent2 = (Entity)AcadTransaction.GetObject(sourceObjectId, OpenMode.ForRead);

                Matrix3d scaleMatrix = Matrix3d.Scaling(scaleFactor, new Point3d(0, 0, 0));

                // Apply the scaling matrix to the entity
                sourceEntity.TransformBy(scaleMatrix);

                sourceEntity.TransformBy(Matrix3d.Displacement(destvect));


                //for rotation
                if (rotationAngle != 0)
                {
                    // Define the rotation transformation
                    Matrix3d rotationMatrix = Matrix3d.Rotation(rotationAngle, Vector3d.ZAxis, rotationPoint);

                    // Apply the rotation transformation to the entity
                    sourceEntity.TransformBy(rotationMatrix);
                }


                // For example

                // Add the modified entity to the destination database
                Entity destEntity = sourceEntity.Clone() as Entity;

                //AcadBlockTableRecord.AppendEntity(destEntity);
                //tr2.AddNewlyCreatedDBObject(destEntity, true);
            }

            // Create a new IdMapping object
            IdMapping mapping = new IdMapping();

            // Clone the source objects to the destination database
            AcadDatabase.WblockCloneObjects(sourceObjectIds, AcadBlockTableRecord.ObjectId, mapping, DuplicateRecordCloning.Replace, false);

            // Commit the transaction and dispose of the source database
            tr2.Commit();
            sourceDb.Dispose();


            // Save and close the destination database
            // destDb.SaveAs(destDwgPath, DwgVersion.Current);
            // destDb.Dispose();

        }

        public void BLOCK_WITH_ATTRIBUTES(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, string sourceDwg, ref double insertptX, ref double insertptY, double scaleFactor, [Optional] double rotationAngle, [Optional] Point3d rotationPoint, [Optional] IOrderedEnumerable<SupporSpecData> desc_list, int i = 0)
        {

            string codeBase = Assembly.GetExecutingAssembly().CodeBase;
            UriBuilder uri = new UriBuilder(codeBase);
            string path = Uri.UnescapeDataString(uri.Path);

            string workingDirectory = Path.GetDirectoryName(path);

            // Get the project file path by searching for the .csproj file in the working directory
            string sourceDwgPath = Directory.GetFiles(workingDirectory, sourceDwg + ".dwg").FirstOrDefault();

            // Create a new Database object for the source DWG file
            Database sourceDb = new Database(false, true);
            sourceDb.ReadDwgFile(sourceDwgPath, FileOpenMode.OpenForReadAndWriteNoShare, true, "");


            Transaction tr2 = sourceDb.TransactionManager.StartTransaction();

            // Open the BlockTableRecord of the model space in the source database
            BlockTableRecord sourceModelSpace = (BlockTableRecord)sourceDb.TransactionManager.GetObject(sourceDb.CurrentSpaceId, OpenMode.ForWrite);

            // Create an ObjectIdCollection to hold the source object IDs
            ObjectIdCollection sourceObjectIds = new ObjectIdCollection();

            // Loop through the entities in the source model space
            foreach (ObjectId sourceObjectId in sourceModelSpace)
            {
                // Add the source ObjectId to the collection
                sourceObjectIds.Add(sourceObjectId);

                // Modify the entity as needed
                var sourceEntity = tr2.GetObject(sourceObjectId, OpenMode.ForWrite) as BlockReference;

                var blockref = tr2.GetObject(sourceObjectId, OpenMode.ForWrite) as BlockReference;
                ColorMethod colorMethod = ColorMethod.ByLayer;
                int colorMethodCode = (int)colorMethod;
                sourceEntity.ColorIndex = colorMethodCode;

                try
                {
                    foreach (ObjectId attId in blockref.AttributeCollection)
                    {
                        AttributeReference attRef = tr2.GetObject(attId, OpenMode.ForRead) as AttributeReference;
                        if (attRef != null && attRef.Tag.Equals("height", StringComparison.OrdinalIgnoreCase))
                        {
                            attRef.UpgradeOpen();
                            attRef.TextString = Math.Round(desc_list.ElementAt(0).BoxData.Z).ToString();
                            attRef.DowngradeOpen();
                        }
                        else if (attRef != null && attRef.Tag.Equals("width", StringComparison.OrdinalIgnoreCase))
                        {
                            attRef.UpgradeOpen();
                            attRef.TextString = Math.Round(desc_list.ElementAt(0).BoxData.Y).ToString();
                            attRef.DowngradeOpen();
                        }
                        else if (attRef != null && attRef.Tag.Equals("length", StringComparison.OrdinalIgnoreCase))
                        {
                            attRef.UpgradeOpen();
                            attRef.TextString = Math.Round(desc_list.ElementAt(0).BoxData.X).ToString();
                            attRef.DowngradeOpen();
                        }
                        else if (attRef != null && attRef.Tag.Equals("datum_ht", StringComparison.OrdinalIgnoreCase))
                        {
                            attRef.UpgradeOpen();
                            attRef.TextString = Math.Round(MillimetersToMeters(desc_list.ElementAt(0).Boundingboxmin.Z), 2).ToString();
                            attRef.DowngradeOpen();
                        }
                        else if (attRef != null && attRef.Tag.Equals("tagname", StringComparison.OrdinalIgnoreCase))
                        {
                            attRef.UpgradeOpen();
                            attRef.TextString = ListCentalSuppoData[i].Name;
                            attRef.DowngradeOpen();
                        }
                    }



                    //foreach (ObjectId attributeId in blockref.AttributeCollection)
                    //{

                    //    var entity = tr2.GetObject(attributeId, OpenMode.ForRead) as Entity;
                    //    if (entity is AttributeDefinition)
                    //    {
                    //        var attributeDef = entity as AttributeDefinition;

                    //        // Set the values for the attributes
                    //        if (attributeDef.Tag == "ht")
                    //        {
                    //            var attributeValue = "10"; // Specify the value for the "ht" attribute
                    //            blockref.SetAttributeFromBlock(attributeDef, attributeValue);

                    //        }
                    //        else if (attributeDef.Tag == "wd")
                    //        {
                    //            var attributeValue = "20"; // Specify the value for the "wd" attribute
                    //            blockref.SetAttributeFromBlock(attributeDef, attributeValue);
                    //        }
                    //        else if (attributeDef.Tag == "lt")
                    //        {
                    //            var attributeValue = "30"; // Specify the value for the "lt" attribute
                    //            blockref.SetAttributeFromBlock(attributeDef, attributeValue);
                    //        }
                    //        else if (attributeDef.Tag == "dh")
                    //        {
                    //            var attributeValue = "40"; // Specify the value for the "dh" attribute
                    //            blockref.SetAttributeFromBlock(attributeDef, attributeValue);
                    //        }
                    //    }
                    //}




                }
                catch (Exception)
                {

                }




                Point3d strpt = new Point3d(0, 0, 0);
                Vector3d destvect = strpt.GetVectorTo(new Point3d(insertptX, insertptY, 0));

                Matrix3d scaleMatrix = Matrix3d.Scaling(scaleFactor, new Point3d(0, 0, 0));

                // Apply the scaling matrix to the entity
                sourceEntity.TransformBy(scaleMatrix);

                sourceEntity.TransformBy(Matrix3d.Displacement(destvect));


                //for rotation
                if (rotationAngle != 0)
                {
                    // Define the rotation transformation
                    Matrix3d rotationMatrix = Matrix3d.Rotation(rotationAngle, Vector3d.ZAxis, rotationPoint);

                    // Apply the rotation transformation to the entity
                    sourceEntity.TransformBy(rotationMatrix);
                }


                // For example

                // Add the modified entity to the destination database
                Entity destEntity = sourceEntity.Clone() as Entity;

                //AcadBlockTableRecord.AppendEntity(destEntity);
                //tr2.AddNewlyCreatedDBObject(destEntity, true);
            }

            // Create a new IdMapping object
            IdMapping mapping = new IdMapping();

            // Clone the source objects to the destination database
            AcadDatabase.WblockCloneObjects(sourceObjectIds, AcadBlockTableRecord.ObjectId, mapping, DuplicateRecordCloning.Replace, false);

            // Commit the transaction and dispose of the source database
            tr2.Commit();
            sourceDb.Dispose();


            // Save and close the destination database
            // destDb.SaveAs(destDwgPath, DwgVersion.Current);
            // destDb.Dispose();

        }



        //fix new function for Bottom Support Top

        [Obsolete]
        private void FixCreateBottomSupportTopType2(Document Document2D, BlockTableRecord acadBlockTableRecord, Transaction acadTransaction, Database acadDatabase, double centerX, double centerY, double height, double length, [Optional] int i, string weldreq = "a")
        {

            double ht_frm_cen = info[Defination.Sec_ht_bot];

            var newline = new Polyline();
            Point2d Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            newline.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen);
            newline.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen - height);

            //dimensioning
            RotatedDimension dim = new RotatedDimension(Math.PI / 2, new Point3d(centerX + length / 2, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2, centerY - ht_frm_cen - height, 0), new Point3d(centerX + length / 2 + 1400, centerY - ht_frm_cen - height, 0), "", ObjectId.Null);
            dim.Dimtxt = 100;
            dim.Dimasz = 150;



            //if (ListCentalSuppoData[0].ListConcreteData[0].BoxData.Z > ListCentalSuppoData[0].ListConcreteData[1].BoxData.Z)
            //{
            //    dim.DimensionText = (ListCentalSuppoData[0].ListConcreteData[0].BoxData.Z).ToString();
            //}
            //else
            //{
            //    dim.DimensionText = (ListCentalSuppoData[0].ListConcreteData[1].BoxData.Z).ToString();
            //}
            try
            {
                if (ListCentalSuppoData[i].ListConcreteData.Count > 1)
                {
                    dim.DimensionText = Math.Round(Math.Max(ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z, ListCentalSuppoData[i].ListConcreteData[1].BoxData.Z)).ToString();
                }
                else
                {
                    dim.DimensionText = Math.Round(ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z).ToString();
                }


            }
            catch (Exception)
            {

            }


            dim.Dimclre = Color.FromColor(System.Drawing.Color.Cyan);
            dim.Dimclrt = Color.FromColor(System.Drawing.Color.Yellow);
            dim.Dimclrd = Color.FromColor(System.Drawing.Color.Cyan);

            var chk = dim.GetDimstyleData();



            dim.Dimtih = true;
            // dim.Dimtoh = false;

            acadBlockTableRecord.AppendEntity(dim);
            acadTransaction.AddNewlyCreatedDBObject(dim, true);

            newline.AddVertexAt(2, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen - height);
            newline.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            newline.AddVertexAt(4, Pt2D1, 0, 0, 0);
            newline.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);

            LinetypeTable acLineTypTbl;
            acLineTypTbl = acadTransaction.GetObject(acadDatabase.LinetypeTableId,
                                                   OpenMode.ForRead) as LinetypeTable;

            string sLineTypName = "HIDDEN2";
            if (acLineTypTbl.Has(sLineTypName) == false)
            {
                acadDatabase.LoadLineTypeFile(sLineTypName, "acad.lin");
            }
            newline.Linetype = sLineTypName;
            newline.LinetypeScale = 100;
            acadBlockTableRecord.AppendEntity(newline);
            acadTransaction.AddNewlyCreatedDBObject(newline, true);

            info[Defination.Prim_ht] = ht_frm_cen;

            //detail line
            //detail line
            Point3d dpt1 = new Point3d(centerX + length / 2, centerY - ht_frm_cen - height, 0);
            Point3d dPt2 = new Point3d(centerX + length / 2 + 4000, centerY - ht_frm_cen - height, 0);
            Line dline = new Line(dpt1, dPt2);
            dline.Linetype = sLineTypName;
            dline.LinetypeScale = 100;
            acadBlockTableRecord.AppendEntity(dline);
            dline.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
            acadTransaction.AddNewlyCreatedDBObject(dline, true);


            var con_datum_ht = Math.Round((MillimetersToMeters((ListCentalSuppoData[i].ListConcreteData.Where(e => e.Boundingboxmin.Z == ListCentalSuppoData[i].ListConcreteData.Min(s => s.Boundingboxmin.Z)).First().Boundingboxmin.Z))), 2);
            try
            {
                //mtext
                CreateMtextfunc(acadBlockTableRecord, acadTransaction, acadDatabase, new Point3d(centerX + length / 2 + 2500, centerY - ht_frm_cen - height + 300, 0), "HPP.(+)" + con_datum_ht);

            }
            catch (Exception)
            {

            }


            //inside upper block
            double offsetht = 162.6694;
            double offsetinside = 433.7815;
            var insideupperblock = new Polyline();
            Point2d Pt2D2 = new Point2d(centerX - length / 2 + offsetinside, centerY - ht_frm_cen);
            insideupperblock.AddVertexAt(0, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(centerX + length / 2 - offsetinside, centerY - ht_frm_cen);
            insideupperblock.AddVertexAt(1, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(centerX + length / 2 - offsetinside, centerY - ht_frm_cen - offsetht);
            insideupperblock.AddVertexAt(2, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(centerX - length / 2 + offsetinside, centerY - ht_frm_cen - offsetht);
            insideupperblock.AddVertexAt(3, Pt2D2, 0, 0, 0);
            Pt2D2 = new Point2d(centerX - length / 2 + offsetinside, centerY - ht_frm_cen);
            insideupperblock.AddVertexAt(4, Pt2D2, 0, 0, 0);
            insideupperblock.AddVertexAt(4, Pt2D2, 0, 0, 0);
            insideupperblock.Linetype = sLineTypName;
            insideupperblock.LinetypeScale = 100;
            insideupperblock.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);

            try
            {

                if (weldreq.ToLower() == "a")
                {
                    CreateLeaderfromfile(acadBlockTableRecord, acadTransaction, acadDatabase, centerX + length / 2 - offsetinside - 450, centerY - ht_frm_cen);
                }
            }
            catch (Exception)
            {

            }




            //InsertBlockOnDocument("LeaderBlock", Document2D, centerX + length / 2 - offsetinside - 450, centerY - ht_frm_cen);

            if (acLineTypTbl.Has(sLineTypName) == true)
            {
                //acadDatabase.LoadLineTypeFile(sLineTypName, "acad.lin");
                insideupperblock.Linetype = sLineTypName;
            }
            acadBlockTableRecord.AppendEntity(insideupperblock);
            acadTransaction.AddNewlyCreatedDBObject(insideupperblock, true);

            //vertical side lines 
            double lineHt = 500;
            Point3d pt1 = new Point3d(centerX - length / 2 + 2 * offsetinside, centerY - ht_frm_cen - offsetht, 0);
            Point3d Pt2 = new Point3d(centerX - length / 2 + 2 * offsetinside, centerY - ht_frm_cen - offsetht - lineHt, 0);
            Line line = new Line(pt1, Pt2);
            line.Linetype = sLineTypName;
            line.LinetypeScale = 100;
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
            acadBlockTableRecord.AppendEntity(line);

            acadTransaction.AddNewlyCreatedDBObject(line, true);


            Point3d pt12 = new Point3d(centerX + length / 2 - 2 * offsetinside, centerY - ht_frm_cen - offsetht, 0);
            Point3d Pt22 = new Point3d(centerX + length / 2 - 2 * offsetinside, centerY - ht_frm_cen - offsetht - lineHt, 0);
            Line line2 = new Line(pt12, Pt22);
            line2.Linetype = sLineTypName;
            line2.LinetypeScale = 100;
            line2.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
            acadBlockTableRecord.AppendEntity(line2);

            acadTransaction.AddNewlyCreatedDBObject(line2, true);

            //horizontal side lines
            Point3d pt3 = new Point3d(centerX - length / 2 + 2 * offsetinside, centerY - ht_frm_cen - offsetht - lineHt, 0);
            Point3d Pt4 = new Point3d(centerX - length / 2, centerY - ht_frm_cen - offsetht - lineHt, 0);
            Line lineh1 = new Line(pt3, Pt4);
            lineh1.Linetype = sLineTypName;
            lineh1.LinetypeScale = 100;
            lineh1.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
            acadBlockTableRecord.AppendEntity(lineh1);

            acadTransaction.AddNewlyCreatedDBObject(lineh1, true);

            //horizontal side lines
            Point3d pt5 = new Point3d(centerX + length / 2 - 2 * offsetinside, centerY - ht_frm_cen - offsetht - lineHt, 0);
            Point3d Pt6 = new Point3d(centerX + length / 2, centerY - ht_frm_cen - offsetht - lineHt, 0);
            Line lineh2 = new Line(pt5, Pt6);
            lineh2.Linetype = sLineTypName;
            lineh2.LinetypeScale = 100;
            lineh2.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
            acadBlockTableRecord.AppendEntity(lineh2);

            acadTransaction.AddNewlyCreatedDBObject(lineh2, true);

        }

        private void FixCreateSecondarySupportTop(BlockTableRecord acadBlockTableRecord, Transaction acadTransaction, Database acadDatabase, double centerX, double centerY)
        {
            double height = 1000.0000;
            double length = 2666.6667;
            double ht_frm_cen = 1220.7383;
            var newline = new Polyline();
            //rectangular polyline
            Point2d Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);

            CreateDimension(new Point3d(centerX - length / 2, centerY - ht_frm_cen, 0), new Point3d(centerX, centerY, 0));

            newline.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen);

            CreateDimension(new Point3d(centerX + length / 2, centerY - ht_frm_cen, 0), new Point3d(centerX, centerY, 0));

            newline.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen - height);
            newline.AddVertexAt(2, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen - height);
            newline.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            newline.AddVertexAt(4, Pt2D1, 0, 0, 0);
            newline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadBlockTableRecord.AppendEntity(newline);
            acadTransaction.AddNewlyCreatedDBObject(newline, true);

            //info
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] - ht_frm_cen;

            //detail line
            Point3d dpt1 = new Point3d(centerX + length / 2, centerY - ht_frm_cen, 0);
            Point3d dPt2 = new Point3d(centerX + length / 2 + 4000, centerY - ht_frm_cen, 0);
            Line dline = new Line(dpt1, dPt2);
            acadBlockTableRecord.AppendEntity(dline);
            dline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadTransaction.AddNewlyCreatedDBObject(dline, true);

            string TotalHt = "";
            try
            {
                if (ListCentalSuppoData[0].ListConcreteData[0].BoxData.Z > ListCentalSuppoData[0].ListConcreteData[1].BoxData.Z)
                {
                    TotalHt = (ListCentalSuppoData[0].ListConcreteData[0].BoxData.Z + ListCentalSuppoData[0].ListSecondrySuppo[0].BoxData.Z + ListCentalSuppoData[0].ListSecondrySuppo[1].BoxData.Z).ToString();
                }
                else
                {
                    TotalHt = (ListCentalSuppoData[0].ListConcreteData[1].BoxData.Z + ListCentalSuppoData[0].ListSecondrySuppo[0].BoxData.Z + ListCentalSuppoData[0].ListSecondrySuppo[1].BoxData.Z).ToString();
                }
            }
            catch (Exception)
            {

            }


            //mtext
            try
            {
                //TotalHt = MillimetersToMeters(Convert.ToDouble(TotalHt)).ToString();
            }
            catch (Exception)
            {

            }
            CreateMtextfunc(acadBlockTableRecord, acadTransaction, acadDatabase, new Point3d(centerX + length / 2 + 1200, centerY - ht_frm_cen + 300, 0), "TOS EL.(+)" + TotalHt /*info[Defination.Sec_ht].ToString()*/);

            //other two lines in rectangle
            double gap = 100;
            Point3d pt1 = new Point3d(centerX - length / 2, centerY - ht_frm_cen - gap, 0);
            Point3d Pt2 = new Point3d(centerX + length / 2, centerY - ht_frm_cen - gap, 0);
            Line line = new Line(pt1, Pt2);
            acadBlockTableRecord.AppendEntity(line);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadTransaction.AddNewlyCreatedDBObject(line, true);

            Point3d lpt1 = new Point3d(centerX - length / 2, centerY - ht_frm_cen - height + gap, 0);
            Point3d lpt2 = new Point3d(centerX + length / 2, centerY - ht_frm_cen - height + gap, 0);
            Line line1 = new Line(lpt1, lpt2);
            acadBlockTableRecord.AppendEntity(line1);
            line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadTransaction.AddNewlyCreatedDBObject(line1, true);
        }

        //fix new function for Secondary Support Bottom
        private void FixCreateSecondarySupportBottom(BlockTableRecord acadBlockTableRecord, Transaction AcadTransaction, Database acadDatabase, double centerX, double centerY)
        {
            double height = 3066.5059;
            double length = 1000.0000;
            double ht_frm_cen = 1220.7383 + 1000;
            var line = new Polyline();
            //double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            Point2d Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(2, Pt2D1, 0, 0, 0);

            //dimensioning
            RotatedDimension dim = new RotatedDimension(Math.PI / 2, new Point3d(centerX + length / 2, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2, centerY - ht_frm_cen - height, 0), new Point3d(centerX + length / 2 + 2500, centerY - ht_frm_cen - height, 0), "", ObjectId.Null);
            dim.Dimtxt = 100;
            dim.Dimasz = 150;

            if (ListCentalSuppoData[0].ListSecondrySuppo[0].BoxData.Z > ListCentalSuppoData[0].ListSecondrySuppo[1].BoxData.Z)
            {
                dim.DimensionText = (ListCentalSuppoData[0].ListSecondrySuppo[0].BoxData.Z).ToString();
            }
            else
            {
                dim.DimensionText = (ListCentalSuppoData[0].ListSecondrySuppo[1].BoxData.Z).ToString();
            }
            dim.Dimclre = Color.FromColor(System.Drawing.Color.Cyan);
            dim.Dimclrt = Color.FromColor(System.Drawing.Color.Yellow);
            dim.Dimclrd = Color.FromColor(System.Drawing.Color.Cyan);
            dim.Dimtih = true;
            //  dim.Dimtoh = false;


            acadBlockTableRecord.AppendEntity(dim);
            AcadTransaction.AddNewlyCreatedDBObject(dim, true);

            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(4, Pt2D1, 0, 0, 0);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadBlockTableRecord.AppendEntity(line);
            AcadTransaction.AddNewlyCreatedDBObject(line, true);

            double gap = 100;
            Point3d pt1 = new Point3d(centerX - length / 2 + gap, centerY - ht_frm_cen, 0);
            Point3d Pt2 = new Point3d(centerX - length / 2 + gap, centerY - ht_frm_cen - height, 0);
            Line innerLine = new Line(pt1, Pt2);
            acadBlockTableRecord.AppendEntity(innerLine);
            innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);

            Point3d lpt1 = new Point3d(centerX + length / 2 - gap, centerY - ht_frm_cen, 0);
            Point3d lpt2 = new Point3d(centerX + length / 2 - gap, centerY - ht_frm_cen - height, 0);
            Line line1 = new Line(lpt1, lpt2);
            acadBlockTableRecord.AppendEntity(line1);
            line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(line1, true);

            // FixCreateSideSecondarySupportBottom(AcadTransaction, acadBlockTableRecord, acadDatabase, "Left", centerX, centerY);

        }

        public void CreateDimension(Point3d strpt, Point3d endpt, [Optional] string topsec, double vertical_offset = 1200, double text_pos_rotation = 0)
        {


            Document doc = Application.DocumentManager.MdiActiveDocument;
            Database db = doc.Database;
            Editor ed = doc.Editor;

            //dimension line point

            // Create the dimension
            using (Transaction tr = db.TransactionManager.StartTransaction())
            {
                BlockTableRecord btr = (BlockTableRecord)tr.GetObject(SymbolUtilityServices.GetBlockModelSpaceId(db), OpenMode.ForWrite);
                RotatedDimension dim = new RotatedDimension(text_pos_rotation, strpt, endpt, new Point3d(endpt.X, endpt.Y + vertical_offset, 0), "", ObjectId.Null);

                dim.Dimtxt = 100;
                dim.Dimasz = 150;

                dim.Dimdec = 2;
                try
                {
                    dim.DimensionText = Math.Round(Convert.ToDouble(topsec)).ToString();
                }
                catch (Exception)
                {
                    dim.DimensionText = topsec;
                }


                dim.Dimclre = Color.FromColor(System.Drawing.Color.Cyan);
                dim.Dimclrt = Color.FromColor(System.Drawing.Color.Yellow);
                dim.Dimclrd = Color.FromColor(System.Drawing.Color.Cyan);
                dim.Dimtih = true;
                // dim.Dimtoh = false;


                btr.AppendEntity(dim);
                tr.AddNewlyCreatedDBObject(dim, true);
                tr.Commit();
            }

        }

        //fix new function for Side Secondary Support Bottom
        private void FixCreateSideSecondarySupportBottom(Transaction AcadTransaction, BlockTableRecord acadBlockTableRecord, Database acadDatabase, string side, double centerX, double centerY)
        {
            double gap_support = 1000 / 2;
            double height = 568.9965;
            double length = 2666.6667;
            double ht_frm_cen = 1220.7383 + 1000 + 2083;


            var line = new Polyline();

            //double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            if (side == "Left")
            {
                Point2d Pt2D1 = new Point2d(centerX - gap_support, centerY - ht_frm_cen);
                line.AddVertexAt(0, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX - gap_support - length / 2, centerY - ht_frm_cen);
                line.AddVertexAt(1, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX - gap_support - length / 2, centerY - ht_frm_cen - height);
                line.AddVertexAt(2, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX - gap_support, centerY - ht_frm_cen - height);
                line.AddVertexAt(3, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX - gap_support, centerY - ht_frm_cen);
                line.AddVertexAt(4, Pt2D1, 0, 0, 0);
                line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                acadBlockTableRecord.AppendEntity(line);
                AcadTransaction.AddNewlyCreatedDBObject(line, true);

                //offset line
                double gap = 100;
                Point3d pt1 = new Point3d(centerX - gap_support, centerY - ht_frm_cen - gap, 0);
                Point3d Pt2 = new Point3d(centerX - gap_support - length / 2, centerY - ht_frm_cen - gap, 0);
                Line innerLine = new Line(pt1, Pt2);
                acadBlockTableRecord.AppendEntity(innerLine);
                innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);
            }
            else if (side == "Right")
            {
                Point2d Pt2D1 = new Point2d(centerX + gap_support, centerY - ht_frm_cen);
                line.AddVertexAt(0, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX + gap_support + length / 2, centerY - ht_frm_cen);
                line.AddVertexAt(1, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX + gap_support + length / 2, centerY - ht_frm_cen - height);
                line.AddVertexAt(2, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX + gap_support, centerY - ht_frm_cen - height);
                line.AddVertexAt(3, Pt2D1, 0, 0, 0);
                Pt2D1 = new Point2d(centerX + gap_support, centerY - ht_frm_cen);
                line.AddVertexAt(4, Pt2D1, 0, 0, 0);
                line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                acadBlockTableRecord.AppendEntity(line);
                AcadTransaction.AddNewlyCreatedDBObject(line, true);

                //offset line
                double gap = 100;
                Point3d pt1 = new Point3d(centerX + gap_support, centerY - ht_frm_cen - gap, 0);
                Point3d Pt2 = new Point3d(centerX + gap_support + length / 2, centerY - ht_frm_cen - gap, 0);
                Line innerLine = new Line(pt1, Pt2);
                acadBlockTableRecord.AppendEntity(innerLine);
                innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);
            }
            else
            {

            }
        }


        private static string _DBText(ObjectId id)
        {
            return id.ObjectClass.Name + " " + id.Handle.ToString();
        }
        private void FixCreatePrimarySupportwithvertex(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, double centerX, double centerY, double radius, string suppnameside = "r")
        {


            Point3d center = new Point3d(centerX, centerY, 0);
            // radius = 801.5625;

            //stores radius value
            info[Defination.Prim_Radius] = radius;

            double ht_frm_cen = radius * 1.5;

            info[Defination.Prim_ht] = ht_frm_cen;

            LinetypeTable acLineTypTbl;
            acLineTypTbl = AcadTransaction.GetObject(AcadDatabase.LinetypeTableId,
                                                   OpenMode.ForRead) as LinetypeTable;
            string sLineTypName = "PHANTOM2";
            if (acLineTypTbl.Has(sLineTypName) == false)
            {
                AcadDatabase.LoadLineTypeFile(sLineTypName, "acad.lin");
            }
            //double radius = height1/2;
            Circle circle = new Circle();
            Circle secCircle = new Circle();
            circle.Radius = radius;
            circle.Center = center;
            circle.Linetype = sLineTypName;
            circle.LinetypeScale = 0.2;
            circle.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);


            //addition of outer part of prim support
            try
            {
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Outer_Part", center.X, center.Y, radius);
            }
            catch (Exception)
            {

            }


            // Create a new diametric dimension entity
            Point3d chordPoint = new Point3d(center.X + radius, center.Y, center.Z);
            Point3d farChordPoint = new Point3d(center.X - radius, center.Y, center.Z);
            double leaderLength = 1.0; // The length of the dimension leader line
            string dimensionText = ""; // The dimension text, which is automatically generated
            ObjectId dimStyleId = AcadDatabase.Dimstyle; // The object ID of the dimension style to use
            RadialDimension dim = new RadialDimension(circle.Center, chordPoint, leaderLength, dimensionText, dimStyleId);
            dim.Dimcen = radius;
            dim.LinetypeScale = 50;
            string centerlinetype = "CENTERX2";
            if (acLineTypTbl.Has(centerlinetype) == false)
            {
                AcadDatabase.LoadLineTypeFile(centerlinetype, "acad.lin");
            }
            dim.Linetype = centerlinetype;
            dim.Dimclre = Color.FromColor(MyCol.Red);

            //// Create a new dimension style with the desired center mark type
            //DimensionStyle newDimStyle = dimStyle.Clone() as DimensionStyle;
            //newDimStyle.CenterMarkType = CenterMarkStyle.Arc;

            //var abc = dim.CenterMarkSize;linety
            //dim.CenterMarkSize=
            // Add the dimension to the drawing database
            AcadBlockTableRecord.AppendEntity(dim);
            AcadTransaction.AddNewlyCreatedDBObject(dim, true);

            AcadBlockTableRecord.AppendEntity(circle);
            AcadTransaction.AddNewlyCreatedDBObject(circle, true);



            //mtext
            if (suppnameside == "l" || suppnameside == "L")
            {
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - radius - 2000, centerY + 300, 0), ListCentalSuppoData[0].ListPrimarySuppo[0].SupportName);

                //detail line
                Point3d dpt1 = new Point3d(centerX - radius, centerY, 0);
                Point3d dPt2 = new Point3d(centerX - radius - 4000, centerY, 0);
                Line dline = new Line(dpt1, dPt2);
                AcadBlockTableRecord.AppendEntity(dline);
                dline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(dline, true);

            }
            else
            {
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + radius + 1500, centerY + 300, 0), ListCentalSuppoData[0].ListPrimarySuppo[0].SupportName);

                //detail line
                Point3d dpt1 = new Point3d(centerX + radius, centerY, 0);
                Point3d dPt2 = new Point3d(centerX + radius + 4000, centerY, 0);
                Line dline = new Line(dpt1, dPt2);
                AcadBlockTableRecord.AppendEntity(dline);
                dline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
                AcadTransaction.AddNewlyCreatedDBObject(dline, true);
            }


            secCircle.Radius = radius - 5;
            secCircle.Center = center;
            secCircle.Linetype = sLineTypName;
            secCircle.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
            secCircle.LinetypeScale = 0.2;
            AcadBlockTableRecord.AppendEntity(secCircle);
            AcadTransaction.AddNewlyCreatedDBObject(secCircle, true);
            //Adds the arc and line to an object id collection
            ObjectIdCollection acObjIdColl = new ObjectIdCollection();
            acObjIdColl.Add(circle.ObjectId);
            ObjectIdCollection acObjectColl1 = new ObjectIdCollection();
            acObjectColl1.Add(secCircle.ObjectId);
            // Create the hatch object and append it to the block table record
            Hatch acHatch = new Hatch();
            AcadBlockTableRecord.AppendEntity(acHatch);
            AcadTransaction.AddNewlyCreatedDBObject(acHatch, true);

            // Set the properties of the hatch object
            // Associative must be set after the hatch object is appended to the 
            // block table record and before AppendLoop
            acHatch.SetDatabaseDefaults();
            acHatch.SetHatchPattern(HatchPatternType.PreDefined, "ANSI31");
            acHatch.Associative = true;
            acHatch.AppendLoop(HatchLoopTypes.Outermost, acObjIdColl);
            acHatch.AppendLoop(HatchLoopTypes.Outermost, acObjectColl1);
            acHatch.HatchStyle = HatchStyle.Normal;
            acHatch.Linetype = sLineTypName;
            acHatch.LinetypeScale = 0.2;
            acHatch.Color = Color.FromColorIndex(ColorMethod.ByAci, 8);
            // Evaluate the hatch
            acHatch.EvaluateHatch(true);

            // Increase the pattern scale by 2 and re-evaluate the hatch
            acHatch.PatternScale = acHatch.PatternScale + 69.23;
            acHatch.SetHatchPattern(acHatch.PatternType, acHatch.PatternName);
            acHatch.EvaluateHatch(true);

            //lines below circle
            Point3d lpt1 = new Point3d(centerX - radius * 0.75, centerY - ht_frm_cen, 0);
            Point3d lpt2 = new Point3d(centerX - radius * 0.75, centerY, 0);
            Line line1 = new Line(lpt1, lpt2);
            Point3dCollection intersectionPoints = new Point3dCollection();
            line1.IntersectWith(circle, Intersect.OnBothOperands, intersectionPoints, IntPtr.Zero, IntPtr.Zero);
            if (intersectionPoints.Count > 0)
            {
                line1.EndPoint = intersectionPoints[0];
            }
            AcadBlockTableRecord.AppendEntity(line1);
            line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(line1, true);

            Point3d lpt3 = new Point3d(centerX + radius * 0.75, centerY - ht_frm_cen, 0);
            Point3d lpt4 = new Point3d(centerX + radius * 0.75, centerY, 0);
            Line line2 = new Line(lpt3, lpt4);
            Point3dCollection intersectionPoints2 = new Point3dCollection();
            line2.IntersectWith(circle, Intersect.OnBothOperands, intersectionPoints2, IntPtr.Zero, IntPtr.Zero);
            if (intersectionPoints2.Count > 0)
            {
                line2.EndPoint = intersectionPoints2[0];
            }
            AcadBlockTableRecord.AppendEntity(line2);
            line2.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(line2, true);

            //last joining line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, line1.StartPoint, line2.StartPoint, MyCol.LightBlue);
        }


        public void CreateMtextfunc(BlockTableRecord acadBlockTableRecord, Transaction acadTransaction, Database acadDatabase, Point3d location, string text, [Optional] double textheight, [Optional] MyCol color)
        {

            // Create a new MText object with some text
            MText mtext = new MText();

            //try
            //{
            //    text = RoundUp(Convert.ToInt32(text)).ToString();
            //}
            //catch (Exception)
            //{

            //}

            mtext.Contents = text;

            // Set the position of the MText object
            mtext.Location = location;

            mtext.TextHeight = textheight == 0 ? 150 : textheight;

            mtext.Color = color.IsEmpty == true ? Color.FromColor(MyCol.Yellow) : Color.FromColor(color);

            // Add the MText object to the drawing
            acadBlockTableRecord.AppendEntity(mtext);
            acadTransaction.AddNewlyCreatedDBObject(mtext, true);

        }

        //for elevation view
        public void FixPrim_Elevation(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, double centerX, double centerY, Document Document2D)
        {
            Point3d center = new Point3d(centerX, centerY, 0);
            double radius = 801.5625;

            //insert block
            InsertBlockOnDocument("Front_Primary_Elevation", Document2D, centerX, centerY);

            //stores radius value
            info[Defination.Prim_Radius] = radius;


            //detail line
            Point3d dpt1 = new Point3d(centerX + radius, centerY, 0);
            Point3d dPt2 = new Point3d(centerX + radius + 4000, centerY, 0);
            Line dline = new Line(dpt1, dPt2);
            AcadBlockTableRecord.AppendEntity(dline);
            dline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(dline, true);

            //mtext
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + radius + 1500, centerY + 300, 0), "300NB");

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + radius + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //center mark
            //centerline
            Point3d cpt1 = new Point3d(centerX, centerY + radius + 250, 0);
            Point3d cPt2 = new Point3d(centerX, centerY - radius - 250, 0);
            Line cline = new Line(cpt1, cPt2);
            cline.Linetype = "Dashed";
            AcadBlockTableRecord.AppendEntity(cline);
            cline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(cline, true);

            Point3d cpt11 = new Point3d(centerX + radius + 250, centerY, 0);
            Point3d cPt21 = new Point3d(centerX - radius - 250, centerY, 0);
            Line cline1 = new Line(cpt11, cPt21);
            cline1.Linetype = "Dashed";
            AcadBlockTableRecord.AppendEntity(cline1);
            cline1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(cline1, true);

            //centerline
            Point3d lcpt1 = new Point3d(centerX, centerY + radius + 250, 0);
            Point3d lcPt2 = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 250, 0);
            Line lcline = new Line(lcpt1, lcPt2);
            lcline.Linetype = "Dashed";
            AcadBlockTableRecord.AppendEntity(lcline);
            lcline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(lcline, true);

        }

        //insert any block
        public void InsertBlockOnDocument(string fileName, Document finalDocument, double inserptX, double insertY)
        {

            ObjectIdCollection ids = new ObjectIdCollection();
            DocumentCollection documentCollection = Application.DocumentManager;

            string codeBase = Assembly.GetExecutingAssembly().CodeBase;
            UriBuilder uri = new UriBuilder(codeBase);
            string path = Uri.UnescapeDataString(uri.Path);

            string workingDirectory = Path.GetDirectoryName(path);

            // Get the project file path by searching for the .csproj file in the working directory
            string projectFilePath = Directory.GetFiles(workingDirectory, fileName + ".dwg").FirstOrDefault();

            var tempDocument = documentCollection.Open(projectFilePath, false);
            using (tempDocument.LockDocument())
            {
                var openDb = tempDocument.Database; using (Transaction trans = openDb.TransactionManager.StartTransaction())
                {
                    BlockTable bt = (BlockTable)trans.GetObject(openDb.BlockTableId, OpenMode.ForRead);
                    BlockTableRecord btrsrc = trans.GetObject(bt[BlockTableRecord.ModelSpace], OpenMode.ForWrite) as BlockTableRecord;


                    foreach (ObjectId id in btrsrc)
                    {
                        Point3d strpt = new Point3d(0, 0, 0);
                        Vector3d destvect = strpt.GetVectorTo(new Point3d(inserptX, insertY, 0));
                        var ent = (Entity)trans.GetObject(id, OpenMode.ForWrite);
                        ent.TransformBy(Matrix3d.Displacement(destvect));
                        //ent.UpgradeOpen();
                        if (ent.IsWriteEnabled)
                        {
                            // Object is not a proxy, clone it as-is
                            ids.Add(id);
                        }
                        else
                        {

                        }
                    }

                    trans.Commit();
                }
            }
            documentCollection.MdiActiveDocument = finalDocument;
            if (ids.Count != 0)
            {
                using (finalDocument.LockDocument())
                {
                    Database destdb = finalDocument.Database;
                    using (Transaction trans = destdb.TransactionManager.StartTransaction())
                    {
                        IdMapping iMap = new IdMapping();
                        //logger.Debug("Entering Copying of Template File");
                        destdb.WblockCloneObjects(ids, destdb.CurrentSpaceId, iMap, DuplicateRecordCloning.Replace, false);
                        trans.Commit();
                        //logger.Debug("Copied the Template File");
                    }
                }
            }
            tempDocument.CloseAndDiscard();

        }

        private void CopyPasteTemplateFile(string fileName, Document finalDocument, double inserptX)
        {
            ObjectIdCollection ids = new ObjectIdCollection();
            DocumentCollection documentCollection = Application.DocumentManager;

            string codeBase = Assembly.GetExecutingAssembly().CodeBase;
            UriBuilder uri = new UriBuilder(codeBase);
            string path = Uri.UnescapeDataString(uri.Path);

            string workingDirectory = Path.GetDirectoryName(path);

            // Get the project file path by searching for the .csproj file in the working directory
            string projectFilePath = Directory.GetFiles(workingDirectory, "Mtemp.dwg").FirstOrDefault();

            var tempDocument = documentCollection.Open(projectFilePath, false);
            using (tempDocument.LockDocument())
            {
                var openDb = tempDocument.Database; using (Transaction trans = openDb.TransactionManager.StartTransaction())
                {
                    BlockTable bt = (BlockTable)trans.GetObject(openDb.BlockTableId, OpenMode.ForRead);
                    BlockTableRecord btrsrc = trans.GetObject(bt[BlockTableRecord.ModelSpace], OpenMode.ForWrite) as BlockTableRecord;


                    foreach (ObjectId id in btrsrc)
                    {
                        Point3d strpt = new Point3d(0, 0, 0);
                        Vector3d destvect = strpt.GetVectorTo(new Point3d(inserptX, 0, 0));
                        var ent = (Entity)trans.GetObject(id, OpenMode.ForWrite);
                        ent.TransformBy(Matrix3d.Displacement(destvect));
                        //ent.UpgradeOpen();
                        if (ent.IsWriteEnabled)
                        {
                            // Object is not a proxy, clone it as-is
                            ids.Add(id);
                        }
                        else
                        {

                        }
                    }

                    trans.Commit();
                }
            }
            documentCollection.MdiActiveDocument = finalDocument;
            if (ids.Count != 0)
            {
                using (finalDocument.LockDocument())
                {
                    Database destdb = finalDocument.Database;
                    using (Transaction trans = destdb.TransactionManager.StartTransaction())
                    {
                        IdMapping iMap = new IdMapping();
                        //logger.Debug("Entering Copying of Template File");
                        destdb.WblockCloneObjects(ids, destdb.CurrentSpaceId, iMap, DuplicateRecordCloning.Replace, false);
                        trans.Commit();
                        //logger.Debug("Copied the Template File");
                    }
                }
            }
            tempDocument.CloseAndDiscard();
        }
        void CreateBottomBox(Document Document2D)
        {
            Database AcadDatabase = Document2D.Database;
            Transaction AcadTransaction = null;
            BlockTable AcadBlockTable = null;
            BlockTableRecord AcadBlockTableRecord = null;

            using (Document2D.LockDocument())
            {
                AcadTransaction = AcadDatabase.TransactionManager.StartTransaction();

                AcadBlockTable = AcadTransaction.GetObject(AcadDatabase.BlockTableId,
                                                               OpenMode.ForRead) as BlockTable;

                AcadBlockTableRecord = AcadTransaction.GetObject(AcadBlockTable[BlockTableRecord.ModelSpace],
                                                OpenMode.ForWrite) as BlockTableRecord;

                var SupportLine = new Polyline();

                Point2d Pt2D = new Point2d(0, 0);

                SupportLine.AddVertexAt(0, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(10, 0);
                SupportLine.AddVertexAt(1, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(10, 10);
                SupportLine.AddVertexAt(2, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(0, 10);
                SupportLine.AddVertexAt(3, Pt2D, 0, 0, 0);
                Pt2D = new Point2d(0, 0);
                SupportLine.AddVertexAt(4, Pt2D, 0, 0, 0);

                SupportLine.Color = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Red);

                AcadBlockTableRecord.AppendEntity(SupportLine);
                AcadTransaction.AddNewlyCreatedDBObject(SupportLine, true);

                AcadTransaction.Commit();
            }
        }

        //changes from other cs -extra functions
        //fix new function for Secondary Support Bottom

        private void ElevFixCreateSecondarySupportBottom(BlockTableRecord acadBlockTableRecord, Transaction AcadTransaction, Database acadDatabase, double centerX, double centerY)
        {
            double height = 3066.5059;
            double length = 416;
            double ht_frm_cen = 1220.7383 + 1000;
            var line = new Polyline();
            //double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            Point2d Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(2, Pt2D1, 0, 0, 0);

            //dimensioning
            RotatedDimension dim = new RotatedDimension(Math.PI / 2, new Point3d(centerX + length / 2, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2, centerY - ht_frm_cen - height, 0), new Point3d(centerX + length / 2 + 2500, centerY - ht_frm_cen - height, 0), "", ObjectId.Null);
            dim.Dimtxt = 100;
            dim.Dimasz = 150;

            dim.Dimclre = Color.FromColor(System.Drawing.Color.Cyan);
            dim.Dimclrt = Color.FromColor(System.Drawing.Color.Yellow);
            dim.Dimclrd = Color.FromColor(System.Drawing.Color.Cyan);

            dim.Dimtih = true;



            acadBlockTableRecord.AppendEntity(dim);
            AcadTransaction.AddNewlyCreatedDBObject(dim, true);

            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(4, Pt2D1, 0, 0, 0);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadBlockTableRecord.AppendEntity(line);
            AcadTransaction.AddNewlyCreatedDBObject(line, true);

            double gap = 100;
            Point3d pt1 = new Point3d(centerX - length / 2 + gap, centerY - ht_frm_cen, 0);
            Point3d Pt2 = new Point3d(centerX - length / 2 + gap, centerY - ht_frm_cen - height, 0);
            Line innerLine = new Line(pt1, Pt2);
            acadBlockTableRecord.AppendEntity(innerLine);
            innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);

            Point3d lpt1 = new Point3d(centerX + length / 2 - gap, centerY - ht_frm_cen, 0);
            Point3d lpt2 = new Point3d(centerX + length / 2 - gap, centerY - ht_frm_cen - height, 0);
            Line line1 = new Line(lpt1, lpt2);
            acadBlockTableRecord.AppendEntity(line1);
            line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(line1, true);

            FixCreateSideSecondarySupportBottom(AcadTransaction, acadBlockTableRecord, acadDatabase, "Left", centerX, centerY);
            //LineDraw(,)
        }
        private void FixCreateSecondarySupportBottom(BlockTableRecord acadBlockTableRecord, Transaction AcadTransaction, Database acadDatabase, double centerX, double centerY, string side)
        {
            double height = 3066.5059;
            double length = 1000.0000;
            double ht_frm_cen = 1220.7383 + 1000;
            var line = new Polyline();
            //double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            Point2d Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(2, Pt2D1, 0, 0, 0);

            //dimensioning
            RotatedDimension dim = new RotatedDimension(Math.PI / 2, new Point3d(centerX + length / 2, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2, centerY - ht_frm_cen - height, 0), new Point3d(centerX + length / 2 + 2500, centerY - ht_frm_cen - height, 0), "", ObjectId.Null);
            dim.Dimtxt = 100;
            dim.Dimasz = 150;

            dim.Dimclre = Color.FromColor(System.Drawing.Color.Cyan);
            dim.Dimclrt = Color.FromColor(System.Drawing.Color.Yellow);
            dim.Dimclrd = Color.FromColor(System.Drawing.Color.Cyan);

            dim.Dimtih = true;



            acadBlockTableRecord.AppendEntity(dim);
            AcadTransaction.AddNewlyCreatedDBObject(dim, true);

            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(4, Pt2D1, 0, 0, 0);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadBlockTableRecord.AppendEntity(line);
            AcadTransaction.AddNewlyCreatedDBObject(line, true);

            double gap = 100;
            Point3d pt1 = new Point3d(centerX - length / 2 + gap, centerY - ht_frm_cen, 0);
            Point3d Pt2 = new Point3d(centerX - length / 2 + gap, centerY - ht_frm_cen - height, 0);
            Line innerLine = new Line(pt1, Pt2);
            acadBlockTableRecord.AppendEntity(innerLine);
            innerLine.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(innerLine, true);

            Point3d lpt1 = new Point3d(centerX + length / 2 - gap, centerY - ht_frm_cen, 0);
            Point3d lpt2 = new Point3d(centerX + length / 2 - gap, centerY - ht_frm_cen - height, 0);
            Line line1 = new Line(lpt1, lpt2);
            acadBlockTableRecord.AppendEntity(line1);
            line1.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(line1, true);
            FixCreateSideSecondarySupportBottom(AcadTransaction, acadBlockTableRecord, acadDatabase, side, centerX, centerY);

        }

        //linedraw

        /// <param name="AcadBlockTableRecord">My number parameter</param>
        public void LineDraw(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database acadDatabase, Point3d startpt, Point3d endpt, MyCol color, [Optional] string linetype, [Optional] double linetypeScale)
        {
            Point3d cpt1 = startpt;//new Point3d(centerX, centerY + radius + 250, 0);
            Point3d cPt2 = endpt;// new Point3d(centerX, centerY - radius - 250, 0);
            Line cline = new Line(cpt1, cPt2);


            try
            {
                LinetypeTable acLineTypTbl;
                acLineTypTbl = AcadTransaction.GetObject(acadDatabase.LinetypeTableId,
                                                       OpenMode.ForRead) as LinetypeTable;

                if (acLineTypTbl.Has(linetype) == false)
                {
                    acadDatabase.LoadLineTypeFile(linetype, "acad.lin");
                    // cline.Linetype = Linetype;

                }
                cline.Linetype = linetype;
            }
            catch (Exception)
            {
            }
            if (color == null)
            {
                color = MyCol.LightBlue;
            }
            cline.Color = Color.FromColor(color);
            if (linetypeScale != 0)
            {
                cline.LinetypeScale = linetypeScale;
            }

            AcadBlockTableRecord.AppendEntity(cline);
            //cline.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            AcadTransaction.AddNewlyCreatedDBObject(cline, true);
        }

        //generic secondary support 
        private void GenCreateSecondarySupportBottom(BlockTableRecord acadBlockTableRecord, Transaction AcadTransaction, Database acadDatabase, double centerX, double centerY, double length, double height, double ht_frm_cen, SecThick secthik, double thickness = 100)
        {
            var line = new Polyline();
            //double height1 = prmsupport.Boundingboxmax.Z - prmsupport.Boundingboxmin.Z;
            Point2d Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(0, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(1, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX + length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(2, Pt2D1, 0, 0, 0);

            //dimensioning
            RotatedDimension dim = new RotatedDimension(Math.PI / 2, new Point3d(centerX + length / 2, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2, centerY - ht_frm_cen - height, 0), new Point3d(centerX + length / 2 + 2500, centerY - ht_frm_cen - height, 0), "", ObjectId.Null);
            dim.Dimtxt = 100;
            dim.Dimasz = 150;
            dim.Dimclre = Color.FromColor(System.Drawing.Color.Cyan);
            dim.Dimclrt = Color.FromColor(System.Drawing.Color.Yellow);
            dim.Dimclrd = Color.FromColor(System.Drawing.Color.Cyan);
            dim.Dimtih = true;

            acadBlockTableRecord.AppendEntity(dim);
            AcadTransaction.AddNewlyCreatedDBObject(dim, true);

            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen - height);
            line.AddVertexAt(3, Pt2D1, 0, 0, 0);
            Pt2D1 = new Point2d(centerX - length / 2, centerY - ht_frm_cen);
            line.AddVertexAt(4, Pt2D1, 0, 0, 0);
            line.Color = Color.FromColorIndex(ColorMethod.ByAci, 171);
            acadBlockTableRecord.AppendEntity(line);
            AcadTransaction.AddNewlyCreatedDBObject(line, true);

            thickness = 100;
            //if(secthik==SecThick.Both)
            //{
            //    LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
            //    LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
            //}

            switch (secthik)
            {
                case SecThick.HBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    break;
                case SecThick.HHidBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    break;
                case SecThick.Left:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidLeft:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    break;
                case SecThick.Right:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidRight:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    break;



                case SecThick.VBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2, centerY - ht_frm_cen - thickness, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    break;
                case SecThick.VHidBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    break;
                case SecThick.Top:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidTop:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    break;
                case SecThick.Bottom:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidBottom:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.Yellow, "DASHED");
                    break;


            }

        }

        //generic secondary support(for both top bottom)
        private void BoxGenCreateSecondarySupportBottom(BlockTableRecord acadBlockTableRecord, Transaction AcadTransaction, Database acadDatabase, Point3d lefttop, Point3d righttop, Point3d rightbot, Point3d leftbot, SecThick secthik, [Optional] string ISMCTAGDir, double verti_tag_offset = 0, double sectionsize = 100, string Centerline = "A")
        {

            LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, lefttop, righttop, MyCol.PaleTurquoise);
            LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, righttop, rightbot, MyCol.PaleTurquoise);
            LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, rightbot, leftbot, MyCol.PaleTurquoise);
            LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, leftbot, lefttop, MyCol.PaleTurquoise);

            //for ismc supp
            if (ISMCTAGDir == "L" || ISMCTAGDir == "l")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "ISMC " + sectionsize, new Point3d(lefttop.X, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0), new Point3d(lefttop.X - 2000, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0));
            }
            else if (ISMCTAGDir == "R" || ISMCTAGDir == "r")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "ISMC " + sectionsize, new Point3d(righttop.X, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0), new Point3d(righttop.X + 2000, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0));
            }
            //for L-section 
            if (ISMCTAGDir == "LL" || ISMCTAGDir == "ll")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "ISA " + sectionsize, new Point3d(lefttop.X, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0), new Point3d(lefttop.X - 2000, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0));
            }
            else if (ISMCTAGDir == "LR" || ISMCTAGDir == "lr")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "ISA " + sectionsize, new Point3d(righttop.X, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0), new Point3d(righttop.X + 2000, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0));
            }
            //for circular supp
            else if (ISMCTAGDir == "NBL" || ISMCTAGDir == "nbl")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, sectionsize + " NB", new Point3d(lefttop.X, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0), new Point3d(lefttop.X - 2000, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0));
            }
            else if (ISMCTAGDir == "NBR" || ISMCTAGDir == "nbr")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, sectionsize + " NB", new Point3d(righttop.X, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0), new Point3d(righttop.X + 2000, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0));
            }
            //for gusset plate
            else if (ISMCTAGDir == "GPL" || ISMCTAGDir == "gpl")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "GUSSET", new Point3d(lefttop.X, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0), new Point3d(lefttop.X - 2000, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0));
            }
            else if (ISMCTAGDir == "GPR" || ISMCTAGDir == "gpr")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "GUSSET", new Point3d(righttop.X, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0), new Point3d(righttop.X + 2000, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0));
            }

            //for plate
            else if (ISMCTAGDir == "PL" || ISMCTAGDir == "pl")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "PLATE ", new Point3d(lefttop.X, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0), new Point3d(lefttop.X - 2000, (lefttop.Y + leftbot.Y) / 2 + verti_tag_offset, 0));
            }
            else if (ISMCTAGDir == "PR" || ISMCTAGDir == "pr")
            {
                DrawLeader(acadBlockTableRecord, AcadTransaction, acadDatabase, "PLATE ", new Point3d(righttop.X, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0), new Point3d(righttop.X + 2000, (righttop.Y + rightbot.Y) / 2 + verti_tag_offset, 0));
            }


            double thickness = 100;
            //if(secthik==SecThick.Both)
            //{
            //    LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen, 0), new Point3d(centerX - length / 2 + thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
            //    LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen, 0), new Point3d(centerX + length / 2 - thickness, centerY - ht_frm_cen - height, 0), MyCol.LightBlue);
            //}

            switch (secthik)
            {
                case SecThick.VBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X + thickness, lefttop.Y, 0), new Point3d(leftbot.X + thickness, leftbot.Y, 0), MyCol.LightBlue);
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(righttop.X - thickness, righttop.Y, 0), new Point3d(rightbot.X - thickness, rightbot.Y, 0), MyCol.LightBlue);
                    break;
                case SecThick.VHidBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X + thickness, lefttop.Y, 0), new Point3d(leftbot.X + thickness, leftbot.Y, 0), MyCol.LightBlue, "DASHED", 500);
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(righttop.X - thickness, righttop.Y, 0), new Point3d(rightbot.X - thickness, rightbot.Y, 0), MyCol.LightBlue, "DASHED", 500);
                    break;
                case SecThick.Left:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X + thickness, lefttop.Y, 0), new Point3d(leftbot.X + thickness, leftbot.Y, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidLeft:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X + thickness, lefttop.Y, 0), new Point3d(leftbot.X + thickness, leftbot.Y, 0), MyCol.LightBlue, "DASHED", 500);
                    break;
                case SecThick.Right:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(righttop.X - thickness, righttop.Y, 0), new Point3d(rightbot.X - thickness, rightbot.Y, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidRight:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(righttop.X - thickness, righttop.Y, 0), new Point3d(rightbot.X - thickness, rightbot.Y, 0), MyCol.LightBlue, "DASHED", 500);
                    break;



                case SecThick.HBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X, lefttop.Y - thickness, 0), new Point3d(righttop.X, righttop.Y - thickness, 0), MyCol.LightBlue);
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(leftbot.X, leftbot.Y + thickness, 0), new Point3d(rightbot.X, rightbot.Y + thickness, 0), MyCol.LightBlue);
                    break;
                case SecThick.HHidBoth:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X, lefttop.Y - thickness, 0), new Point3d(righttop.X, righttop.Y - thickness, 0), MyCol.LightBlue, "DASHED", 500);
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(leftbot.X, leftbot.Y + thickness, 0), new Point3d(rightbot.X, rightbot.Y + thickness, 0), MyCol.LightBlue, "DASHED", 500);
                    break;
                case SecThick.Top:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X, lefttop.Y - thickness, 0), new Point3d(righttop.X, righttop.Y - thickness, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidTop:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X, lefttop.Y - thickness, 0), new Point3d(righttop.X, righttop.Y - thickness, 0), MyCol.LightBlue, "DASHED", 500);
                    break;
                case SecThick.Bottom:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(leftbot.X, leftbot.Y + thickness, 0), new Point3d(rightbot.X, rightbot.Y + thickness, 0), MyCol.LightBlue);
                    break;
                case SecThick.HidBottom:
                    // code block
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(leftbot.X, leftbot.Y + thickness, 0), new Point3d(rightbot.X, rightbot.Y + thickness, 0), MyCol.LightBlue, "DASHED", 500);
                    break;






            }

            //////create centerline
            var verticaldist = GetDist(lefttop, leftbot);
            var horizontaldist = GetDist(lefttop, righttop);

            if (Centerline.ToLower() != "na")
            {
                if (verticaldist > horizontaldist)
                {
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d((lefttop.X + righttop.X) / 2, lefttop.Y + 100, 0), new Point3d((lefttop.X + righttop.X) / 2, leftbot.Y - 100, 0), MyCol.Red, "DASHED", 500);
                }
                else if (horizontaldist > verticaldist)
                {
                    LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X - 100, (lefttop.Y + leftbot.Y) / 2, 0), new Point3d(righttop.X + 100, (lefttop.Y + leftbot.Y) / 2, 0), MyCol.Red, "DASHED", 500);
                }
            }

        }

        //aligh dimensioning
        public void CreateAlighDimen(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Point3d startpt, Point3d endpt, [Optional] string dimtxt, double offsetdist = -2000)
        {

            Line parallelline = CreateParallelLine(startpt, endpt, offsetdist);
            //dimensioning
            AlignedDimension align = new AlignedDimension(startpt, endpt, parallelline.EndPoint, "", ObjectId.Null);

            align.Dimtxt = 100;
            align.Dimasz = 150;

            try
            {
                align.DimensionText = Math.Round(Convert.ToDouble(dimtxt)).ToString();
            }
            catch (Exception)
            {
                align.DimensionText = dimtxt;
            }

            align.Dimdec = 2;
            align.Dimclre = Color.FromColor(System.Drawing.Color.Cyan);
            align.Dimclrt = Color.FromColor(System.Drawing.Color.Yellow);
            align.Dimclrd = Color.FromColor(System.Drawing.Color.Cyan);
            align.Dimtih = true;

            AcadBlockTableRecord.AppendEntity(align);
            AcadTransaction.AddNewlyCreatedDBObject(align, true);
        }

        //create parallel lines
        public Line CreateParallelLine(Point3d startpt, Point3d endpt, double offset)
        {

            var xDifference = startpt.X - endpt.X;
            var yDifference = startpt.Y - endpt.Y;
            var length = Math.Sqrt(Math.Pow(xDifference, 2) + Math.Pow(yDifference, 2));


            var X1 = (float)(startpt.X - offset * yDifference / length);
            var X2 = (float)(endpt.X - offset * yDifference / length);
            var Y1 = (float)(startpt.Y + offset * xDifference / length);
            var Y2 = (float)(endpt.Y + offset * xDifference / length);

            Line parallelLine = new Line(new Point3d(X1, Y1, 0), new Point3d(X2, Y2, 0));

            return parallelLine;
        }

        //enum for secondary thickness logic
        public enum SecThick
        {
            Nothing,

            VBoth,
            VHidBoth,
            Left,
            HidLeft,
            Right,
            HidRight,

            HBoth,
            HHidBoth,
            Top,
            HidTop,
            Bottom,
            HidBottom
        }

        //for distance
        public double GetDist(Point3d strpt, Point3d endpt)
        {
            double dist = Math.Sqrt(Math.Pow(endpt.X - strpt.X, 2) + Math.Pow(endpt.Y - strpt.Y, 2) + Math.Pow(endpt.Z - strpt.Z, 2));
            return dist;
        }

        public double GetDistArray(double[] strpt, double[] endpt)
        {
            double dist = Math.Sqrt(Math.Pow(endpt[0] - strpt[0], 2) + Math.Pow(endpt[1] - strpt[1], 2) + Math.Pow(endpt[2] - strpt[2], 2));
            return dist;
        }


        //enum for information
        public enum Defination
        {
            Prim_Radius,
            Prim_ht,
            Sec_ht_top,
            Sec_ht_bot,

            Sec_top_l,
            Sec_top_b,
            Sec_bot_l,
            Sec_bot_b,
            Concrete_l,
            Concrete_b,
            Plate_l,
            Plate_b,

            SecTopLT,
            SecTopRT,
            SecTopRB,
            SecTopLB,

            SecBotLT,
            SecBotRT,
            SecBotRB,
            SecBotLB



        }

        //for support name and quantity
        public void CreateSupportName(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, int i, [Optional] string supportype)
        {
            //support name and quantity
            double centerX = tracex + boxlen / 2;

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500, spaceY - boxht + 700 + 1100, 0), new Point3d(centerX + 1500, spaceY - boxht + 700 + 1100, 0), new Point3d(centerX + 1500, spaceY - boxht + 700, 0), new Point3d(centerX - 1500, spaceY - boxht + 700, 0), SecThick.Nothing, Centerline: "na");
#if _RELEASE
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 + 1000, spaceY - boxht + 700 + 1100 - 100, 0), ListCentalSuppoData[i].Name, 350, MyCol.Red);
#endif
#if _DEBUG

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 + 1000, spaceY - boxht + 700 + 1100 - 100, 0), ListCentalSuppoData[i].Name + " " + supportype, 350, MyCol.Red);
#endif
            //support quant
            int quant = ListCentalSuppoData[i].Quantity;

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 + 800, spaceY - boxht + 700 + 1100 - 600, 0), "QTY. " + quant + " NOS.", 250, MyCol.Green);
        }

        //for reference bock
        private void CreateRefBlock(BlockTableRecord acadBlockTableRecord, Transaction AcadTransaction, Database acadDatabase, Point3d lefttop, Point3d righttop, Point3d rightbot, Point3d leftbot, string boxorientation = "ver")
        {

            if (boxorientation.ToLower() == "hor")
            {
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, lefttop, new Point3d(lefttop.X, (lefttop.Y + righttop.Y) / 2 - 250, lefttop.Z), MyCol.PaleTurquoise);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X, (lefttop.Y + righttop.Y) / 2 - 250, lefttop.Z), new Point3d(lefttop.X, (lefttop.Y + righttop.Y) / 2 + 250, lefttop.Z), MyCol.PaleTurquoise, "ZIGZAG", 500);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(lefttop.X, (lefttop.Y + righttop.Y) / 2 + 250, lefttop.Z), righttop, MyCol.PaleTurquoise);
            }
            else
            {
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, lefttop, new Point3d((lefttop.X + righttop.X) / 2 - 250, lefttop.Y, lefttop.Z), MyCol.PaleTurquoise);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d((lefttop.X + righttop.X) / 2 - 250, lefttop.Y, lefttop.Z), new Point3d((lefttop.X + righttop.X) / 2 + 250, lefttop.Y, lefttop.Z), MyCol.PaleTurquoise, "ZIGZAG", 500);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d((lefttop.X + righttop.X) / 2 + 250, lefttop.Y, lefttop.Z), righttop, MyCol.PaleTurquoise);
            }



            LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, righttop, rightbot, MyCol.PaleTurquoise, "DASHED", 500);


            if (boxorientation.ToLower() == "hor")
            {
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, rightbot, new Point3d(leftbot.X
                    , (leftbot.Y + rightbot.Y) / 2 + 250, leftbot.Z), MyCol.PaleTurquoise);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(leftbot.X
                    , (leftbot.Y + rightbot.Y) / 2 + 250, leftbot.Z), new Point3d(leftbot.X
                    , (leftbot.Y + rightbot.Y) / 2 - 250, leftbot.Z), MyCol.PaleTurquoise, "ZIGZAG", 500);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d(leftbot.X
                    , (leftbot.Y + rightbot.Y) / 2 - 250, leftbot.Z), leftbot, MyCol.PaleTurquoise);

            }
            else
            {
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, rightbot, new Point3d((lefttop.X + righttop.X) / 2 + 250, leftbot.Y, leftbot.Z), MyCol.PaleTurquoise);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d((lefttop.X + righttop.X) / 2 + 250, leftbot.Y, leftbot.Z), new Point3d((lefttop.X + righttop.X) / 2 - 250, leftbot.Y, leftbot.Z), MyCol.PaleTurquoise, "ZIGZAG", 500);
                LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, new Point3d((lefttop.X + righttop.X) / 2 - 250, leftbot.Y, leftbot.Z), leftbot, MyCol.PaleTurquoise);
            }

            LineDraw(acadBlockTableRecord, AcadTransaction, acadDatabase, leftbot, lefttop, MyCol.PaleTurquoise, "DASHED", 500);
        }

        //create leader

        public void DrawLeader(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, string text, Point3d firstPoint, Point3d secondPoint, Point3d? thirdPoint = null)
        {

            // Create the MText annotation
            MText acMText = new MText();
            acMText.SetDatabaseDefaults();
            acMText.Contents = text;
            acMText.Location = secondPoint;

            if (thirdPoint.HasValue)
            {
                acMText.Location = thirdPoint.Value;
            }

            //acMText.Width = 2;
            acMText.TextHeight = 200;
            // Set text position to above
            acMText.Attachment = AttachmentPoint.TopCenter;
            //acMText.
            // Add the new object to Model space and the transaction
            AcadBlockTableRecord.AppendEntity(acMText);
            AcadTransaction.AddNewlyCreatedDBObject(acMText, true);
            //ObjectId objectIds1 = SymbolUtilityServices.GetBlockModelSpaceId(AcadDatabase);

            // objectIds1.Add(acMText.Id); 
            Leader acLdr = new Leader();
            acLdr.SetDatabaseDefaults();
            acLdr.AppendVertex(firstPoint);
            acLdr.AppendVertex(secondPoint);
            if (thirdPoint.HasValue)
            {
                acLdr.AppendVertex(thirdPoint.Value);
            }
            acLdr.HasArrowHead = true;
            acLdr.Dimasz = 150;


            TextStyleTable acTStyleTbl = AcadTransaction.GetObject(AcadDatabase.TextStyleTableId, OpenMode.ForRead) as TextStyleTable;

            DimStyleTable acDimStyleTbl = AcadTransaction.GetObject(AcadDatabase.DimStyleTableId, OpenMode.ForRead) as DimStyleTable;

            // Get the index of the dimension style named "ISO-25"
            //int iso25Index = acDimStyleTbl.FindIndex("ISO-25");

            // Get the dimension style at the specified index
            //ObjectId acDimStyleId = acDimStyleTbl[iso25Index];

            //ObjectId acDimStyleId = acDimStyleTbl["ISO-25"];

            //acLdr.TextStyleId = acDimStyleId;

            acLdr.Color = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Cyan);
            //acLdr.Dimclrd = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Green);                     //Add the new object to Model space and the transaction
            AcadBlockTableRecord.AppendEntity(acLdr);
            AcadTransaction.AddNewlyCreatedDBObject(acLdr, true);
            acLdr.Annotation = acMText.ObjectId;
            acLdr.EvaluateLeader();

        }

        public void DrawLeader_WITH_TXT_ABOVE_BELOW(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, string Abovetext, string Belowtext, Point3d firstPoint, Point3d secondPoint, Point3d? thirdPoint = null)
        {

            // Create the MText Above annotation
            MText acMText = new MText();
            acMText.SetDatabaseDefaults();
            acMText.Contents = Abovetext;
            acMText.Location = new Point3d(secondPoint.X, secondPoint.Y + 200, 0);

            if (thirdPoint.HasValue)
            {
                acMText.Location = new Point3d(thirdPoint.Value.X, thirdPoint.Value.Y + 200, 0);
            }
            acMText.TextHeight = 150;
            acMText.Attachment = AttachmentPoint.BottomLeft;
            AcadBlockTableRecord.AppendEntity(acMText);
            AcadTransaction.AddNewlyCreatedDBObject(acMText, true);

            // Create the MText Below annotation
            MText acMText_below = new MText();
            acMText_below.SetDatabaseDefaults();
            acMText_below.Contents = Belowtext;
            acMText_below.Location = new Point3d(secondPoint.X, secondPoint.Y - 100, 0);

            if (thirdPoint.HasValue)
            {
                acMText_below.Location = new Point3d(thirdPoint.Value.X, thirdPoint.Value.Y - 100, 0);
            }
            acMText_below.TextHeight = 150;
            acMText_below.Attachment = AttachmentPoint.TopCenter;
            AcadBlockTableRecord.AppendEntity(acMText_below);
            AcadTransaction.AddNewlyCreatedDBObject(acMText_below, true);

            Leader acLdr = new Leader();
            acLdr.SetDatabaseDefaults();
            acLdr.AppendVertex(firstPoint);
            acLdr.AppendVertex(secondPoint);
            if (thirdPoint.HasValue)
            {
                acLdr.AppendVertex(thirdPoint.Value);
            }
            acLdr.HasArrowHead = true;
            acLdr.Dimasz = 150;


            TextStyleTable acTStyleTbl = AcadTransaction.GetObject(AcadDatabase.TextStyleTableId, OpenMode.ForRead) as TextStyleTable;

            DimStyleTable acDimStyleTbl = AcadTransaction.GetObject(AcadDatabase.DimStyleTableId, OpenMode.ForRead) as DimStyleTable;

            // Get the index of the dimension style named "ISO-25"
            //int iso25Index = acDimStyleTbl.FindIndex("ISO-25");

            // Get the dimension style at the specified index
            //ObjectId acDimStyleId = acDimStyleTbl[iso25Index];

            //ObjectId acDimStyleId = acDimStyleTbl["ISO-25"];

            //acLdr.TextStyleId = acDimStyleId;

            acLdr.Color = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Cyan);
            //acLdr.Dimclrd = Autodesk.AutoCAD.Colors.Color.FromColor(System.Drawing.Color.Green);                     //Add the new object to Model space and the transaction
            AcadBlockTableRecord.AppendEntity(acLdr);
            AcadTransaction.AddNewlyCreatedDBObject(acLdr, true);
            acLdr.Annotation = acMText.ObjectId;
            acLdr.Annotation = acMText_below.ObjectId;
            acLdr.EvaluateLeader();

        }



        //foot of perpendicular
        public static Point3d FindPerpendicularFoot(Pt3D destpt, double[] strpt, double[] endpt)
        {

            Vector3 segmentStart = new Vector3(Convert.ToSingle(strpt[0]), Convert.ToSingle(strpt[1]), Convert.ToSingle(strpt[2]));

            Vector3 segmentEnd = new Vector3(Convert.ToSingle(endpt[0]), Convert.ToSingle(endpt[1]), Convert.ToSingle(endpt[2]));

            Vector3 point = new Vector3(Convert.ToSingle(destpt.X), Convert.ToSingle(destpt.Y), Convert.ToSingle(destpt.Z));

            // Calculate the direction vector of the segment
            Vector3 segmentDirection = segmentEnd - segmentStart;

            // Calculate the vector from the start of the segment to the point
            Vector3 pointVector = point - segmentStart;

            // Calculate the projection of the point vector onto the segment direction vector
            float projection = Vector3.Dot(pointVector, segmentDirection) / segmentDirection.LengthSquared();

            // Clamp the projection to the range [0,1] to ensure the foot is on the segment
            //projection = Math. Clamp(projection, 0, 1);

            // Calculate the foot of the perpendicular
            Vector3 foot = segmentStart + projection * segmentDirection;

            Point3d result = new Point3d(foot.X, foot.Y, foot.Z);

            return result;
        }

        //foot of perpendicular
        public static Point3d FindPerpendicularFoot(double[] destpt, double[] strpt, double[] endpt)
        {

            Vector3 segmentStart = new Vector3(Convert.ToSingle(strpt[0]), Convert.ToSingle(strpt[1]), Convert.ToSingle(strpt[2]));

            Vector3 segmentEnd = new Vector3(Convert.ToSingle(endpt[0]), Convert.ToSingle(endpt[1]), Convert.ToSingle(endpt[2]));

            Vector3 point = new Vector3(Convert.ToSingle(destpt[0]), Convert.ToSingle(destpt[1]), Convert.ToSingle(destpt[2]));

            // Calculate the direction vector of the segment
            Vector3 segmentDirection = segmentEnd - segmentStart;

            // Calculate the vector from the start of the segment to the point
            Vector3 pointVector = point - segmentStart;

            // Calculate the projection of the point vector onto the segment direction vector
            float projection = Vector3.Dot(pointVector, segmentDirection) / segmentDirection.LengthSquared();

            // Clamp the projection to the range [0,1] to ensure the foot is on the segment
            //projection = Math. Clamp(projection, 0, 1);

            // Calculate the foot of the perpendicular
            Vector3 foot = segmentStart + projection * segmentDirection;

            Point3d result = new Point3d(foot.X, foot.Y, foot.Z);

            return result;
        }

        public static void ListDimStylesCommand()
        {
            Document doc = Application.DocumentManager.MdiActiveDocument;
            Database db = doc.Database;
            Editor ed = doc.Editor;

            using (Transaction tr = db.TransactionManager.StartTransaction())
            {
                DimStyleTable dst = tr.GetObject(db.DimStyleTableId, OpenMode.ForRead) as DimStyleTable;

                if (dst == null)
                {
                    ed.WriteMessage("\nCould not get the dimension style table.");
                    return;
                }

                ed.WriteMessage("\nList of dimension styles:");
                foreach (ObjectId id in dst)
                {
                    DimStyleTableRecord ds = (DimStyleTableRecord)tr.GetObject(id, OpenMode.ForRead);
                    if (ds != null)
                    {
                        ed.WriteMessage("\n- {0}", ds.Name);
                    }
                }

                tr.Commit();
            }
        }


        //adding dimstyle iso-25
        public void AddDimStyleToDimensions()
        {
            Document doc = Application.DocumentManager.MdiActiveDocument;
            Database db = doc.Database;
            Editor ed = doc.Editor;

            // Create an empty list to store dimensions
            ObjectIdCollection dimIds = new ObjectIdCollection();

            // Get all the dimensions in the drawing
            using (Transaction tr = db.TransactionManager.StartTransaction())
            {
                BlockTable bt = tr.GetObject(db.BlockTableId, OpenMode.ForRead) as BlockTable;
                BlockTableRecord btr = tr.GetObject(bt[BlockTableRecord.ModelSpace], OpenMode.ForRead) as BlockTableRecord;

                foreach (ObjectId objId in btr)
                {
                    if ((objId.ObjectClass == RXClass.GetClass(typeof(AlignedDimension))) || (objId.ObjectClass == RXClass.GetClass(typeof(RotatedDimension))))
                    {
                        dimIds.Add(objId);
                    }
                }

                tr.Commit();
            }

            // Add the dimensions to the AllDimension list
            List<Dimension> AllDimension = new List<Dimension>();
            using (Transaction tr = db.TransactionManager.StartTransaction())
            {
                foreach (ObjectId dimId in dimIds)
                {
                    Dimension dim = tr.GetObject(dimId, OpenMode.ForWrite) as Dimension;
                    AllDimension.Add(dim);
                }
                tr.Commit();
            }

            // Add the "ISO-25" dimstyle to each dimension in the AllDimension list
            using (Transaction tr = db.TransactionManager.StartTransaction())
            {
                // Get the "ISO-25" dimstyle to be applied
                DimStyleTable dst = tr.GetObject(db.DimStyleTableId, OpenMode.ForRead) as DimStyleTable;
                if (!dst.Has("ISO-25"))
                {

                    ed.WriteMessage("Dimstyle 'ISO-25' does not exist in the drawing. Please create it before running this command.");
                    return;
                }

                ObjectId iso25DimStyleId = dst["ISO-25"];


                // Apply the "ISO-25" dimstyle to each dimension in the AllDimension list
                foreach (Dimension dim in AllDimension)
                {
                    dim.DimensionStyle = iso25DimStyleId;
                    dim.Dimtxt = 1.5;
                    dim.Dimasz = 2.5;
                }
                tr.Commit();
            }

            ed.WriteMessage("Dimstyle 'ISO-25' added to all dimensions.");
        }

        public static int RoundUp(int value)
        {
            return 10 * ((value + 9) / 10);
        }

        public static double Roundnear5(double value)
        {
            return (int)(Math.Round(value / 5) * 5);
        }

        public double MillimetersToMeters(double millimeters)
        {
            return millimeters *= 0.001; ;
        }

        public string GettheISMC(string str)
        {
            Dictionary<string, string> DicISMCcode = new Dictionary<string, string>();
            DicISMCcode["ISMC75"] = "75X40";
            DicISMCcode["ISMC100"] = "100X50";
            DicISMCcode["ISMC125"] = "125X66";
            DicISMCcode["ISMC150"] = "150X75";
            DicISMCcode["ISMC150*"] = "150X76";
            DicISMCcode["ISMC175"] = "175X75";
            DicISMCcode["ISMC175*"] = "175X76";
            DicISMCcode["ISMC200"] = "200X75";
            DicISMCcode["ISMC200*"] = "200X76";
            DicISMCcode["ISMC225"] = "225X80";
            DicISMCcode["ISMC225*"] = "225X82";
            DicISMCcode["ISMC250"] = "250X80";
            DicISMCcode["ISMC250*"] = "250X82";
            DicISMCcode["ISMC250**"] = "250X83";
            DicISMCcode["ISMC300"] = "300X90";
            DicISMCcode["ISMC300*"] = "300X92";
            DicISMCcode["ISMC300**"] = "300X93";
            DicISMCcode["ISMC350"] = "350X100";
            DicISMCcode["ISMC400"] = "400X100";

            foreach (var Item in DicISMCcode)
            {
                if (str.ToUpper().Contains(Item.Value))
                {
                    return Item.Key;
                }
            }

            return "";
        }
        public double CSECTIONSIZE(string str)
        {
            if (str == null)
            {
                return 0;
            }
            char[] chars = { };
            StringBuilder sb = new StringBuilder();


            foreach (char ch in str)
            {
                if (ch == 'x' || ch == 'X')
                {
                    break;
                }
                if (char.IsDigit(ch))
                {
                    sb.Append(ch);
                }
            }


            string result = string.Join("", sb);
            return Convert.ToDouble(result);
        }

        public static double InchesToMm(double inches)
        {
            return inches * 25.4;
        }


        public void TOSLOC(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, double centerX, double centerY, string TotalHt, string position = "r", string HTtype = "TOS EL.(+)")
        {
            try
            {
                TotalHt = Math.Round(Convert.ToDouble(TotalHt), 2).ToString();

            }
            catch (Exception)
            {

            }

            if (position.ToLower() == "l")
            {
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 3500, centerY + 300, 0), HTtype + TotalHt);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY, 0), new Point3d(centerX - 4000, centerY, 0), MyCol.LightBlue);
            }
            else
            {
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY + 300, 0), HTtype + TotalHt);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY, 0), new Point3d(centerX + 4000, centerY, 0), MyCol.LightBlue);
            }


        }

        Edgeinfo GetEdgeforplate(SupporSpecData PrimarySupport, SupporSpecData PlateSuppo)
        {
            Edgeinfo Edgeinfo = new Edgeinfo();
            double edgelenght = 0.0;
            System.Windows.Media.Media3D.Vector3D Vec1 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);
            System.Windows.Media.Media3D.Vector3D Vec2 = new System.Windows.Media.Media3D.Vector3D(0, 1, 0);
            System.Windows.Media.Media3D.Vector3D Vec3 = new System.Windows.Media.Media3D.Vector3D(1, 0, 0);



            Vec1.X = PrimarySupport.NoramlDir.X;
            Vec1.Y = PrimarySupport.NoramlDir.Y;
            Vec1.Z = PrimarySupport.NoramlDir.Z;



            foreach (var Face in PlateSuppo.ListfaceData)
            {
                Vec2.X = Face.FaceNormal.X;
                Vec2.Y = Face.FaceNormal.Y;
                Vec2.Z = Face.FaceNormal.Z;



                if (Math.Abs(Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3)))).Equals(0) || Math.Abs(Math.Round(Calculate.ConvertRadiansToDegrees(Calculate.GetSignedRotation(Vec1, Vec2, Vec3)))).Equals(180))
                {
                    foreach (var Edge in Face.ListlinearEdge)
                    {
                        if (Edge.EdgeLength > edgelenght)
                        {
                            edgelenght = Edge.EdgeLength;
                            Edgeinfo = Edge;
                        }
                    }



                    return Edgeinfo;
                }
            }



            return Edgeinfo;
        }

        public static double[] GetArrayAbsoluteValues(double[] arr)
        {
            double[] absArr = new double[arr.Length];

            for (int i = 0; i < arr.Length; i++)
            {
                absArr[i] = Math.Abs(arr[i]);
            }

            return absArr;
        }

        public static Pt3D Get3dAbsoluteValues(Pt3D arr)
        {
            arr.X = Math.Abs(arr.X);
            arr.Y = Math.Abs(arr.Y);
            arr.Z = Math.Abs(arr.Z);

            return arr;
        }


        public static double[] FindClosestPoint(double[] strpt, double[] endpt, Pt3D closestTO)
        {

            Vector3 pointA = new Vector3(Convert.ToSingle(strpt[0]), Convert.ToSingle(strpt[1]), Convert.ToSingle(strpt[2]));
            Vector3 pointB = new Vector3(Convert.ToSingle(endpt[0]), Convert.ToSingle(endpt[1]), Convert.ToSingle(endpt[2]));
            Vector3 targetPoint = new Vector3(Convert.ToSingle(closestTO.X), Convert.ToSingle(closestTO.Y), Convert.ToSingle(closestTO.Z));

            // Calculate the distances between each point and the target point
            float distanceToA = Vector3.Distance(pointA, targetPoint);
            float distanceToB = Vector3.Distance(pointB, targetPoint);

            // Determine which point is closer
            if (distanceToA < distanceToB)
            {
                double[] result = new double[] { pointA.X, pointA.Y, pointA.Z };
                return result;
            }
            else
            {
                double[] result = new double[] { pointB.X, pointB.Y, pointB.Z };
                return result;
            }
        }

        public static double FindMinValue(double[] numbers)
        {
            if (numbers == null || numbers.Length == 0)
            {
                throw new ArgumentException("The array is empty or null.");
            }

            double minValue = numbers[0];
            for (int i = 1; i < numbers.Length; i++)
            {
                if (numbers[i] < minValue)
                {
                    minValue = numbers[i];
                }
            }

            return minValue;
        }

        public static Point3d GetLeftPoint(Point3d midPoint, Point3d point1, Point3d point2)
        {
            Vector3d vectorToP1 = point1 - midPoint;
            Vector3d vectorToP2 = point2 - midPoint;

            Vector3d normal = vectorToP1.CrossProduct(vectorToP2);
            if (normal.Z < 0)
                return point1;
            else
                return point2;
        }

        public static Point3d GetRightPoint(Point3d midPoint, Point3d point1, Point3d point2)
        {
            Vector3d vectorToP1 = point1 - midPoint;
            Vector3d vectorToP2 = point2 - midPoint;

            Vector3d normal = vectorToP1.CrossProduct(vectorToP2);
            if (normal.Z < 0)
                return point2;
            else
                return point1;
        }

        public void CHECKPRIM_CLAMP_BRAC(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, double centerX, double centerY, double radius, SupporSpecData primsup_des, [Optional] int i)
        {
            if (primsup_des.SupportName.ToLower().Contains("clamp"))
            {
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            }
            else if (primsup_des.SupportName.ToLower().Contains("brac"))
            {
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_Brac", centerX, centerY, radius);
            }

        }

        public double GET_PROJECTEDPT_DIST(SupporSpecData secsupp_des, double[] primsup_des)
        {

            var strpt = secsupp_des.StPt;
            var endpt = secsupp_des.EndPt;

            Point3d projectedpt = FindPerpendicularFoot(primsup_des, strpt, endpt);

            double l_dist_frm_centre = GetDist(new Point3d(strpt), projectedpt);
            double r_dist_frm_centre = GetDist(new Point3d(endpt), projectedpt);
            double min = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            return min;
        }




        //public static double[] FindClosestPoint_TOLINE(double[] lineStart, double[] lineEnd, double[] point1, double[] point2)
        //{
        //    double lineLength = CalculateDistance(lineStart, lineEnd);

        //    if (lineLength == 0)
        //    {
        //        return point1; // or point2, since the line is a single point
        //    }

        //    double t1 = CalculateParameter(lineStart, lineEnd, point1);
        //    double t2 = CalculateParameter(lineStart, lineEnd, point2);

        //    if (t1 >= 0 && t1 <= 1 && t2 >= 0 && t2 <= 1)
        //    {
        //        // Both points are within the line segment, find the closest point on the line
        //        double[] closestPoint = new double[3];
        //        for (int i = 0; i < 3; i++)
        //        {
        //            closestPoint[i] = lineStart[i] + t1 * (lineEnd[i] - lineStart[i]);
        //        }
        //        return closestPoint;
        //    }

        //    // Either one or both points are outside the line segment, find the closest point among them
        //    double distance1 = CalculateDistance(lineStart, point1);
        //    double distance2 = CalculateDistance(lineStart, point2);

        //    return distance1 <= distance2 ? point1 : point2;
        //}

        //private static double CalculateDistance(double[] point1, double[] point2)
        //{
        //    double sum = 0;
        //    for (int i = 0; i < 3; i++)
        //    {
        //        double diff = point1[i] - point2[i];
        //        sum += diff * diff;
        //    }
        //    return Math.Sqrt(sum);
        //}

        //private static double CalculateParameter(double[] lineStart, double[] lineEnd, double[] point)
        //{
        //    double sum = 0;
        //    for (int i = 0; i < 3; i++)
        //    {
        //        sum += (point[i] - lineStart[i]) * (lineEnd[i] - lineStart[i]);
        //    }
        //    double lineLengthSquared = CalculateDistance(lineStart, lineEnd) * CalculateDistance(lineStart, lineEnd);
        //    return sum / lineLengthSquared;
        //}

        //new logic for dist



        public static double[] FindClosestPoint_TOLINE(double[] pointA, double[] pointB, double[] pointX, double[] pointY)
        {
            double distanceX = CalculateDistanceToLine(pointA, pointB, pointX);
            double distanceY = CalculateDistanceToLine(pointA, pointB, pointY);

            if (distanceX < distanceY)
            {
                return pointX;
            }
            else if (distanceX > distanceY)
            {
                return pointY;
            }
            else
            {
                return null;
            }
        }

        private static double CalculateDistanceToLine(double[] lineStart, double[] lineEnd, double[] point)
        {
            double lineLength = CalculateDistance(lineStart, lineEnd);

            if (lineLength == 0)
            {
                return CalculateDistance(lineStart, point);
            }

            double t = ((point[0] - lineStart[0]) * (lineEnd[0] - lineStart[0]) +
                        (point[1] - lineStart[1]) * (lineEnd[1] - lineStart[1]) +
                        (point[2] - lineStart[2]) * (lineEnd[2] - lineStart[2])) / (lineLength * lineLength);

            if (t < 0)
            {
                return CalculateDistance(lineStart, point);
            }

            if (t > 1)
            {
                return CalculateDistance(lineEnd, point);
            }

            double[] projection = new double[3];
            for (int i = 0; i < 3; i++)
            {
                projection[i] = lineStart[i] + t * (lineEnd[i] - lineStart[i]);
            }

            return CalculateDistance(projection, point);
        }

        private static double CalculateDistance(double[] point1, double[] point2)
        {
            double sum = 0;
            for (int i = 0; i < 3; i++)
            {
                double diff = point1[i] - point2[i];
                sum += diff * diff;
            }
            return Math.Sqrt(sum);
        }

        //for calculating no of distances for primary
        public static List<double> CalculateAccumulation(List<double> inputList)
        {
            List<double> finalOutput = new List<double>();
            finalOutput.Clear();
            if (inputList.Count > 0)
            {
                finalOutput.Add(inputList[0]); // First number remains unchanged

                for (int k = 1; k < inputList.Count; k++)
                {
                    double subtractedValue = inputList[k] - inputList[k - 1];
                    finalOutput.Add(subtractedValue);
                }
            }
            return finalOutput;
        }

        public static List<double> PlaceFiguresOnSupport(double supportLength, int numberOfFigures, double margin)
        {
            //if (supportLength <= 0 || numberOfFigures < 2 || margin <= 0)
            //{
            //    return null;
            //}

            double spacing = 0.0;
            if (supportLength <= 0 || numberOfFigures < 2 || margin <= 0)
            {
                spacing = 1000;
            }
            else
            {
                spacing = (supportLength - 2 * margin) / (numberOfFigures - 1);
            }

            List<double> figurePositions = new List<double>();

            for (int i = 0; i < numberOfFigures; i++)
            {
                double position = margin + (spacing * i);
                figurePositions.Add(position);
            }

            return figurePositions;
        }

        private Point3d GetMidPoint(Point3d point3d1, Point3d point3d2)
        {
            return new Point3d((point3d1.X + point3d2.X) / 2, (point3d1.Y + point3d2.Y) / 2, (point3d1.Z + point3d2.Z) / 2);
        }

        public string GET_PRIM_HT_FRM_DATUM(SupporSpecData primsup_des)
        {
            string prim_height = "";
            try
            {
                if (primsup_des.SupportName.ToLower().Contains("clamp") || primsup_des.SupportName.ToLower().Contains("brac"))
                {
                    prim_height = Math.Round((MillimetersToMeters(primsup_des.Centroid.Z)), 2).ToString();
                }
                else
                {
                    prim_height = Math.Round((MillimetersToMeters(primsup_des.PrimaryZhtNB)), 2).ToString();
                }

            }
            catch (Exception)
            {

            }
            return prim_height;
        }

        //support details

        [Obsolete]
        public void DRS1(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }



            //////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            /////////////////////bot sec
            height = 3000;
            length = 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////left top sec
            height = 1000;
            length = 3000;

            //upper secondary supp

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - length, pointsinfo[Defination.SecBotLB].Y + 500 + height, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + height, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - length, pointsinfo[Defination.SecBotLB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - length, pointsinfo[Defination.SecBotLB].Y + 500, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotLB].X - length, pointsinfo[Defination.SecBotLB].Y + 500 + height, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + height, 0);
            l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, "l");
            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);




            ///////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "2");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS2(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }



            //////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            /////////////////////bot sec
            height = 3000;
            length = 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "2");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        public void DRS3(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            ////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }





            //double ht_frm_cen = 1220.7383;

            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            //ref block
            pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "3");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS4(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            /////////////////////prim  sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }



            //////////////////top sec
            double height = 1000;
            double length = 3000;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////////////bot sec
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ///////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }



            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "4");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS5(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());

                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }
            }
            catch (Exception)
            {

            }



            double height = 1000;
            double length = 3000;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }



            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec supp
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "R", sectionsize: sectionsize);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), botsec, 1000);

            ///////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "5");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS6(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);


            //////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                //upper primary
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 801.5625;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius, primsup_des.ElementAt(0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }

                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    double radius = 801.5625;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }



            /////////////////top sec upper
            double height = 1000;
            double length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {

                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);

                // l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                // r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);




            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            //////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "r", 2000, sectionsize);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);


            ///////////////lower sec top supp
            height = 1000;
            length = 4000;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;


            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HBoth, "L", sectionsize: sectionsize);

            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);

            /////////////////////prim sup
            string lower_prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    lower_prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }


            ////////////prim of lower sec top supp
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 1200;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + radius, radius, primsup_des.ElementAt(1));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + radius, 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 300, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }




            //note nfo[prim.ht changes here

            //dimensioning

            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
                // l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                // r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5)+1200, 0));
            CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            /////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "6");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS7(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);



            ///////////////////////prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    InsertblockScale(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Primary_Elevation", centerX, centerY, 801.5625);
                    double radius = 801.5625;
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + radius, centerY, 0), new Point3d(centerX + radius + 4000, centerY, 0), MyCol.LightBlue);


                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = 1.5 * radius;

                }
            }
            catch (Exception)
            {

            }

            // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), ListCentalSuppoData[0].ListPrimarySuppo[0].SupportName);

            //////////////////upper plate
            double height = 100;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //plate
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "pl", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //dimensioning

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var prims = ListCentalSuppoData[i].ListPrimarySuppo[0];
                var secs = secsupp_des.ElementAt(0);
                var edge = GetEdgeforplate(prims, secs);
                var strpt1 = edge.StPt;
                var endpt1 = edge.EndPt;
                var strpt = new double[] { strpt1.X, strpt1.Y, strpt1.Z };
                var endpt = new double[] { endpt1.X, endpt1.Y, endpt1.Z };

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }



            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            //sec ht
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////bot sec
            height = 2000;
            length = 1000;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //secondary bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);


            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ///////////////concrete sup
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "7");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS8(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);



            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                }
            }
            catch (Exception)
            {

            }



            /////////////////plate
            double height = 100;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //////////////////////////////plate
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.Nothing, "pl", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //dimensioning

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {

                var prims = ListCentalSuppoData[i].ListPrimarySuppo[0];
                var secs = secsupp_des.ElementAt(0);
                var edge = GetEdgeforplate(prims, secs);
                var strpt1 = edge.StPt;
                var endpt1 = edge.EndPt;
                var strpt = new double[] { strpt1.X, strpt1.Y, strpt1.Z };
                var endpt = new double[] { endpt1.X, endpt1.Y, endpt1.Z };


                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }

            //var ldist = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Hor");

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            //veerti dime top sec datum
            string TotalHt = "";
            // top sec ht
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, TotalHt);



            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)100." + TotalHt);
            DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Plate", pointsinfo[Defination.SecTopLT], new Point3d(pointsinfo[Defination.SecTopLT].X - 1000, pointsinfo[Defination.SecTopLT].Y, 0));

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            ////////////////bot sec
            height = 2000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //secondary bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);


            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "8");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS9(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////prim supp
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }


            //////////////upper top sec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and sec sup
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);


                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);

            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            //////////////botsec
            height = 4000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLB], new Point3d(pointsinfo[Defination.SecTopLB].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLB].Y, pointsinfo[Defination.SecTopLB].Z), new Point3d(pointsinfo[Defination.SecTopLB].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLB].Y - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLB].Z), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLB].Z), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = pointsinfo[Defination.SecTopLB];
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLB].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLB].Y, pointsinfo[Defination.SecTopLB].Z);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLB].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLB].Y - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLB].Z);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLB].X - info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLB].Y - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLB].Z);
            //dimensioning

            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);


            /////////////draw plate  concrete
            height = 100;
            length = 3000;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                try
                {
                    sectionsize = Convert.ToDouble(CSECTIONSIZE(ListCentalSuppoData[i].ListConcreteData[0].Size));
                }
                catch (Exception)
                {

                }


                BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing, "pl", sectionsize: sectionsize);

                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString(), "HPP.(+)");

            }




            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "9");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }


        [Obsolete]
        public void DRS10(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            // InsertblockScale(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Primary_Elevation", centerX, centerY, 801.5625);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            ////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {
            }


            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Primary_Elevation", centerX, centerY, 801.5625);

                    info[Defination.Prim_Radius] = 801.5625;
                    info[Defination.Prim_ht] = 1.5 * 801.5625;


                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);
                }
            }
            catch (Exception)
            {

            }





            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //////////plate sec top
            double height = 100;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //plate
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //dimensioning
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {

                var prims = ListCentalSuppoData[i].ListPrimarySuppo[0];
                var secs = secsupp_des.ElementAt(0);
                var edge = GetEdgeforplate(prims, secs);
                var strpt1 = edge.StPt;
                var endpt1 = edge.EndPt;
                var strpt = new double[] { strpt1.X, strpt1.Y, strpt1.Z };
                var endpt = new double[] { endpt1.X, endpt1.Y, endpt1.Z };


                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //veerti dime top sec datum
            string TotalHt = "";
            // top sec ht
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            ////////////bot sec
            height = 2000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //secondary bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            /////////concrete support
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "10");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS11(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for taking whole figure up by 1000
            centerY += 1000;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //does not have primary support
            //var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);
            // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            double radius = 801.5625;
            info[Defination.Prim_Radius] = radius;
            info[Defination.Prim_ht] = radius * 1.5;
            //height of prim from bottom

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            /////////////top sec
            double height = 1000;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Hor").First().StPt;

            //    var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Hor").First().EndPt;

            //    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;

            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = GetDist(new Point3d(strpt), projectedpt);
            //    r_dist_frm_centre = GetDist(new Point3d(endpt), projectedpt);
            //}
            //catch (Exception)
            //{

            //}
            double horilength = 0;
            try
            {
                horilength = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), horilength.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            ///////////botsec
            height = 4000;
            length = 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.Left, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            /////////////concrete supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "11");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS13(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);



            //////////prim ht
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }



            ///////////////////ref block
            double height = 1500;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            try
            {
                CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), "hor");
            }
            catch (Exception)
            {

            }

            //ref block
            pointsextrainfo["RefLT"] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsextrainfo["RefRT"] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsextrainfo["RefRB"] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsextrainfo["RefLB"] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", pointsextrainfo["RefLT"], new Point3d(pointsextrainfo["RefLT"].X - 1500, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));


            //upper secondary supp
            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R");


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "13");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        public void DRS14(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            //double ht_frm_cen = 1220.7383;
            ////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);

            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            //mtext
            string TotalHt = "";

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT], new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //ref block
            pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - 2000, 0);
            pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y - 2000, 0);

            CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "14");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS15(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, radius, primsup_des.First());
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }



            /////////////////////topsec
            double height = 1000;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
                //r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 1000, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 1000, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "15");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS16(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, radius, primsup_des.First());
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }




            //////////////top sec
            double height = 1000;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
                //r_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000, centerY - info[Defination.Prim_ht], 0), pointsinfo[Defination.SecTopRT], MyCol.LightBlue);

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            //////////////////sec bot
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //////////////////conrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "16");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS17(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            //////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }


            /////////////////////top sec
            double height = 1000;
            double length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top];

            ///////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "17");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS18(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 1000;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());                //height of prim from bottom
                                                                                                                                                             // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }






            //upper top sec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //double ht_frm_cen = 1220.7383;0.33,0.66
            //upper top secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);


                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
                //r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }
            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());





            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            try
            {
                //TotalHt = MillimetersToMeters(Convert.ToDouble(TotalHt)).ToString();
            }
            catch (Exception)
            {

            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            //bot sec
            height = 5000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //botsec sec supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "r", 1700);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);



            //left side down secondary support
            height = 1000;
            length = 2500;
            extrainfo["sec_Left_Bot_L"] = length;
            extrainfo["sec_Left_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            //verti dimen left down
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(3).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), MyCol.LightBlue);

            //left side down primary support

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }


            if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
            {
                double radius = 801.5625;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5), radius, "l");
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

            }

            if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
            {
                double radius = 300;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius, primsup_des.ElementAt(2));
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius + 300, 0), clampname);

            }

            //left side down dimensioning hori
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(3).StPt;
                var endpt = secsupp_des.ElementAt(3).EndPt;
                var midpt = primsup_des.ElementAt(2).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
                //r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }
            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);

            //right side down secondary support
            height = 1000;
            length = 5000;
            extrainfo["sec_Right_Bot_L"] = length;
            extrainfo["sec_Right_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //verti dimen right up
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + 3500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), "TOS EL.(+)" + TotalHt);
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + 4000, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), MyCol.LightBlue);


            //right side down primary support
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            {
                double radius = 801.5625;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5), radius);
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

            }

            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            {
                double radius = 300;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 1.4 * radius, 0));

                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 300, 0), clampname);

            }

            //hori dimesnsioning right sec supp
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
                //r_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }
            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //draw plate/concrete support 
            height = 1000;
            length = 3000;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;


            //  BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);


            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS19(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }






            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //double ht_frm_cen = 1220.7383;0.33,0.66

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);


            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            CreateDimension(new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "l", -2000, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            //left side down secondary support
            height = 1000;
            length = 2500;
            extrainfo["sec_Left_Bot_L"] = length;
            extrainfo["sec_Left_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            //verti dimen secsupp
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            //left side down primary support

            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            {
                double radius = 300;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            }

            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            {
                double radius = 300;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius, primsup_des.ElementAt(1));
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            }

            //hori dimesion of left side down prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            //right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4000, 0), SecThick.HBoth, "R", sectionsize);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(3).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], TotalHt);

            //right side upper primary support

            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }

            if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
            {
                double radius = 600;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (radius * 1.5), radius);
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + 1000, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            }

            if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
            {
                double radius = 400;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, radius, primsup_des.ElementAt(2));
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 300, 0), clampname);

            }

            //right side upper primary hori dimen of prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(3).StPt;
                var endpt = secsupp_des.ElementAt(3).EndPt;
                var midpt = primsup_des.ElementAt(2).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);



            //right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(4).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HBoth, "R", sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(4).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(3));
                }
            }
            catch (Exception)
            {

            }
            if (primsup_des.ElementAt(3).SupportName.ToLower().Contains("nb"))
            {
                double radius = 600;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            }

            if (primsup_des.ElementAt(3).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(3).SupportName.ToLower().Contains("brac"))
            {
                double radius = 400;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(3));
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
            }

            //hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(4).StPt;
                var endpt = secsupp_des.ElementAt(4).EndPt;
                var midpt = primsup_des.ElementAt(3).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);


            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS20(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;


            centerY += 1500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);


            double radius = 801.5625;
            info[Defination.Prim_Radius] = radius;
            info[Defination.Prim_ht] = radius * 1.5;

            //top sec left
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66var sectionsize = 0.0;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);


            //dimensioning
            // CreateDimension(new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));
            // CreateDimension(new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }



            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 5000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -3500);



            //left side down secondary support
            height = 1000;
            length = 4500;
            extrainfo["sec_Left_Bot_L"] = length;
            extrainfo["sec_Left_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500, 0), SecThick.HidTop, "l", sectionsize: sectionsize);

            //ht dimen
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], TotalHt, "l");

            //left side down primary support

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }


            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            {
                radius = 801.5625;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5), radius, "l");
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 1500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

            }

            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            {
                radius = 200;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius + 300, 0), clampname);

            }

            //dimen hori left side down prim n sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), r_dist_frm_centre.ToString(), 200);


            //right side down secondary support
            height = 1000;
            length = 3000;
            extrainfo["sec_Right_Bot_L"] = length;
            extrainfo["sec_Right_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //ht dimen
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], TotalHt, "r");


            //right side down primary support

            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    radius = 801.5625;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] + 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }





            //dimens  hori right side prim n sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ////draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);


            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS21(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //does not have primary support

            // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            double radius = 801.5625;
            info[Defination.Prim_Radius] = radius;
            info[Defination.Prim_ht] = radius * 1.5;
            //height of prim from bottom

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            double height = 1000;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.Top, "RL", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            double horilength = 0;
            try
            {
                horilength = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], horilength.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            //ht dimen
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            //botsec
            height = 4000;
            length = 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 400, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 400, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.HidRight, "ll", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //concrete plate
            height = 300;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            //FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            //plate
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_bot], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_bot], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_bot] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_bot] - height, 0), SecThick.Nothing, "pl");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS22(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            //upper top secondary supp 
            double height = 1000;
            double length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            //bot sec
            height = 3000;
            length = 1000;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", 1000, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 500);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;


            //right secondary support

            //right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Bot_L"] = length;
            extrainfo["sec_Right_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"], TotalHt);


            //right side down primary support

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            {
                double radius = 801.5625;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5), radius);
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

            }

            else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            {
                double radius = 400;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius + 1.4 * radius, 0));
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + radius + 300, 0), clampname);

            }
            //hori dimen right side down primary n sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            //concrete support
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS23(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, radius, primsup_des.First());

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 3500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                }
            }
            catch (Exception)
            {

            }





            //topsec
            double height = 300;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.Nothing, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            //botsec left
            height = 3000;
            length = 300;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y - height, 0), SecThick.Nothing, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 - length, pointsinfo[Defination.SecTopLT].Y - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS24(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            {
                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            }

            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            {
                double radius = 500;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            }


            double height = 800;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round((secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            //bot sec
            height = 3000;
            length = 1000;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + info[Defination.Sec_top_b] - 200, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + info[Defination.Sec_top_b] - 200, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS25(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2000;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }



            }
            catch (Exception)
            {

            }



            //upper top sec supp
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);


            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).EndPt);
                var midpt = Get3dAbsoluteValues(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);



            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            //bot sec supp
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height + 700;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "nbl", sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -1000);


            //draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pr", sectionsize: sectionsize);


            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                //height = 1000;
                //length = 3000;
                //info[Defination.Concrete_l] = length;
                //info[Defination.Concrete_b] = height;

                //concrete down
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);
            }
            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2, centerY, height, length, i);

            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS26(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());


                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }






            //upper top sec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            //hori dimen prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).EndPt);
                var midpt = Get3dAbsoluteValues(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }
            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "BOP(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            //bot sec
            height = 4000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height + 700;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - 500, pointsinfo[Defination.SecTopLT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLT].Y + 500, pointsinfo[Defination.SecTopLT].Z), new Point3d(pointsinfo[Defination.SecTopLT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLT].Y + 500 - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLT].Z), new Point3d(pointsinfo[Defination.SecTopLT].X - 500, pointsinfo[Defination.SecTopLT].Y + 500 - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLT].Z), SecThick.VBoth, "nbl", -1000, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X - 500, pointsinfo[Defination.SecTopLT].Y + 500, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLT].Y + 500, pointsinfo[Defination.SecTopLT].Z);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopLT].Y + 500 - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLT].Z);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X - 500, pointsinfo[Defination.SecTopLT].Y + 500 - info[Defination.Sec_bot_b], pointsinfo[Defination.SecTopLT].Z);
            //dimensioning

            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 500);


            //draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pl", sectionsize: sectionsize);


            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                //concrete supp
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);
            }
            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2, centerY, height, length, i);

            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }


        [Obsolete]
        public void DRS27(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, radius, primsup_des.First());
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 3500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 3500, centerY + 300, 0), clampname);

                }
                //left prim supp
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 801.5625, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }




            //left side top sec
            double height = 1000;
            double length = 3500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l");

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //here line is drawn to split on sec supp into two


            //dimension hori both prim sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 2200, centerY, radius, primsup_des.First());


                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 2200 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

                }
                //right prim supp
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 2200, centerY, 801.5625);


                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }




            //right side top sec

            height = 1000;
            length = 3500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R");

            ////info for future
            //pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            //pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //here line is drawn to split on sec supp into two


            //dimension hori both prim sec
            //dimensioning
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);



            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            //bot sec
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1500, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1500, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.Left, "nbl");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1500, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1500, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);




            //draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pr", sectionsize: sectionsize);


            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                //concrete supp
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);

            }
            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            //}


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS28(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            //top sec
            double height = 1000;
            double length = 2000;
            info[Defination.Sec_top_l] = length;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            info[Defination.Sec_top_b] = height;



            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //dimensioning
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(0).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(0).EndPt);
                var midpt = Get3dAbsoluteValues(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, TotalHt);

            //upper plate
            height = 200;
            length = 1500;
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.Nothing, "pl", sectionsize: sectionsize);


            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height + 200; //plus 200 for plate
            //bot sec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "nbl");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                //concrete
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);


                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);
                //height = 1000;
                //length = 3000;
                //info[Defination.Concrete_l] = length;
                //info[Defination.Concrete_b] = height;

                //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
                //{
                //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

                //}

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS29(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2000;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);
            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            double radius = 801.5625;
            info[Defination.Prim_Radius] = radius;
            info[Defination.Prim_ht] = radius * 1.5;

            //upper top sec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66
            //upper top secondary supp
            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R");


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            //bot sec
            height = 5000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //botsec sec supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "nbl", 1700, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRB].X - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRB].X - info[Defination.Sec_bot_l] - 500, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            //upper plate//upper plate
            height = 200;
            length = 1500;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotLT].Y + height, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotLT].Y + height, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "none");


            //left side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Left_Bot_L"] = length;
            extrainfo["sec_Left_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            //verti dimen sec left down
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(3).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], TotalHt, "l");



            //left side down primary support

            //verti dimes prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius, primsup_des.First());

                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    radius = 801.5625;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5), radius, "l");
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

                }


            }
            catch (Exception)
            {

            }


            //left side down dimensioning hori
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(3).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(3).EndPt);
                var midpt = Get3dAbsoluteValues(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }
            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);

            //right side up secondary support
            height = 1000;
            length = 5000;
            extrainfo["sec_Right_Bot_L"] = length;
            extrainfo["sec_Right_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4500, 0), SecThick.HBoth, "R");

            //verti dimen sec ht right up
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4500 + extrainfo["sec_Right_Bot_B"], TotalHt, "l");


            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);


            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);


                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);
                //height = 1000;
                //length = 3000;
                //info[Defination.Concrete_l] = length;
                //info[Defination.Concrete_b] = height;

                //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
                //{
                //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
                //}
            }
            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, SupType);

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS30(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            /////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            //top sec endpt
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius, 500, -Math.PI / 2, new Point3d(centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3000 * 0.34 + 2000 + 200 + 3000, centerY - info[Defination.Prim_ht] - radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius - 100, 0), new Point3d(centerX + 3000 * 0.34 + 2000 + 200 + 3000, centerY - info[Defination.Prim_ht] - radius - 100, 0), MyCol.LightBlue);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Front_Primary_Elevation", centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius, radius, primsup_des.First());


                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius, 500, -Math.PI / 2, new Point3d(centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3000 * 0.34 + 2000 + 200 + 3000, centerY - info[Defination.Prim_ht] - radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3000 * 0.34 + 2000 + 200, centerY - info[Defination.Prim_ht] - radius - 100, 0), new Point3d(centerX + 3000 * 0.34 + 2000 + 200 + 3000, centerY - info[Defination.Prim_ht] - radius - 100, 0), MyCol.LightBlue);

                }

            }
            catch (Exception)
            {

            }


            //////////////////upper sec right
            double height = 1000;
            double length = 3000;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 2000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66 + 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 2000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66 + 2000, centerY - info[Defination.Prim_ht] - height, 0);

            //double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().StPt;

            //    var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().EndPt;

            //    // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
            //    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            //}
            //catch (Exception)
            //{

            //}


            ////dimensioning
            //CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            //CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 - 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round((secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            ////////////////////right plate connected to top sec 
            height = 2000;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X, (pointsinfo[Defination.SecTopRT].Y + pointsinfo[Defination.SecTopRB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + length, (pointsinfo[Defination.SecTopRT].Y + pointsinfo[Defination.SecTopRB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + length, (pointsinfo[Defination.SecTopRT].Y + pointsinfo[Defination.SecTopRB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopRT].X, (pointsinfo[Defination.SecTopRT].Y + pointsinfo[Defination.SecTopRB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 1000, sectionsize);

            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecTopRT].X + length, (pointsinfo[Defination.SecTopRT].Y + pointsinfo[Defination.SecTopRB].Y) / 2 + height / 2, 0);
            pointsextrainfo["RB"] = new Point3d(pointsinfo[Defination.SecTopRT].X + length, (pointsinfo[Defination.SecTopRT].Y + pointsinfo[Defination.SecTopRB].Y) / 2 - height / 2, 0);


            //hori dimen with plate and prim sup
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;

                var endpt = secsupp_des.ElementAt(1).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX + 3000 * 0.34 + 2000 + 200 + 1800, centerY - info[Defination.Prim_ht] - info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 700, text_pos_rotation: -Math.PI / 2);
            CreateDimension(pointsextrainfo["RB"], new Point3d(centerX + 3000 * 0.34 + 2000 + 200 + 1800, centerY - info[Defination.Prim_ht] - info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 700, text_pos_rotation: -Math.PI / 2);



            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////bot sec supp
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 2000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] + 2000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "R", sectionsize);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), botsec, 1000);

            //////////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "30");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }


        [Obsolete]
        public void DRS31(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());

                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


                }
            }
            catch (Exception)
            {

            }



            //double ht_frm_cen = 1220.7383;

            /////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////slant sec sup
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {

                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");



            ////////////////bot secondary support
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = height + 500;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height, 0), SecThick.VBoth, "L", sectionsize: sectionsize);

            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 3000);

            ///////////////////////concret supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "31");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS32(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 2500;
            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }


            ////////////sec top
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }
            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            ///////////////////bot sec
            height = 5000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);


            /////////////////front side view of  sec view
            height = 1000;
            length = 500;

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotRT].Y - 2500 - 500, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotRT].Y - 2500 - 500, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotRT].Y - 2500 - 500 - height, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotRT].Y - 2500 - 500 - height, 0), SecThick.Nothing, "l", -2000, sectionsize: sectionsize);


            ///////////////front side view of prim and plate view
            height = 2000;
            length = 1200;

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotRT].Y - 2500, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotRT].Y - 2500, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotRT].Y - 2500 - height, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotRT].Y - 2500 - height, 0), SecThick.Nothing, "l", -2000, sectionsize: sectionsize);



            /////////////////concrete support
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            /////////////////////////////////////////////
            ///////////////////////////////////////
            ////////////side view detailing starts from here
            centerY = spaceY - upperYgap - 80.1563;
            centerX = tracex + 3 * boxlen / 4;

            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    double radius = 801.5625;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = 1.4 * radius;
                    length = 200;
                    BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY - 1.4 * radius, 0), new Point3d(centerX - length / 2, centerY - 1.4 * radius, 0), SecThick.HBoth, "R", 0, sectionsize);

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY + 80.1563, radius);

                    //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY + 80.1563 - 100, 0), "CL.EL.(+)" + prim_height);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 801.5625;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = 1.4 * radius;
                    length = 200;
                    BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY - 1.4 * radius, 0), new Point3d(centerX - length / 2, centerY - 1.4 * radius, 0), SecThick.HBoth, "R", 0, sectionsize);

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY + 80.1563, radius);

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                    //double radius = 500;
                    //info[Defination.Prim_Radius] = radius;
                    //info[Defination.Prim_ht] = radius;

                    ////CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY + radius, 0), new Point3d(centerX + length / 2, centerY + radius, 0), new Point3d(centerX + length / 2, centerY - 1.4 * radius, 0), new Point3d(centerX - length / 2, centerY - 1.4 * radius, 0), SecThick.Nothing, "R", 0, sectionsize);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    double radius = 801.5625;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = 1.4 * radius;
                    length = 200;
                    BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY - 1.4 * radius, 0), new Point3d(centerX - length / 2, centerY - 1.4 * radius, 0), SecThick.HBoth, "R", 0, sectionsize);

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY + 80.1563, radius);

                }

            }
            catch (Exception)
            {

            }

            /////////////////sec top
            height = 1000;
            length = 300;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.Nothing, "R", 0, sectionsize);

            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX, centerY - info[Defination.Prim_ht], 1000);



            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            // l_dist_frm_centre = 0;
            // r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().StPt;

            //    var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().EndPt;

            //    // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
            //    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            //}
            //catch (Exception)
            //{

            //}


            ////double strtmiddist=GetDist(ldist)

            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            //CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());



            // vertical dimensioning
            TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            //shown in front view
            //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            info[Defination.Sec_ht_top] = info[Defination.Prim_ht];// + height;
            ///////////////bot sec
            height = 5000;
            length = 300;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.Nothing, "none");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);


            //shown in front view
            //dimensioning
            //botsec = "";
            //try
            //{
            //    botsec = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);


            ////////////// side view of  sec view
            height = 1000;
            length = 3000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X, pointsinfo[Defination.SecBotRT].Y - 2500, 0), new Point3d(pointsinfo[Defination.SecBotRT].X + length, pointsinfo[Defination.SecBotRT].Y - 2500, 0), new Point3d(pointsinfo[Defination.SecBotRT].X + length, pointsinfo[Defination.SecBotRT].Y - 2500 - height, 0), new Point3d(pointsinfo[Defination.SecBotRT].X, pointsinfo[Defination.SecBotRT].Y - 2500 - height, 0), SecThick.HBoth, "l", -2000, sectionsize: sectionsize);

            pointsextrainfo["SRT"] = new Point3d(pointsinfo[Defination.SecBotRT].X + length, pointsinfo[Defination.SecBotRT].Y - 2500, 0);
            pointsextrainfo["SRB"] = new Point3d(pointsinfo[Defination.SecBotRT].X + length, pointsinfo[Defination.SecBotRT].Y - 2500 - height, 0);

            TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt, "l");

            //////////////side view of prim and plate view
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["SRT"].X, (pointsextrainfo["SRT"].Y + pointsextrainfo["SRB"].Y) / 2 + height / 2, 0), new Point3d(pointsextrainfo["SRT"].X + length, (pointsextrainfo["SRT"].Y + pointsextrainfo["SRB"].Y) / 2 + height / 2, 0), new Point3d(pointsextrainfo["SRT"].X + length, (pointsextrainfo["SRT"].Y + pointsextrainfo["SRB"].Y) / 2 - height / 2, 0), new Point3d(pointsextrainfo["SRT"].X, (pointsextrainfo["SRT"].Y + pointsextrainfo["SRB"].Y) / 2 - height / 2, 0), SecThick.Nothing, "l", 750, sectionsize: sectionsize);

            pointsextrainfo["RT"] = new Point3d(pointsextrainfo["SRT"].X + length, (pointsextrainfo["SRT"].Y + pointsextrainfo["SRB"].Y) / 2 + height / 2, 0);
            pointsextrainfo["RB"] = new Point3d(pointsextrainfo["SRT"].X + length, (pointsextrainfo["SRT"].Y + pointsextrainfo["SRB"].Y) / 2 - height / 2, 0);


            /////////////////primary side view

            if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            {
                //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                double radius = 500;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", pointsextrainfo["RT"].X, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 500, -Math.PI / 2, new Point3d(pointsextrainfo["RT"].X, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 0));
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["RT"].X + 1500, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2 - 100, 0), "CL.EL.(+)" + prim_height);


            }

            else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            {
                double radius = 500;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", pointsextrainfo["RT"].X, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 500, -Math.PI / 2, new Point3d(pointsextrainfo["RT"].X, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 0));
                //CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.ElementAt(1));

                // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["RT"].X + 1500, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2 - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["RT"].X, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 0), new Point3d(pointsextrainfo["RT"].X + 2000, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["RT"].X + 2000, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2 + 300, 0), clampname);

            }



            //hori dimen side plate and prim
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(2).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(2).EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsextrainfo["RT"].X + 1800, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 0), l_dist_frm_centre.ToString(), 300, -Math.PI / 2);
            CreateDimension(pointsextrainfo["RB"], new Point3d(pointsextrainfo["RT"].X + 1800, (pointsextrainfo["RT"].Y + pointsextrainfo["RB"].Y) / 2, 0), r_dist_frm_centre.ToString(), 300, -Math.PI / 2);





            /////////////////////concrete support
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "32");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }


        [Obsolete]
        public void DRS33(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2000;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Boundingboxmax.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                //prim supp left side left most
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1500, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1500, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1500, centerY, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1500, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }
            }
            catch (Exception)
            {

            }


            //////////////////prim supp left side right most
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                //prim supp left side right most
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                }

            }
            catch (Exception)
            {

            }



            //upper top sec supp
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht] - height, 0);


            double l_dist_frm_centre = 0;
            double mid_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning hori prim top sec
            try
            {
                var strpt1 = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).StPt);
                var endpt1 = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).EndPt);
                var midpt1 = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                var midpt2 = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);


                var strpt = FindClosestPoint(strpt1, endpt1, midpt1);
                double[] endpt;
                var dist1 = 0.0;
                var dist2 = 0.0;
                var dist3 = 0.0;
                if (strpt == strpt1)
                {
                    endpt = endpt1;
                    Point3d projectedpt1 = FindPerpendicularFoot(midpt1, strpt, endpt);
                    Point3d projectedpt2 = FindPerpendicularFoot(midpt2, strpt, endpt);

                    dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt1));
                    dist2 = Math.Round(GetDist(projectedpt1, projectedpt2));
                    dist3 = Math.Round(GetDist(projectedpt2, new Point3d(endpt)));
                }
                else
                {
                    endpt = strpt1;
                    Point3d projectedpt1 = FindPerpendicularFoot(midpt1, strpt, endpt);
                    Point3d projectedpt2 = FindPerpendicularFoot(midpt2, strpt, endpt);

                    dist1 = Math.Round(GetDist(new Point3d(endpt), projectedpt1));
                    dist2 = Math.Round(GetDist(projectedpt1, projectedpt2));
                    dist3 = Math.Round(GetDist(projectedpt2, new Point3d(strpt)));
                }

                l_dist_frm_centre = dist1;
                mid_dist_frm_centre = dist2;
                r_dist_frm_centre = dist3;
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 1500, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(new Point3d(centerX - 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), mid_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);


            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            ////////////////bot sec supp
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height + 700;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "nbl", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -1000);


            //////////////draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pr", sectionsize: sectionsize);



            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            ////////////////////concrete
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                //concrete down
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);
            }
            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2, centerY, height, length, i);

            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "33");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS34(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            //////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }

            //////////////////topsec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////bot sec
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            ////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "34");



            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS35(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, radius, primsup_des.First());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }


            //////////////////top sec
            double height = 300;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HidTop, "rl", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(0).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(0).EndPt);
                var midpt = Get3dAbsoluteValues(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid);

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }
            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            //height = 3000;
            //length = 300;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y - height, 0), SecThick.Nothing, "l");

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y, 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y, 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y - height, 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 - length, pointsinfo[Defination.SecTopLT].Y - height, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            //info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "35");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS36(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            ////////////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }


            //////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //double ht_frm_cen = 1220.7383;0.33,0.66

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
                r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////////bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "l", -2000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);



            ////left side down secondary support
            //height = 1000;
            //length = 2500;
            //extrainfo["sec_Left_Bot_L"] = length;
            //extrainfo["sec_Left_Bot_B"] = height;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            ////verti dimen secsupp
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            ////left side down primary support

            ////verti dimen prim ht
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 300;

            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            //}

            ////hori dimesion of left side down prim and sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(1).StPt;
            //    var endpt = secsupp_des.ElementAt(1).EndPt;
            //    var midpt = primsup_des.ElementAt(1).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            /////////////right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4000, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], TotalHt);

            //right side upper primary support

            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 4000 + extrainfo["sec_Right_Upper_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);



            ///////////////////right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(3).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(2));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            /////////////////////hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(3).StPt;
                var endpt = secsupp_des.ElementAt(3).EndPt;
                var midpt = primsup_des.ElementAt(2).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            /////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "36");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS37(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            //////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, radius, primsup_des.First());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX + 1000, centerY + 1.4 * radius, 0), new Point3d(centerX + 1000 - 4 * radius, centerY + 1.4 * radius, 0));

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 3500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);


                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }


            ///////////////upper top sec
            double height = 300;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HidTop, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(2).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(2).EndPt);
                var midpt = Get3dAbsoluteValues(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid);

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ////////////left upper top sec
            height = 3000;
            length = 300;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }
            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y + height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), SecThick.HidRight, "l", 0, sectionsize);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(0).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y + height, 0), botsec, 500);


            ////////////////right upper top sec
            height = 3000;
            length = 300;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y + height, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + length, pointsinfo[Defination.SecTopRT].Y + height, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + length, pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0), SecThick.HidLeft, "r", 1000, sectionsize);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(0).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y + height, 0), botsec, -200);



            //TotalHt = "";
            ////mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);


            //height = 3000;
            //length = 300;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y - height, 0), SecThick.Nothing, "l");

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500, pointsinfo[Defination.SecTopLT].Y, 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y, 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 + length, pointsinfo[Defination.SecTopLT].Y - height, 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X + 1500 - length, pointsinfo[Defination.SecTopLT].Y - height, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            //info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "37");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS38(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, radius, primsup_des.First());
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX + 1000, centerY + 1.4 * radius, 0), new Point3d(centerX + 1000 - 4 * radius, centerY + 1.4 * radius, 0));


                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 801.5625);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }


            //////////////////top sec
            double height = 1000;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HidTop, "LR", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
                r_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000, centerY - info[Defination.Prim_ht], 0), pointsinfo[Defination.SecTopRT], MyCol.LightBlue);

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////sec bot
            height = 3000;
            length = 1000;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //secbot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////downside plate
            height = 200;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                try
                {
                    sectionsize = Convert.ToDouble(CSECTIONSIZE(ListCentalSuppoData[i].ListConcreteData[0].Size));
                }
                catch (Exception)
                {

                }

                BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - info[Defination.Concrete_l] / 2, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 + info[Defination.Concrete_l] / 2, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 + info[Defination.Concrete_l] / 2, pointsinfo[Defination.SecBotRB].Y - info[Defination.Concrete_b], 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - info[Defination.Concrete_l] / 2, pointsinfo[Defination.SecBotRB].Y - info[Defination.Concrete_b], 0), SecThick.Nothing, "pl", -2000, sectionsize: sectionsize);
            }

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "38");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS39(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            ///////////front view
            double upperYgap = 3500;
            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            centerY -= 2000;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);

            double radius;

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_With_V_ANGLE", centerX, centerY, 1000);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_With_V_ANGLE", centerX, centerY, 1000);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, radius, primsup_des.First());
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //  string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_With_V_ANGLE", centerX, centerY, 1000);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            ////////////ref block
            double height = 1500;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            try
            {
                CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - height, 0), new Point3d(centerX - length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY - height, 0), "hor");
            }
            catch (Exception)
            {

            }

            //ref block
            pointsextrainfo["RefLT"] = new Point3d(centerX - length / 2, centerY - height, 0);
            pointsextrainfo["RefRT"] = new Point3d(centerX - length / 2, centerY, 0);
            pointsextrainfo["RefRB"] = new Point3d(centerX + length / 2, centerY, 0);
            pointsextrainfo["RefLB"] = new Point3d(centerX + length / 2, centerY - height, 0);

            DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", pointsextrainfo["RefLT"], new Point3d(pointsextrainfo["RefLT"].X - 1500, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));


            //upper secondary supp
            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R");


            ///////////////////////////
            ////////////////////////
            /////////////////side view starts here
            centerX = tracex + (3 * boxlen) / 4;
            centerY = spaceY - upperYgap;
            centerY -= 2000;


            //////////////prim side view block
            //added 850  for distance
            //prim ht
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY + 1.1945 * 1000, 712);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY + 1.1945 * 1000 - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY + 1.1945 * 1000 + 300, 0), ListCentalSuppoData[0].ListPrimarySuppo[0].SupportName);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY + 1.1945 * 1000, 712);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY + 1.1945 * 1000 - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY + 1.1945 * 1000 + 300, 0), ListCentalSuppoData[0].ListPrimarySuppo[0].SupportName);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY + 1.1945 * 1000, 712);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY + 1.1945 * 1000 - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY + 1.1945 * 1000 + 300, 0), ListCentalSuppoData[0].ListPrimarySuppo[0].SupportName);
                }
            }
            catch (Exception)
            {

            }


            ///////////secodry sup side view
            radius = 500;
            length = 4000;
            height = 1000;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(ListCentalSuppoData[i].ListSecondrySuppo[0].Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY + height, 0), new Point3d(centerX + length / 2, centerY + height, 0), new Point3d(centerX + length / 2, centerY, 0), new Point3d(centerX - length / 2, centerY, 0), SecThick.HidBottom, "LR", sectionsize: sectionsize);
            pointsextrainfo["LT"] = new Point3d(centerX - length / 2, centerY + height, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length / 2, centerY + height, 0);

            //vertical ht from datum
            string TotalHt = "";
            //mtext
            //sec ht
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(ListCentalSuppoData[i].ListSecondrySuppo[0].Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l");

            //////////////prim side view block
            centerY += 2.7 * radius;
            height = radius;
            length = 200;
            //  BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY, 0), new Point3d(centerX + length / 2, centerY - height, 0), new Point3d(centerX - length / 2, centerY - height, 0), SecThick.HidBottom);

            //dimenesiong hori prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().StPt;

                var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsextrainfo["LT"], new Point3d(centerX, centerY + 850, 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX, centerY + 850, 0), r_dist_frm_centre.ToString());

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "39");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS40(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 1500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            double radius = 801.5625;
            info[Defination.Prim_Radius] = radius;
            info[Defination.Prim_ht] = radius * 1.5;

            //////////////////top sec left top
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66var sectionsize = 0.0;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);


            //dimensioning
            // CreateDimension(new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));
            // CreateDimension(new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////bot sec
            height = 5000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Prim_ht] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "l", 1200, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -3500);



            //////////////left side down secondary support
            height = 1000;
            length = 4500;
            extrainfo["sec_Left_Bot_L"] = length;
            extrainfo["sec_Left_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500, 0), SecThick.HidTop, "ll", sectionsize: sectionsize);


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], TotalHt, "l");


            /////////////////left side down primary support
            prim_height = "";
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    //height of prim from bottom

                    prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
                }

                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
                }
            }
            catch (Exception)
            {

            }

            try
            {

                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    radius = 400;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5), radius, "l");
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 1500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    radius = 400;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5), radius, "l");
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 1500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }



            //dimen hori left side down prim n sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ///////////////right side down secondary support
            height = 1000;
            length = 3000;
            extrainfo["sec_Right_Bot_L"] = length;
            extrainfo["sec_Right_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X - 1500, pointsinfo[Defination.SecBotRB].Y + 1500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], TotalHt);


            //////////////////////right side down primary support
            prim_height = "";
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    //height of prim from bottom

                    prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
                }

                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
                }
            }
            catch (Exception)
            {

            }

            //////////////////right side down primary support
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    radius = 801.5625;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + radius + 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    radius = 801.5625;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 + radius + 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());
                }
            }
            catch (Exception)
            {

            }


            //dimens  hori right side prim n sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ////draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            ////////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "40");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS41(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            centerY += 1500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);



            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            double radius = 801.5625;
            info[Defination.Prim_Radius] = radius;
            info[Defination.Prim_ht] = radius * 1.5;

            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66var sectionsize = 0.0;
            var sectionsize = 0.0;
            try
            {
                var section = secsupp_des.ElementAt(0).Size;

                sectionsize = Convert.ToDouble(CSECTIONSIZE(section));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);


            //dimensioning
            // CreateDimension(new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));
            // CreateDimension(new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {

                if (ListCentalSuppoData[i].ListConcreteData.Count > 1)
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z > ListCentalSuppoData[i].ListConcreteData[1].BoxData.Z
                    ? Math.Round((ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z + ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Hor").First().BoxData.Z + ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z), 2).ToString()
                    : Math.Round((ListCentalSuppoData[i].ListConcreteData[1].BoxData.Z + ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Hor").First().BoxData.Z + ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z), 2).ToString();
                }
                else
                {
                    TotalHt = Math.Round((ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z + ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().BoxData.Z + ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "ver").First().BoxData.Z), 2).ToString();
                }


            }
            catch (Exception)
            {

            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 5000;
            length = 500;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height;

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), SecThick.Nothing, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -3500);



            //left side down secondary support
            height = 1000;
            length = 4500;
            extrainfo["sec_Left_Bot_L"] = length;
            extrainfo["sec_Left_Bot_B"] = height;

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500, 0), SecThick.HidTop, "l");


            //left side down primary support
            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            {
                radius = 801.5625;

                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5), radius, "l");
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 1500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

            }

            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            {
                radius = 200;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius);
                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius, primsup_des.First());
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius + 300, 0), clampname);

            }

            //dimen hori left side down prim n sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), r_dist_frm_centre.ToString(), 200);


            //right side down secondary support
            height = 1000;
            length = 3000;
            extrainfo["sec_Right_Bot_L"] = length;
            extrainfo["sec_Right_Bot_B"] = height;


            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500, 0), SecThick.HBoth, "R");

            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotRB].X - 250, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 1000);

            //right side down primary support
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", pointsinfo[Defination.SecBotRB].X - 250, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                    ////height of prim from bottom
                    //// CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //// string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //// DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    radius = 801.5625;
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", pointsinfo[Defination.SecBotRB].X - 250, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] + 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }





            //dimens  hori right side prim n sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ////draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);


            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //////////////////////////////////
            //////////////////////////////////
            //////////////////side view starts from here
            centerX = tracex + (3 * boxlen) / 4;  // 9869.9480;
            centerY = spaceY - upperYgap;

            centerY += 1500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            // var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            // var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").OrderByDescending(e => e.Boundingboxmax.Z);

            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            radius = 801.5625;
            info[Defination.Prim_Radius] = radius;
            info[Defination.Prim_ht] = radius * 1.5;

            //top sec
            height = 1000;
            length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66var sectionsize = 0.0;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "l", 0, sectionsize);

            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX - length * 0.34, centerY - info[Defination.Prim_ht], 1000);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);


            //dimensioning
            // CreateDimension(new Point3d(centerX - length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));
            // CreateDimension(new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0));


            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            // TotalHt = "";

            ////mtext
            //try
            //{

            //}
            //catch (Exception)
            //{

            //}

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 5000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height;

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            botsec = "";
            try
            {
                botsec = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -3500);



            //left side down secondary support
            height = 1000;
            length = 4500;
            extrainfo["sec_Left_Bot_L"] = length;
            extrainfo["sec_Left_Bot_B"] = height;

            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500, 0), SecThick.HidTop, "l");
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 1000);

            //left side down primary support
            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            {
                radius = 801.5625;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;
                //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5), radius, "l");
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius);
                //height of prim from bottom
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 1500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);

            }

            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            {
                radius = 200;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, radius);
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius, 0), MyCol.LightBlue);
                string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + radius + 300, 0), clampname);

            }

            //dimen hori left side down prim n sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 500 + extrainfo["sec_Left_Bot_B"], 0), r_dist_frm_centre.ToString(), 200);


            //right side down secondary support
            height = 1000;
            length = 3000;
            extrainfo["sec_Right_Bot_L"] = length;
            extrainfo["sec_Right_Bot_B"] = height;


            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500, 0), SecThick.HBoth, "R");

            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotRB].X - 250, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 1000);

            //right side down primary support
            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            {
                radius = 801.5625;
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", pointsinfo[Defination.SecBotRB].X - 250, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5), radius);
                //height of prim from bottom
                // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] + 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            }

            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            {
                radius = 500;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", pointsinfo[Defination.SecBotRB].X - 250, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, radius);
                ////height of prim from bottom
                //// CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                //// string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                //// DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 1.4 * radius, 0));

                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius, 0), MyCol.LightBlue);
                //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + radius + 300, 0), clampname);

            }


            //dimens  hori right side prim n sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 1500 + extrainfo["sec_Right_Bot_B"] + (radius * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ////draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);


            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "41");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }


        [Obsolete]
        public void DRS42(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);


            ////////////////////////////side view starts from here
            ///////////////////////////
            /////////////////////////
            //////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            double radius = 0.0;
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY - radius + 0.2 * 1000, radius);


                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - radius + 0.2 * 1000 + 300, 0), clampname);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - radius + 0.2 * 1000, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - radius + 0.2 * 1000, 0), MyCol.LightBlue);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - radius + 0.2 * 1000 - 100, 0), "CL.EL.(+)" + prim_height);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", centerX, centerY - radius + 0.2 * 1000, radius);
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));


                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - radius + 0.2 * 1000 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - radius + 0.2 * 1000, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - radius + 0.2 * 1000, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - radius + 0.2 * 1000 + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Side_View", centerX, centerY - radius + 0.2 * 1000, radius);


                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - radius + 0.2 * 1000 + 300, 0), clampname);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - radius + 0.2 * 1000, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - radius + 0.2 * 1000, 0), MyCol.LightBlue);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - radius + 0.2 * 1000 - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }


            /////////////////////////top sec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HidBottom, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - 625 + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - 625 + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());



            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");
            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht], 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 - 2000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////////////sec bot
            height = 3000;
            length = 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.Right, "l", 1000, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 300);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            /////////////////side view angle section side o long angle section
            radius = 1000;
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Angle_Secondary", pointsinfo[Defination.SecBotRT].X, pointsinfo[Defination.SecBotRT].Y, radius);


            ///////////////
            //////////////
            /////////////
            ////////front view starts from here
            centerX = tracex + (3 * boxlen) / 4;  // 9869.9480;
            centerY = spaceY - upperYgap;
            centerY -= 500;

            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }
            radius = 0.0;

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    radius = 1000;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_With_V_ANGLE", centerX, centerY - 1000, radius);

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    radius = 1000;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_With_V_ANGLE", centerX, centerY - 1000, radius);
                    //height of prim from bottom

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    radius = 1000;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_With_V_ANGLE", centerX, centerY - 1000, radius);

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }


            //////////////////top sec
            height = 1000;
            length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //lsection side view sec
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.Top, "RL", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().StPt;

            //    var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().EndPt;

            //    // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
            //    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            //}
            //catch (Exception)
            //{

            //}


            //double strtmiddist=GetDist(ldist)

            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            //CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht];

            height = 3000;
            length = 300;

            ////////////////sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.Left, "ll");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2 - 1000, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            //botsec = "";
            //try
            //{
            //    botsec = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //side view angle section side o long angle section
            //radius = 1000;
            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Angle_Secondary", pointsinfo[Defination.SecBotRT].X, pointsinfo[Defination.SecBotRT].Y, radius);



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "42");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS43(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //////////////prim sup
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY + 200, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY + 200 - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY + 200, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY + 200, radius, primsup_des.First());
                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 200 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY + 200, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY + 200, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 200 + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY + 200, 801.5625);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY + 200 - 100, 0), "CL.EL.(+)" + prim_height);
                }
            }
            catch (Exception)
            {

            }



            /////////////plate below prim supp
            double height = 200;
            double length = 1000;
            //double ht_frm_cen = 1220.7383;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] + height, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] + height, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), SecThick.Nothing, "pl", 0, sectionsize);

            /////////////topsec
            height = 1000;
            length = 4000;
            //double ht_frm_cen = 1220.7383;

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R");

            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0);


            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////////bot sec
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66 - 700, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length - 700, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length - 700, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66 - 700, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - height * 0.66 - 700, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - height * 0.66 + length - 700, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - height * 0.66 + length - 700, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - height * 0.66 - 700, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);


            ///////////////side view prim middle one
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotRT].X, pointsinfo[Defination.SecBotRT].Y, 1000);


            ///////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2 - 700, centerY, height, length, i);
            }


            /////////////////////////////////
            //////////////////////////////////
            /////////side view starts from here
            centerX = tracex + (3 * boxlen) / 4;  // 9869.9480;
            centerY = spaceY - upperYgap;
            centerY -= 400;
            //box boundaries
            //vertical line
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            // var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            // var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            //////////////prim sup
            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {

            }
            catch (Exception)
            {

            }

            if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            {
                double radius = 801.5625;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;
                //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY + 200, 801.5625);
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX + 1360, centerY - radius + 200, radius);

                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1360 + info[Defination.Prim_Radius] + 1500, centerY + 200 - 100, 0), "CL.EL.(+)" + prim_height);

            }

            else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            {
                double radius = 500;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;

                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", centerX + 1360, centerY - radius + 200, radius);

                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1360 - info[Defination.Prim_Radius] - 2500, centerY + 200 - 100, 0), "CL.EL.(+)" + prim_height);
                //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1360 - info[Defination.Prim_Radius], centerY + 200, 0), new Point3d(centerX + 1360 - info[Defination.Prim_Radius] - 3000, centerY + 200, 0), MyCol.LightBlue);
                //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1360 - info[Defination.Prim_Radius] - 2500, centerY + 200 + 300, 0), clampname);

            }
            else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            {
                double radius = 801.5625;
                info[Defination.Prim_Radius] = radius;
                info[Defination.Prim_ht] = radius;
                //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY + 200, 801.5625);
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX + 1360, centerY - radius + 200, radius);

                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1360 + info[Defination.Prim_Radius] + 1500, centerY + 200 - 100, 0), "CL.EL.(+)" + prim_height);

            }


            ////////////plate below prim supp
            height = 200;
            length = 1500;
            //double ht_frm_cen = 1220.7383;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1360 - length / 2, centerY + 200 - info[Defination.Prim_ht], 0), new Point3d(centerX + 1360 + length / 2, centerY + 200 - info[Defination.Prim_ht], 0), new Point3d(centerX + 1360 + length / 2, centerY + 200 - info[Defination.Prim_ht] - height, 0), new Point3d(centerX + 1360 - length / 2, centerY + 200 - info[Defination.Prim_ht] - height, 0), SecThick.Nothing, "pl", 0, sectionsize);

            ///////////////////topsec below prim
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX + 1360, centerY - info[Defination.Prim_ht], 1000, Math.PI, new Point3d(centerX + 1360, centerY - info[Defination.Prim_ht] - 500, 0));


            /////////////////////topsec left side down to prim
            height = 1000;
            length = 4000;
            //double ht_frm_cen = 1220.7383;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - 1000, 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - 1000, 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height - 1000, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height - 1000, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0);


            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(0).StPt;

            //    var endpt = secsupp_des.ElementAt(0).EndPt;

            //    // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
            //    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
            //  l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            //}
            //catch (Exception)
            //{

            //}


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            //  CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////bot sec
            height = 3000;
            length = 500;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.Left, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            /////////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }


            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(acadBlockTableRecord, AcadTransaction,acadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "43");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS44(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                    //double radius = 500;
                    //info[Defination.Prim_Radius] = radius;
                    //info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);


                    //// DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }



            ////////////side view top sec below prim
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000, 1000, Math.PI, new Point3d(centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 0));


            ///////////////topsec
            double height = 1000;
            double length = 1500;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;

                var endpt = secsupp_des.ElementAt(0).EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }



            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////bot sec supp
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "R");

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height, 0), SecThick.VBoth, "R", sectionsize: sectionsize);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), botsec, 1000);

            //////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            ////////////////////////////////
            ///////////////////////////////
            /////////////side view starts from here


            centerX = tracex + (3 * boxlen) / 4;  // 9869.9480;
            centerY = spaceY - upperYgap;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            //  var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Top_SV", centerX, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //  CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Top_SV", centerX, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] + 1000 - 500, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] + 1000 - 500, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Top_SV", centerX, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }




            height = 1000;
            length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height + 1000, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height + 1000, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] + 1000, 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] + 1000, 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height + 1000, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height + 1000, 0);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length / 2, centerY - info[Defination.Prim_ht] + 1000, TotalHt, "l");


            //top sec below sec and prm side view
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", (pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - 416 / 2, pointsinfo[Defination.SecTopLB].Y, 1000);

            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().StPt;

                var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToLower() == "hor").First().EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());



            // vertical dimensioning
            //TotalHt = "";
            ////mtext


            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////sec bot
            height = 3000;
            length = 1000;

            /////////////sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;


            /////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "44");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS45(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2000;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Boundingboxmax.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            //prim supp left side left most
            //for this case only for calculating prim supports

            double length = 5000;

            try
            {

            }
            catch (Exception)
            {

            }



            try
            {
                /////////////left 1st
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 5800, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 5800, centerY, radius, primsup_des.ElementAt(0));

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 5800, centerY, 300);
                    //height of prim from bottom
                    //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            try
            {
                //////////////left 2nd prim
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 4600, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 4600, centerY, radius, primsup_des.ElementAt(0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 4600, centerY, 300);

                }
            }
            catch (Exception)
            {

            }

            try
            {
                //left 3rd prim
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 3400, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 3400, centerY, radius, primsup_des.ElementAt(0));

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 3400, centerY, 300);
                    //height of prim from bottom
                    //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            try
            {
                //left 4th prim
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 2200, centerY, radius, primsup_des.ElementAt(0));

                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 2200, centerY, 300);
                    //height of prim from bottom
                    //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }






            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb")//)
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //prim supp left side right most
            //if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            ////////////////upper top sec supp
            double height = 1000;
            length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht] - height, 0);


            double l_dist_frm_centre = 0;
            double mid_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning hori prim top sec
            try
            {
                var strpt1 = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).StPt);
                var endpt1 = GetArrayAbsoluteValues(secsupp_des.ElementAt(1).EndPt);
                var midpt1 = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                var midpt2 = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);


                var strpt = FindClosestPoint(strpt1, endpt1, midpt1);
                double[] endpt;
                var dist1 = 0.0;
                var dist2 = 0.0;
                var dist3 = 0.0;
                if (strpt == strpt1)
                {
                    endpt = endpt1;
                    Point3d projectedpt1 = FindPerpendicularFoot(midpt1, strpt, endpt);
                    Point3d projectedpt2 = FindPerpendicularFoot(midpt2, strpt, endpt);

                    dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt1));
                    dist2 = Math.Round(GetDist(projectedpt1, projectedpt2));
                    dist3 = Math.Round(GetDist(projectedpt2, new Point3d(endpt)));
                }
                else
                {
                    endpt = strpt1;
                    Point3d projectedpt1 = FindPerpendicularFoot(midpt1, strpt, endpt);
                    Point3d projectedpt2 = FindPerpendicularFoot(midpt2, strpt, endpt);

                    dist1 = Math.Round(GetDist(new Point3d(endpt), projectedpt1));
                    dist2 = Math.Round(GetDist(projectedpt1, projectedpt2));
                    dist3 = Math.Round(GetDist(projectedpt2, new Point3d(strpt)));
                }

                l_dist_frm_centre = dist1;
                mid_dist_frm_centre = dist2;
                r_dist_frm_centre = dist3;
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 1500, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(new Point3d(centerX - 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), mid_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);


            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////bot sec supp
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height + 700;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "nbl", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 500, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -1000);


            //////////////draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pr", sectionsize: sectionsize);



            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //////////////////////concrete
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                //concrete down
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);
            }
            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2, centerY, height, length, i);

            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "45");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS46(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            centerY -= 500;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            ///////////////left mid prim supp

            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 300, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 300, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }



            ///////////////left side mid top sec
            double height = 500;
            double length = 3500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Size));
            }
            catch (Exception)
            {

            }
            // info[Defination.Prim_ht] = 800;
            // info[Defination.Prim_Radius] = 800;
            /////////////left mid top secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", -250, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0);

            //dimension hori both prim sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {

                var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).ListtouchingParts[0]).First().StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l", "BOP(+)");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            ///////////right mid prim supp

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = 300;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1200, centerY - 100, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1200, centerY - 100, radius, primsup_des.ElementAt(1));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1200, centerY, 200);


                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            ///////////////right side middle top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Size));
            }
            catch (Exception)
            {

            }

            ///////////upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            //pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //here line is drawn to split on sec supp into two


            //dimension hori both prim sec
            //dimensioning
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsextrainfo["LT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt, HTtype: "BOP(+)");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            ///////////////bot sec
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(7).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "nbl", 2560, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(7).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);


            /////////////////draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pl", sectionsize: sectionsize);


            /////////////1st left side down sec sup
            height = 500;
            length = 2500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(5).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 1400, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 1400, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0);
            pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0);



            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(5).StPt), new Point3d(secsupp_des.ElementAt(5).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }
            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);

            //vertical ht left hori prim top sec
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(5).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");



            ////////////////2nd left side down sec sup
            height = 500;
            length = 2500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(6).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 3100, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 3100, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0);
            pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0);

            //vert ht sec
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(6).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");


            //////////////////2nd left side down prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                //2nd left side down prim sup
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, radius, primsup_des.ElementAt(2));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius + 300 - 100, 0), clampname);

                }
                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    double radius = 200;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100, radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - 2500, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }


            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(6).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(6).EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(2).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["LT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);


            /////////////right side top top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 3700, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 3700, 0), SecThick.Top, "lr", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0);

            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 3700, TotalHt);

            //////////////////right side below top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 2500, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 2500, 0), SecThick.Top, "LR", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0);

            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);



            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 2500, TotalHt);


            /////////////////concret supp
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                //concrete supp
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);

            }
            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            //}


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "46");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS47(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            centerY -= 500;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                ////////////////left mid prim supp
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 300, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }




            ///////////////left side mid top sec
            double height = 500;
            double length = 3500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Size));
            }
            catch (Exception)
            {

            }
            // info[Defination.Prim_ht] = 800;
            // info[Defination.Prim_Radius] = 800;
            /////////////left mid top secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", -250, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0);

            //dimension hori both prim sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l", "BOP(+)");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            /////////////right mid prim supp

            //try
            //{
            //    if //(ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1200, centerY, 200);


            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 200;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = 300;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1200, centerY - 100, radius);


            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY + 300, 0), clampname);

            //}

            /////////////////right side middle top sec
            //height = 500;
            //length = 2000;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Size));
            //}
            //catch (Exception)
            //{

            //}

            /////////////upper secondary supp
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize);

            //////info for future
            //pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            //pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            ////pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            ////here line is drawn to split on sec supp into two


            ////dimension hori both prim sec
            ////dimensioning
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning right hori prim top sec
            //try
            //{
            //    var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
            //    var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
            //    var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Max(dist1, dist2);
            //    r_dist_frm_centre = Math.Min(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}

            ////double strtmiddist=GetDist(ldist)

            //CreateDimension(pointsextrainfo["LT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            //CreateDimension(pointsextrainfo["RT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            ////LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            ////mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt, HTtype: "BOP(+)");

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            ///////////////bot sec
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(6).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "nbl", 2560, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(6).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);


            /////////////////draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pl", sectionsize: sectionsize);


            /////////////1st left side down sec sup
            height = 500;
            length = 2500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(4).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 1400, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 1400, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0);
            pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0);

            //////////////////1st left side down prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                //////////////////1st left side down prim sup
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - 1400 + radius - 100, 0), new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius + 300 - 100, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 200;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + 1.4 * radius - 100, radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - 2500, centerY - info[Defination.Prim_ht] - 1400 + 1.4 * radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                // l_dist_frm_centre = secsupp_des.ElementAt(5).BoxData.X;
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(4).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(4).EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }
            CreateDimension(pointsextrainfo["LT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + info[Defination.Prim_ht] - 100 + info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + info[Defination.Prim_ht] - 100 + info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString(), 500);

            //vertical ht left hori prim top sec
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(4).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");



            ////////////////2nd left side down sec sup
            height = 500;
            length = 2500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(5).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 3100, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 3100, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0);
            pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0);

            //vert ht sec
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(5).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");


            //////////////////2nd left side down prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                //2nd left side down prim sup
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, radius, primsup_des.ElementAt(2));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius + 300 - 100, 0), clampname);

                }
                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    double radius = 200;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100, radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - 2500, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(5).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(5).EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(2).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["LT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);


            /////////////right side top top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 3700, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 3700, 0), SecThick.Top, "lr", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0);

            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 3700, TotalHt);

            //////////////////right side below top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 2500, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 2500, 0), SecThick.Top, "LR", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0);

            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);



            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 2500, TotalHt);


            ////////////////concret supp
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                //concrete supp
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);

            }
            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            //}


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "47");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS48(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            centerY -= 500;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            ////////////////left mid prim supp

            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 300, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            ///////////////left side mid top sec
            double height = 500;
            double length = 3500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.ListtouchingParts[0] == primsup_des.ElementAt(0).SuppoId).First().Size));
            }
            catch (Exception)
            {

            }
            // info[Defination.Prim_ht] = 800;
            // info[Defination.Prim_Radius] = 800;
            /////////////left mid top secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", -250, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0);

            //dimension hori both prim sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.ListtouchingParts[0] == primsup_des.ElementAt(0).SuppoId).First().StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.ListtouchingParts[0] == primsup_des.ElementAt(0).SuppoId).First().EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l", "BOP(+)");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            /////////////right mid prim supp

            //try
            //{
            //    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1200, centerY, 200);


            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 200;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = 300;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1200, centerY - 100, radius);


            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY + 300, 0), clampname);

            //}

            /////////////////right side middle top sec
            //height = 500;
            //length = 2000;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Size));
            //}
            //catch (Exception)
            //{

            //}

            /////////////upper secondary supp
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize);

            //////info for future
            //pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            //pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            ////pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            ////here line is drawn to split on sec supp into two


            ////dimension hori both prim sec
            ////dimensioning
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning right hori prim top sec
            //try
            //{
            //    var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
            //    var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
            //    var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Max(dist1, dist2);
            //    r_dist_frm_centre = Math.Min(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}

            ////double strtmiddist=GetDist(ldist)

            //CreateDimension(pointsextrainfo["LT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            //CreateDimension(pointsextrainfo["RT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            ////LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            ////mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt, HTtype: "BOP(+)");

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            ///////////////bot sec
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(4).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "nbl", 2560, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(4).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);


            /////////////////draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pl", sectionsize: sectionsize);


            ///////////////1st left side down sec sup
            //height = 500;
            //length = 2500;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(4).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 1400, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 1400, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            //////info for future
            //pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0);
            //pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0);

            ////////////////////1st left side down prim sup
            //try
            //{
            //    if //(ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            ////1st left side down prim sup
            //if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + 1.4 * radius - 100, radius, "l");

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - 2500, centerY - info[Defination.Prim_ht] - 1400 + 1.4 * radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 200;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - 1400 + radius - 100, 0), new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius + 300 - 100, 0), clampname);

            //}

            ////dimension hori both prim sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;

            ////dimensioning left hori prim top sec
            //try
            //{
            //    // l_dist_frm_centre = secsupp_des.ElementAt(5).BoxData.X;
            //    var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(4).StPt);
            //    var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(4).EndPt);
            //    var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(dist1, dist2);
            //    r_dist_frm_centre = Math.Max(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}
            //CreateDimension(pointsextrainfo["LT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + info[Defination.Prim_ht] - 100 + info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString(), 500);
            //CreateDimension(pointsextrainfo["RT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + info[Defination.Prim_ht] - 100 + info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString(), 500);

            ////vertical ht left hori prim top sec
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(4).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");



            //////////////////2nd left side down sec sup
            //height = 500;
            //length = 2500;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(5).Size));
            //}
            //catch (Exception)
            //{

            //}


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 3100, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 3100, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            //pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0);
            //pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0);

            ////vert ht sec
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(5).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");


            ////////////////////2nd left side down prim sup
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb")//)
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(2).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(2).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            ////2nd left side down prim sup
            //if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100, radius, "l");

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - 2500, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 200;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius + 300 - 100, 0), clampname);

            //}

            ////dimension hori both prim sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;

            ////dimensioning left hori prim top sec
            //try
            //{
            //    var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(5).StPt);
            //    var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(5).EndPt);
            //    var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(2).Centroid);
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(dist1, dist2);
            //    r_dist_frm_centre = Math.Max(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}

            //CreateDimension(pointsextrainfo["LT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            //CreateDimension(pointsextrainfo["RT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);


            /////////////right side top top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 3700, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 3700, 0), SecThick.Top, "lr", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0);

            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 3700, TotalHt);

            //////////////////right side below top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 2500, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 2500, 0), SecThick.Top, "LR", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0);

            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);



            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 2500, TotalHt);


            ////////////////concrete supp
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                //concrete supp
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);

            }
            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            //}


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "48");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS49(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            centerY -= 500;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                ////left mid prim supp
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 300, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }





            ///////////////left side mid top sec
            double height = 500;
            double length = 3500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Size));
            }
            catch (Exception)
            {

            }
            // info[Defination.Prim_ht] = 800;
            // info[Defination.Prim_Radius] = 800;
            /////////////left mid top secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", -250, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height, 0);

            //dimension hori both prim sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(0).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l", "BOP(+)");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            /////////////right mid prim supp

            //try
            //{
            //    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1200, centerY, 200);


            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 200;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = 300;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1200, centerY - 100, radius);


            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1200 + info[Defination.Prim_Radius] + 1300, centerY + 300, 0), clampname);

            //}

            /////////////////right side middle top sec
            //height = 500;
            //length = 2000;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Size));
            //}
            //catch (Exception)
            //{

            //}

            /////////////upper secondary supp
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize);

            //////info for future
            //pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht], 0);
            //pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            ////pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            ////pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            ////here line is drawn to split on sec supp into two


            ////dimension hori both prim sec
            ////dimensioning
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning right hori prim top sec
            //try
            //{
            //    var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
            //    var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
            //    var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Max(dist1, dist2);
            //    r_dist_frm_centre = Math.Min(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}

            ////double strtmiddist=GetDist(ldist)

            //CreateDimension(pointsextrainfo["LT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            //CreateDimension(pointsextrainfo["RT"], new Point3d(centerX + 1200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            ////LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            ////mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt, HTtype: "BOP(+)");

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 4500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);


            ///////////////bot sec
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(5).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "nbl", 2560, sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 5000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(5).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);


            /////////////////draw upper plate 
            height = 200;
            length = 1500;
            info[Defination.Plate_l] = length;
            info[Defination.Plate_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pl", sectionsize: sectionsize);


            /////////////1st left side down sec sup
            height = 500;
            length = 2500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 1400, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 1400, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 1400, 0);
            pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 1400, 0);

            //////////////////1st left side down prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                //1st left side down prim sup
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - 1400 + radius - 100, 0), new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius - 100, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 1400 + radius + 300 - 100, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 200;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + 1.4 * radius - 100, radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - 2500, centerY - info[Defination.Prim_ht] - 1400 + 1.4 * radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }




            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                // l_dist_frm_centre = secsupp_des.ElementAt(5).BoxData.X;
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(3).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(3).EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }
            CreateDimension(pointsextrainfo["LT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + info[Defination.Prim_ht] - 100 + info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 1400 + info[Defination.Prim_ht] - 100 + info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString(), 500);

            //vertical ht left hori prim top sec
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(3).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");



            ////////////////2nd left side down sec sup
            height = 500;
            length = 2500;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(4).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height - 3100, 0), new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - height - 3100, 0), SecThick.HBoth, "l", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(centerX - length, centerY - info[Defination.Prim_ht] - 3100, 0);
            pointsextrainfo["RT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] - 3100, 0);

            //vert ht sec
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(4).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X, pointsextrainfo["LT"].Y, TotalHt, "l", "BOP(+)");


            //////////////////2nd left side down prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, radius, primsup_des.ElementAt(2));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius - 100, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - 3100 + radius + 300 - 100, 0), clampname);

                }
                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    double radius = 200;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100, radius, "l");

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length + 1000 - 2500, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * radius - 100 - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            //2nd left side down prim sup




            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;

            //dimensioning left hori prim top sec
            try
            {
                var strpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(4).StPt);
                var endpt = GetArrayAbsoluteValues(secsupp_des.ElementAt(4).EndPt);
                var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(2).Centroid);
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["LT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(centerX - length + 1000, centerY - info[Defination.Prim_ht] - 3100 + 1.4 * info[Defination.Prim_Radius] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);


            /////////////right side top top sec
            height = 500;
            length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 3700, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 3700, 0), SecThick.Top, "lr", sectionsize: sectionsize);

            ////info for future
            pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 3700, 0);
            pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 3700, 0);

            //dimension hori both prim sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning right hori prim top sec
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
                //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
                //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 3700, TotalHt);

            ////////////////////right side below top sec
            //height = 500;
            //length = 2000;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0), new Point3d(centerX + length, centerY - info[Defination.Prim_ht] - height + 2500, 0), new Point3d(centerX, centerY - info[Defination.Prim_ht] - height + 2500, 0), SecThick.Top, "LR", sectionsize: sectionsize);

            //////info for future
            //pointsextrainfo["LT"] = new Point3d(centerX, centerY - info[Defination.Prim_ht] + 2500, 0);
            //pointsextrainfo["RT"] = new Point3d(centerX + length, centerY - info[Defination.Prim_ht] + 2500, 0);

            ////dimension hori both prim sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning right hori prim top sec
            //try
            //{
            //    l_dist_frm_centre = secsupp_des.ElementAt(2).BoxData.X;
            //    //var strpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().StPt);
            //    //var endpt = GetArrayAbsoluteValues(secsupp_des.Where(e => e.TouchingPartid == primsup_des.ElementAt(1).SuppoId).First().EndPt);
            //    //var midpt = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Max(dist1, dist2);
            //    //r_dist_frm_centre = Math.Min(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}

            ////double strtmiddist=GetDist(ldist)

            //CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            //// CreateDimension(new Point3d(centerX + length, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            ////LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);



            ////mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length, centerY - info[Defination.Prim_ht] + 2500, TotalHt);


            //////////////////concret supp
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                //concrete supp
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);

            }
            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            //}


            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "49");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS50(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            //CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            //gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "50");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS51(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);



            //////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////topsec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht];//"commented to start from same topsec height" + height;
            ////////////////////bot sec
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            //////////////////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            ///////////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "51");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        public void DRS52(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            //double ht_frm_cen = 1220.7383;
            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
                CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());
            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            ///////////left plate for top concrete
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.HBoth, "pl", 0, sectionsize);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////////////slant sec support
            //height = 1000;
            //length = 3000;
            //info[Defination.Sec_bot_l] = length;
            //info[Defination.Sec_bot_b] = height;

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize);

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}



            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            ////hori small dimen
            //var botsec2 = "";
            //try
            //{

            //    var toppart = secsupp_des.ElementAt(1).EndPt;
            //    var anglepart = secsupp_des.ElementAt(2).EndPt;

            //    sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(2).Size);

            //    botsec2 = (toppart[0] - anglepart[0] - sectionsize / 2).ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            ////inside lines
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            ///////////////////left plate for bot sec
            //height = 1500;
            //length = 200;

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.HBoth, "pl", 0, sectionsize);


            /////////////////////ref block
            ////pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            ////pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            ////pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            ////pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            ////CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            ////DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "52");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        public void DRS53(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            //double ht_frm_cen = 1220.7383;
            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
                CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());
            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();


                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();

                //    var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //    var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //    var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //    var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //    all_dist.Add(firs);
                //    all_dist.Add(sec1);
                //    all_dist.Add(thrd);
                //    all_dist.Add(four);
                //    all_dist.Sort();

                //    var toppart = secsupp_des.ElementAt(0).EndPt;
                //    var anglepart = secsupp_des.ElementAt(1).EndPt;

                //    sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //    botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "53");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS54(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //l_dist_frm_centre = GetDistArray(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt);
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 1500;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VHidBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "54");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS55(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //l_dist_frm_centre = GetDistArray(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt);
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 1500;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VHidBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "55");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS56(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //l_dist_frm_centre = GetDistArray(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt);
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 1500;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VHidBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "56");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS57(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //l_dist_frm_centre = GetDistArray(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt);
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////////bot sec
            //height = 1500;
            //length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Prim_ht] + height;
            ////sec bot

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VHidBoth, "l");

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "57");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS58(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////topsec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                l_dist_frm_centre = GetDistArray(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt);
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            //////////////////bot sec
            //height = 1500;
            //length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Prim_ht] + height;
            ////sec bot

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VHidBoth, "l");

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            //}



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "58");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS59(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 2000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //l_dist_frm_centre = GetDistArray(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt);
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////////bot sec
            //height = 1500;
            //length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Prim_ht] + height;
            ////sec bot

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VHidBoth, "l");

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "59");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS60(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.Top, "LR", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //l_dist_frm_centre = GetDistArray(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt);
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////////bot sec
            //height = 1500;
            //length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Prim_ht] + height;
            ////sec bot

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VHidBoth, "l");

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "60");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }
        public void DRS61(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            //double ht_frm_cen = 1220.7383;
            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
                CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());
            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();

                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "61");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS62(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            //double ht_frm_cen = 1220.7383;

            //topsec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////////slant sec sup
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();
                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();

                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();
                // botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();


            }
            catch (Exception e)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            /////////////////////bot sec
            //bot secondary support
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = height + 1500;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0), SecThick.VBoth, "L", sectionsize: sectionsize);

            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 3000);

            /////////////concret supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "62");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS63(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////top sec
            double height = 1000;
            double length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], TotalHt, "l");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            /////////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "r", 2000);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);


            //////////////////lower sec top supp
            height = 1000;
            length = 2500;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;


            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HBoth, "L", sectionsize: sectionsize);

            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["Sec_low_LT"].X, pointsextrainfo["Sec_low_LT"].Y, TotalHt, "l");
            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            //string lower_prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //////prim of lower sec top supp
            ////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 1200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            //    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            //}


            //note nfo[prim.ht changes here

            //dimensioning

            l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = secsupp_des.ElementAt(1).StPt;
                //var endpt = secsupp_des.ElementAt(1).EndPt;
                //var midpt = primsup_des.ElementAt(1).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }


            CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            // CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "63");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS64(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////top sec
            double height = 1000;
            double length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], TotalHt, "l");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            /////////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "r", 2000);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);


            //////////////////lower sec top supp
            height = 1000;
            length = 2500;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;


            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HHidBoth, "L", sectionsize: sectionsize);

            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["Sec_low_LT"].X, pointsextrainfo["Sec_low_LT"].Y, TotalHt, "l");
            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            //string lower_prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //////prim of lower sec top supp
            ////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 1200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            //    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            //}


            //note nfo[prim.ht changes here

            //dimensioning

            l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = secsupp_des.ElementAt(1).StPt;
                //var endpt = secsupp_des.ElementAt(1).EndPt;
                //var midpt = primsup_des.ElementAt(1).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }


            CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            // CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "64");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS65(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////top sec
            double height = 1000;
            double length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], TotalHt, "l");

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ////////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "r", 2000);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);


            /////////////////lower sec top supp
            height = 1000;
            length = 2500;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;


            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HHidBoth, "L", sectionsize: sectionsize);

            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["Sec_low_LT"].X, pointsextrainfo["Sec_low_LT"].Y, "l");
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            //string lower_prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //////prim of lower sec top supp
            ////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 1200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            //    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            //}


            //note nfo[prim.ht changes here

            //dimensioning

            l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt)));
                //var strpt = secsupp_des.ElementAt(1).StPt;
                //var endpt = secsupp_des.ElementAt(1).EndPt;
                //var midpt = primsup_des.ElementAt(1).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }


            CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            // CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ////////////////////middle sec top supp
            //////same name bcoz copy paste of low sec top supp
            height = 1000;
            length = 2500;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;


            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 2500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 2500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500 + 2500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500 + 2500, 0), SecThick.HHidBoth, "L", sectionsize: sectionsize);

            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 2500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 2500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500 + 2500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500 + 2500, 0);

            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["Sec_low_LT"].X, pointsextrainfo["Sec_low_LT"].Y, TotalHt, "l");
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 2500 + 300, 0), "TOS EL.(+)" + TotalHt);


            //dimensioning

            l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = secsupp_des.ElementAt(1).StPt;
                //var endpt = secsupp_des.ElementAt(1).EndPt;
                //var midpt = primsup_des.ElementAt(1).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }


            CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);



            ///////////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "65");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS66(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////left top sec
            double height = 1000;
            double length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ////////////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "r", 2000);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);


            /////////////////lower sec top supp
            height = 1000;
            length = 4000;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;


            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HHidBoth, "L", sectionsize: sectionsize);

            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            //string lower_prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //////prim of lower sec top supp
            ////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 1200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            //    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            //}


            //note nfo[prim.ht changes here

            //dimensioning

            l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt)));
                //var strpt = secsupp_des.ElementAt(1).StPt;
                //var endpt = secsupp_des.ElementAt(1).EndPt;
                //var midpt = primsup_des.ElementAt(1).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }


            CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            // CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ///////////////////////right top sec
            height = 1000;
            length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000 + 5000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);


            l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000 + 5000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500 + 5000, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            ////////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "66");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS67(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            centerX -= 1500;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////left top sec
            double height = 1000;
            double length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0));
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], TotalHt, "l");

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ////////////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "r", 2000);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);


            /////////////////lower sec top supp
            height = 1000;
            length = 2500;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;


            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HHidBoth, "L", sectionsize: sectionsize);

            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["Sec_low_LT"].X, pointsextrainfo["Sec_low_LT"].Y, TotalHt, "l");
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            //string lower_prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //////prim of lower sec top supp
            ////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 1200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            //    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            //}


            //note nfo[prim.ht changes here

            //dimensioning

            l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt)));
                //var strpt = secsupp_des.ElementAt(1).StPt;
                //var endpt = secsupp_des.ElementAt(1).EndPt;
                //var midpt = primsup_des.ElementAt(1).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);
            }
            catch (Exception)
            {

            }


            CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            // CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            ///////////////////////mid right top sec
            height = 1000;
            length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000 + 4000, centerY - info[Defination.Prim_ht] - 3000, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht] - 3000, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht] - height - 3000, 0), new Point3d(centerX - length * 0.66 + 1000 + 4000, centerY - info[Defination.Prim_ht] - height - 3000, 0), SecThick.HHidBoth, "R", 0, sectionsize);


            l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000 + 4000, centerY - info[Defination.Prim_ht] - 3000, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht] - 3000, 0));
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht] - 3000, 0), new Point3d(centerX + length * 0.34 + 4000 + 5000, centerY - info[Defination.Prim_ht] - 3000, 0), MyCol.LightBlue);

            TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500 + 4000, centerY - info[Defination.Prim_ht] - 3000 + 300, 0), "TOS EL.(+)" + TotalHt);

            ////////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "67");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS68(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            ////////////////////topsec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            // double r_dist_frm_centre = 0;
            //dimensioning
            try
            {

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////////bot sec
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////////////////////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            /////////////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "68");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS69(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////top sec
            double height = 1000;
            double length = 6000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], TotalHt, "l");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            /////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "r", 2000);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);




            ////////////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");

            ////////////////////////lower sec top supp
            //height = 1000;
            //length = 4000;
            //extrainfo["Sec_low_b"] = height;
            //extrainfo["Sec_low_l"] = length;
            //extrainfo["Sec_low_l"] = length + 500;


            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HBoth, "L", sectionsize: sectionsize);

            ////info for future
            //pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            //pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            //pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            //pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            ////vertical sec dimensioning
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            ////string lower_prim_height = "";
            ////try
            ////{
            ////    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            ////    {
            ////        //height of prim from bottom

            ////        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            ////    }

            ////    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            ////    {
            ////        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            ////    }
            ////}
            ////catch (Exception)
            ////{

            ////}


            ////////prim of lower sec top supp
            //////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            //////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            ////if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            ////{
            ////    double radius = 1200;
            ////    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            ////    try
            ////    {
            ////        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            ////    }
            ////    catch (Exception)
            ////    {

            ////    }
            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            ////}

            ////if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            ////{
            ////    double radius = 500;
            ////    info[Defination.Prim_Radius] = radius;
            ////    info[Defination.Prim_ht] = radius;

            ////    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            ////    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            ////    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            ////    //height of prim from bottom
            ////    try
            ////    {
            ////        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            ////    }
            ////    catch (Exception)
            ////    {

            ////    }
            ////    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            ////    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            ////    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            ////}


            ////note nfo[prim.ht changes here

            ////dimensioning

            //l_dist_frm_centre = 0;
            ////r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    l_dist_frm_centre =  Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
            //    //var strpt = secsupp_des.ElementAt(1).StPt;
            //    //var endpt = secsupp_des.ElementAt(1).EndPt;
            //    //var midpt = primsup_des.ElementAt(1).Centroid;
            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Min(dist1, dist2);
            //    //r_dist_frm_centre = Math.Max(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}


            //CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            //// CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            //// CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);





            /////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i, "na");
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "69");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS70(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            //double ht_frm_cen = 1220.7383;

            ////////////////////////////topsec
            ////////subtracted 3000 to left end for making long top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////////////slant sec sup right
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "r", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                // botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

                //var rightpt = GetRightPoint(new Point3d(secsupp_des.ElementAt(3).StPt), new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(2).StPt));

                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //// var sec1 = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //// var thrd = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //// var four = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt)));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();


                //var toppartst = secsupp_des.ElementAt(0).StPt;
                //var toppartsend = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //////////////////////slant sec sup left
            //subtracted 1000 to left from bottom end and subtracted 6475.4928 and 4475.4928 from upper end to draw mirror of slant support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            /////Note:-for this case box doesnt start from left top
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464 - 4475.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 6475.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");


            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464 - 4475.4928, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 6475.4928, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRB], pointsinfo[Defination.SecBotLB], botsec, 1000);

            //hori small dimen
            botsec2 = "";
            try
            {
                // botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
                List<double> all_dist = new List<double>();

                var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                all_dist.Add(firs);
                all_dist.Add(sec1);
                all_dist.Add(thrd);
                all_dist.Add(four);
                all_dist.Sort();

                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }

            //new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht] - height, 0)
            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht] - height, 0), pointsinfo[Defination.SecBotRB], botsec2, 700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200 - 4875.4928, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200 - 6075.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            /////////////////////////bot secondary support
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = height + 500 + 1000;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0), SecThick.VBoth, "L", sectionsize: sectionsize);

            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }
            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 3000);

            //////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////concret supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, centerY, height, length, i, "na");

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "70");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS71(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////top sec
            double height = 1000;
            double length = 6000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 1000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 1000, centerY - info[Defination.Prim_ht], 0));
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], TotalHt, "l");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            /////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - 1000, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - 1000, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "r", 2000);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - 1000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - 1000, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] - 1000, 0), botsec);




            ////////////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");

            ////////////////////////lower sec top supp
            //height = 1000;
            //length = 4000;
            //extrainfo["Sec_low_b"] = height;
            //extrainfo["Sec_low_l"] = length;
            //extrainfo["Sec_low_l"] = length + 500;


            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HBoth, "L", sectionsize: sectionsize);

            ////info for future
            //pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            //pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            //pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            //pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            ////vertical sec dimensioning
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            ////string lower_prim_height = "";
            ////try
            ////{
            ////    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            ////    {
            ////        //height of prim from bottom

            ////        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            ////    }

            ////    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            ////    {
            ////        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            ////    }
            ////}
            ////catch (Exception)
            ////{

            ////}


            ////////prim of lower sec top supp
            //////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            //////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            ////if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            ////{
            ////    double radius = 1200;
            ////    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            ////    try
            ////    {
            ////        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            ////    }
            ////    catch (Exception)
            ////    {

            ////    }
            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            ////}

            ////if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            ////{
            ////    double radius = 500;
            ////    info[Defination.Prim_Radius] = radius;
            ////    info[Defination.Prim_ht] = radius;

            ////    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            ////    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            ////    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            ////    //height of prim from bottom
            ////    try
            ////    {
            ////        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            ////    }
            ////    catch (Exception)
            ////    {

            ////    }
            ////    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            ////    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            ////    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            ////}


            ////note nfo[prim.ht changes here

            ////dimensioning

            //l_dist_frm_centre = 0;
            ////r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    l_dist_frm_centre = secsupp_des.ElementAt(1).BoxData.X;
            //    //var strpt = secsupp_des.ElementAt(1).StPt;
            //    //var endpt = secsupp_des.ElementAt(1).EndPt;
            //    //var midpt = primsup_des.ElementAt(1).Centroid;
            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Min(dist1, dist2);
            //    //r_dist_frm_centre = Math.Max(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}


            //CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            //// CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            //// CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);





            /////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i, "na");
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "71");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS72(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////prim sup left
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, radius, primsup_des.ElementAt(1));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));


                }
            }
            catch (Exception)
            {

            }
            /////////////prim sup left most
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 400);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 2200, centerY, 0), new Point3d(centerX - 2200 - 500, centerY + 1500, 0), new Point3d(centerX - 2200 - 1500, centerY + 1500, 0));


                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, radius, primsup_des.ElementAt(0));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 2200, centerY, 0), new Point3d(centerX - 2200 - 500, centerY + 1500, 0), new Point3d(centerX - 2200 - 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 2200, centerY, 400);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 2200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 2200, centerY, 0), new Point3d(centerX - 2200 - 500, centerY + 1500, 0), new Point3d(centerX - 2200 - 1500, centerY + 1500, 0));


                }
            }
            catch (Exception)
            {

            }

            ///////prim sup right
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 400);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX + 1000, centerY, 0), new Point3d(centerX + 1000 - 500, centerY + 1500, 0), new Point3d(centerX + 1000 - 1500, centerY + 1500, 0));


                }

                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY + 1000, radius, primsup_des.ElementAt(2));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX + 1000, centerY, 0), new Point3d(centerX + 1000 - 500, centerY + 1500, 0), new Point3d(centerX + 1000 - 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 400);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX + 1000, centerY, 0), new Point3d(centerX + 1000 - 500, centerY + 1500, 0), new Point3d(centerX + 1000 - 1500, centerY + 1500, 0));


                }
            }
            catch (Exception)
            {

            }

            /////////prim sup right most
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(3));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(3).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 2200, centerY, 400);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(3).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX + 2200, centerY, 0), new Point3d(centerX + 2200 + 500, centerY + 1500, 0), new Point3d(centerX + 2200 + 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(3).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(3).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 2200, centerY, radius, primsup_des.ElementAt(3));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(3).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX + 2200, centerY, 0), new Point3d(centerX + 2200 + 500, centerY + 1500, 0), new Point3d(centerX + 2200 + 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 2200 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(3).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 2200, centerY, 400);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2200 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(3).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX + 2200, centerY, 0), new Point3d(centerX + 2200 + 500, centerY + 1500, 0), new Point3d(centerX + 2200 + 1500, centerY + 1500, 0));


                }
            }
            catch (Exception)
            {

            }

            /////////////////////topsec
            double height = 1000;
            double length = 7000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            double prim2_dist = 0;
            double prim3_dist = 0;
            double prim4_dist = 0;
            double prim5_dist = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;
                    var prim1_midpt = primsup_des.ElementAt(0).Centroid;
                    var prim2_midpt = primsup_des.ElementAt(1).Centroid;
                    var prim3_midpt = primsup_des.ElementAt(2).Centroid;
                    var prim4_midpt = primsup_des.ElementAt(3).Centroid;

                    Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
                    Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
                    Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
                    Point3d prim4_projectedpt = FindPerpendicularFoot(prim4_midpt, strpt, endpt);
                    var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    if (left < right)
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
                        prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
                        prim4_dist = Math.Round(GetDist(new Point3d(strpt), prim4_projectedpt));
                    }
                    else
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
                        prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
                        prim4_dist = Math.Round(GetDist(new Point3d(endpt), prim4_projectedpt));
                    }

                    all_dimen.Add(prim1_dist);
                    all_dimen.Add(prim2_dist);
                    all_dimen.Add(prim3_dist);
                    all_dimen.Add(prim4_dist);
                    all_dimen.Sort();

                    prim1_dist = Math.Round(all_dimen[0]);
                    prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
                    prim3_dist = Math.Round(all_dimen[2] - all_dimen[1]);
                    prim4_dist = Math.Round(all_dimen[3] - all_dimen[2]);
                    prim5_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - all_dimen[3]);



                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 2200, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 1000, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 1000, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), prim3_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX + 2200, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);

            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);


            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "72");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS73(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            /////////////////prim sup left
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, 400);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, radius, primsup_des.First());
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, 400);
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            ///////prim sup right
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[1].SupportName.ToLower().Contains("nb"))
                {
                    //height of prim from bottom

                    prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[1].PrimaryZhtNB)), 2).ToString();
                }

                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[1].SupportName.ToLower().Contains("clamp"))
                {
                    prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.Z)), 2).ToString();
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[1].SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 400);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

                else if (ListCentalSuppoData[i].ListPrimarySuppo[1].SupportName.ToLower().Contains("clamp"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + 1000, centerY, radius);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);
                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[1].SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1000, centerY, 400);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            /////////////////////topsec
            double height = 1000;
            double length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double prim_to_prim_dist = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt1 = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                var midpt2 = ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid;

                Point3d projectedpt1 = FindPerpendicularFoot(midpt1, strpt, endpt);
                Point3d projectedpt2 = FindPerpendicularFoot(midpt2, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt1));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt2));

                l_dist_frm_centre = Math.Min(dist1, dist2);
                r_dist_frm_centre = Math.Max(dist1, dist2);
                prim_to_prim_dist = Math.Round(GetDist(new Point3d(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X, ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Y, ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z), new Point3d(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X, ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Y, ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)));
                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
                //r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            }
            catch (Exception)
            {

            }

            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 1000, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX - 1000, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), prim_to_prim_dist.ToString());
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX + 1000, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }


            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "73");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS74(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            ////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            //try
            //{
            //    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 300;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //        //height of prim from bottom
            //        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //        string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //    }
            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //}
            //catch (Exception)
            //{

            //}


            //////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}
            //double ht_frm_cen = 1220.7383;0.33,0.66

            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            // double l_dist_frm_centre = 0;
            // double r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(0).StPt;
            //    var endpt = secsupp_des.ElementAt(0).EndPt;
            //    var midpt = primsup_des.ElementAt(0).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            //dimensioning
            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////////bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "l", -2000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);



            ////left side down secondary support
            //height = 1000;
            //length = 2500;
            //extrainfo["sec_Left_Bot_L"] = length;
            //extrainfo["sec_Left_Bot_B"] = height;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            ////verti dimen secsupp
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            ////left side down primary support

            ////verti dimen prim ht
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 300;

            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            //}

            ////hori dimesion of left side down prim and sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(1).StPt;
            //    var endpt = secsupp_des.ElementAt(1).EndPt;
            //    var midpt = primsup_des.ElementAt(1).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            /////////////right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);

            //right side upper primary support
            string prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);



            ///////////////////right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            /////////////////////hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            /////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "74");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS75(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            ////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            //try
            //{
            //    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 300;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //        //height of prim from bottom
            //        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //        string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //    }
            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //}
            //catch (Exception)
            //{

            //}


            //////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}
            //double ht_frm_cen = 1220.7383;0.33,0.66

            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            // double l_dist_frm_centre = 0;
            // double r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(0).StPt;
            //    var endpt = secsupp_des.ElementAt(0).EndPt;
            //    var midpt = primsup_des.ElementAt(0).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            //dimensioning
            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////////bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "l", -2000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);



            ////left side down secondary support
            //height = 1000;
            //length = 2500;
            //extrainfo["sec_Left_Bot_L"] = length;
            //extrainfo["sec_Left_Bot_B"] = height;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            ////verti dimen secsupp
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            ////left side down primary support

            ////verti dimen prim ht
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 300;

            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            //}

            ////hori dimesion of left side down prim and sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(1).StPt;
            //    var endpt = secsupp_des.ElementAt(1).EndPt;
            //    var midpt = primsup_des.ElementAt(1).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            /////////////right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);

            //right side upper primary support
            string prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            /////////////////right side middle sec sup

            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"] - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"] - 2200, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - 2200, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - 2200, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y - 2200, TotalHt);

            //right side upper primary support
            prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 2200, radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100 - 2200, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 2200, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 2200, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100 - 2200, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius - 2200, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300 - 2200, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 2200, radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100 - 2200, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius] - 2200, 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius] - 2200, 0), r_dist_frm_centre.ToString(), 200);



            ///////////////////right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(2));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            /////////////////////hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(2).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            /////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "75");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS76(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            ////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            //try
            //{
            //    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 300;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //        //height of prim from bottom
            //        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //        string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //    }
            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //}
            //catch (Exception)
            //{

            //}


            //////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}
            //double ht_frm_cen = 1220.7383;0.33,0.66

            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            // double l_dist_frm_centre = 0;
            // double r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(0).StPt;
            //    var endpt = secsupp_des.ElementAt(0).EndPt;
            //    var midpt = primsup_des.ElementAt(0).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            //dimensioning
            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////////bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.HBoth, "l", -2000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);



            ////left side down secondary support
            //height = 1000;
            //length = 2500;
            //extrainfo["sec_Left_Bot_L"] = length;
            //extrainfo["sec_Left_Bot_B"] = height;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            ////verti dimen secsupp
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            ////left side down primary support

            ////verti dimen prim ht
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 300;

            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            //}

            ////hori dimesion of left side down prim and sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(1).StPt;
            //    var endpt = secsupp_des.ElementAt(1).EndPt;
            //    var midpt = primsup_des.ElementAt(1).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            /////////////right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), SecThick.VHidBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);

            //right side upper primary support
            string prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);



            ///////////////////right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HHidBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            /////////////////////hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            /////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "76");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS77(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            ////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            //try
            //{
            //    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 300;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //        //height of prim from bottom
            //        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //        string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //    }
            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //}
            //catch (Exception)
            //{

            //}


            //////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}
            //double ht_frm_cen = 1220.7383;0.33,0.66

            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            // double l_dist_frm_centre = 0;
            // double r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(0).StPt;
            //    var endpt = secsupp_des.ElementAt(0).EndPt;
            //    var midpt = primsup_des.ElementAt(0).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            //dimensioning
            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////////bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "l", -2000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);



            ////left side down secondary support
            //height = 1000;
            //length = 2500;
            //extrainfo["sec_Left_Bot_L"] = length;
            //extrainfo["sec_Left_Bot_B"] = height;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            ////verti dimen secsupp
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            ////left side down primary support

            ////verti dimen prim ht
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 300;

            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            //}

            ////hori dimesion of left side down prim and sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(1).StPt;
            //    var endpt = secsupp_des.ElementAt(1).EndPt;
            //    var midpt = primsup_des.ElementAt(1).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            /////////////right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), SecThick.HHidBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);

            //right side upper primary support
            string prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            /////////////////right side middle sec sup

            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"] - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"] - 2200, 0), SecThick.HHidBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - 2200, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - 2200, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y - 2200, TotalHt);

            //right side upper primary support
            prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 2200, radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100 - 2200, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 2200, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 2200, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100 - 2200, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius - 2200, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius - 2200, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300 - 2200, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 2200, radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100 - 2200, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius] - 2200, 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius] - 2200, 0), r_dist_frm_centre.ToString(), 200);



            ///////////////////right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HHidBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(2));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            /////////////////////hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(2).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            /////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "75");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS79(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2000;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Boundingboxmax.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            //prim supp left side left most
            //for this case only for calculating prim supports

            double length = 5000;

            try
            {
                /////////////left 1st
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 5800, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 5800, centerY, radius, primsup_des.ElementAt(0));

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 5800, centerY, 300);
                    //height of prim from bottom
                    //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            try
            {
                //////////////left 2nd prim
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 4600, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 4600, centerY, radius, primsup_des.ElementAt(0));
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66 - 2500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 4600, centerY, 300);

                }
            }
            catch (Exception)
            {

            }

            try
            {
                //left 3rd prim
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 3400, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 3400, centerY, radius, primsup_des.ElementAt(0));
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 3400, centerY, 300);
                    //height of prim from bottom
                    //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }

            try
            {
                //left 4th prim
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX + length * 0.66 - 2200, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 2200, centerY, radius, primsup_des.ElementAt(0));
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + length * 0.66 - 2200, centerY, 300);
                    //height of prim from bottom
                    //  CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }
            }
            catch (Exception)
            {

            }






            //try
            //{
            //    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //prim supp left side right most
            //if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            ////////////////upper top sec supp
            double height = 1000;
            length = 5000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;0.33,0.66
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.34 - 2000, centerY - info[Defination.Prim_ht] - height, 0);


            double l_dist_frm_centre = 0;
            double mid_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning hori prim top sec
            try
            {
                var strpt1 = GetArrayAbsoluteValues(secsupp_des.ElementAt(0).StPt);
                var endpt1 = GetArrayAbsoluteValues(secsupp_des.ElementAt(0).EndPt);
                var midpt1 = Get3dAbsoluteValues(primsup_des.ElementAt(0).Centroid);
                var midpt2 = Get3dAbsoluteValues(primsup_des.ElementAt(1).Centroid);


                var strpt = FindClosestPoint(strpt1, endpt1, midpt1);
                double[] endpt;
                var dist1 = 0.0;
                var dist2 = 0.0;
                var dist3 = 0.0;
                if (strpt == strpt1)
                {
                    endpt = endpt1;
                    Point3d projectedpt1 = FindPerpendicularFoot(midpt1, strpt, endpt);
                    Point3d projectedpt2 = FindPerpendicularFoot(midpt2, strpt, endpt);

                    dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt1));
                    dist2 = Math.Round(GetDist(projectedpt1, projectedpt2));
                    dist3 = Math.Round(GetDist(projectedpt2, new Point3d(endpt)));
                }
                else
                {
                    endpt = strpt1;
                    Point3d projectedpt1 = FindPerpendicularFoot(midpt1, strpt, endpt);
                    Point3d projectedpt2 = FindPerpendicularFoot(midpt2, strpt, endpt);

                    dist1 = Math.Round(GetDist(new Point3d(endpt), projectedpt1));
                    dist2 = Math.Round(GetDist(projectedpt1, projectedpt2));
                    dist3 = Math.Round(GetDist(projectedpt2, new Point3d(strpt)));
                }

                l_dist_frm_centre = dist1;
                mid_dist_frm_centre = dist2;
                r_dist_frm_centre = dist3;
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 1500, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 500);
            CreateDimension(new Point3d(centerX - 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), mid_dist_frm_centre.ToString(), 500);
            CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 500);


            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.66 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);


            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////bot sec supp
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = height + 700;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X - 1000, pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 1000 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 1000 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), new Point3d(pointsinfo[Defination.SecTopRT].X - 1000, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 1000, pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopRT].X - 1000 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 1000 + info[Defination.Sec_bot_l], pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopRT].X - 1000, pointsinfo[Defination.SecTopRT].Y + 500 - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec, -1000);


            ////////////////draw upper plate 
            //height = 200;
            //length = 1500;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y + info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.Nothing, "pr", sectionsize: sectionsize);



            //height = 1000;
            //length = 3000;
            //info[Defination.Concrete_l] = length;
            //info[Defination.Concrete_b] = height;

            //////////////////////concrete
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                //concrete down
                CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "concrete_patel", (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, 500);

                //concrete verti ht
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmax.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y, TotalHt, "r", "EL.(+)");
                try
                {
                    TotalHt = ListCentalSuppoData[i].ListConcreteData[0].Boundingboxmin.Z.ToString();
                }
                catch (Exception)
                {

                }
                TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), TotalHt, "r", "FGL.EL.(+)");

                //concrete block dimension
                try
                {
                    botsec = ListCentalSuppoData[i].ListConcreteData[0].BoxData.Z.ToString();
                }
                catch (Exception)
                {

                }

                CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2 - (3 * 500), pointsinfo[Defination.SecBotLB].Y - (500 * 3.5063), 0), botsec, 1000);
            }
            //if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            //{
            //    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2, centerY, height, length, i);

            //}

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "79");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }


        [Obsolete]
        public void DRS80(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            ////upper primary
            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 801.5625;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY, radius);

            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY + 1.4 * radius, 0));

            //    //height of prim from bottom
            //    try
            //    {
            //        //    prim_height = MillimetersToMeters(Convert.ToDouble(prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {

            //    }
            //    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 2500, centerY + 300, 0), clampname);

            //}


            ///////////////////////top sec
            double height = 1000;
            double length = 4000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);


            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], TotalHt, "l");

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            /////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            //secondary bottom

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "r", 2000);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);




            //////////////////////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");

            ////////////////////////lower sec top supp
            //height = 1000;
            //length = 4000;
            //extrainfo["Sec_low_b"] = height;
            //extrainfo["Sec_low_l"] = length;
            //extrainfo["Sec_low_l"] = length + 500;


            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HBoth, "L", sectionsize: sectionsize);

            ////info for future
            //pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            //pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            //pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            //pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);

            ////vertical sec dimensioning
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);


            ////string lower_prim_height = "";
            ////try
            ////{
            ////    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            ////    {
            ////        //height of prim from bottom

            ////        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            ////    }

            ////    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            ////    {
            ////        lower_prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            ////    }
            ////}
            ////catch (Exception)
            ////{

            ////}


            ////////prim of lower sec top supp
            //////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);

            //////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            ////if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            ////{
            ////    double radius = 1200;
            ////    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            ////    try
            ////    {
            ////        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            ////    }
            ////    catch (Exception)
            ////    {

            ////    }
            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            ////}

            ////if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            ////{
            ////    double radius = 500;
            ////    info[Defination.Prim_Radius] = radius;
            ////    info[Defination.Prim_ht] = radius;

            ////    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);

            ////    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            ////    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));

            ////    //height of prim from bottom
            ////    try
            ////    {
            ////        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            ////    }
            ////    catch (Exception)
            ////    {

            ////    }
            ////    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);

            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            ////    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            ////    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            ////    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);

            ////}


            ////note nfo[prim.ht changes here

            ////dimensioning

            //l_dist_frm_centre = 0;
            ////r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    l_dist_frm_centre = secsupp_des.ElementAt(1).BoxData.X;
            //    //var strpt = secsupp_des.ElementAt(1).StPt;
            //    //var endpt = secsupp_des.ElementAt(1).EndPt;
            //    //var midpt = primsup_des.ElementAt(1).Centroid;
            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Min(dist1, dist2);
            //    //r_dist_frm_centre = Math.Max(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}


            //CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            //// CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            //// CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);





            /////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "80");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS81(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            //double ht_frm_cen = 1220.7383;

            //topsec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;            
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////////slant sec sup
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(2).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(2).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(2).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(1).EndPt), new Point3d(secsupp_des.ElementAt(2).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(1).EndPt), new Point3d(secsupp_des.ElementAt(2).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(1).EndPt;
                //var anglepart = secsupp_des.ElementAt(2).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(2).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            /////////////////////bot sec
            //bot secondary support
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = height + 1500;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y + 2000, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y + 2000, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0), SecThick.VBoth, "L", sectionsize: sectionsize);

            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y + 2000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y + 2000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 3000);

            ////////////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //topsec over bot sec
            height = 1000;
            length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotLT].Y + height, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotLT].Y + height, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2, pointsinfo[Defination.SecBotLT].Y, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2 + 1000, pointsinfo[Defination.SecBotLT].Y + height, 0);
            pointsinfo[Defination.SecTopRT] = new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2 + 1000, pointsinfo[Defination.SecBotLT].Y + height, 0);
            pointsinfo[Defination.SecTopRB] = new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 + length / 2 + 1000, pointsinfo[Defination.SecBotLT].Y, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d((pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2 - length / 2 + 1000, pointsinfo[Defination.SecBotLT].Y, 0);

            l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;            
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            // vertical dimensioning
            TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);

            /////////////concret supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, centerY, height, length, i, "na");

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "81");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS82(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());


            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}


            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}



            //double ht_frm_cen = 1220.7383;

            //topsec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;            
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Max(dist1, dist2);
                //r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //////////////////slant sec sup
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            /////////////////////bot sec
            //bot secondary support
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = height + 1500;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y + 1000, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y + 1000, 0), new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0), SecThick.VBoth, "L", sectionsize: sectionsize);

            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y + 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y + 1000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLB].X, pointsinfo[Defination.SecTopLB].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLB].X - length, pointsinfo[Defination.SecTopLB].Y - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 3000);

            ////////////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            /////////////concret supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, centerY, height, length, i, "na");

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "82");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS83(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            }
            else
            {
                info[Defination.Prim_Radius] = 500;
                info[Defination.Prim_ht] = 500;
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //}

            //else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //}


            //topsec
            double height = 1000;
            double length = 4000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            //CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            //bot sec
            height = 3000;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            //sec bot

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            ////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "83");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        //[Obsolete]
        //public void DRS85(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        //{

        //    double upperYgap = 3500;
        //    double centerX = tracex + boxlen / 2;  // 9869.9480;
        //    double centerY = spaceY - upperYgap;
        //    //box boundaries
        //    //vertical line
        //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

        //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);
        //    var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
        //    var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);



        //    /////////////////prim sup left
        //    string prim_height = "";
        //    for (int j = 0; j < 9; j++)
        //    {
        //        try
        //        {
        //            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
        //            {

        //                prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
        //            }

        //            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
        //            {
        //                prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
        //            }
        //        }
        //        catch (Exception)
        //        {

        //        }
        //        try
        //        {
        //            if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
        //            {
        //                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 4000 + j * 1000, centerY, 150);
        //                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
        //                DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
        //            }

        //            else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
        //            {
        //                double radius = 150;
        //                info[Defination.Prim_Radius] = radius;
        //                info[Defination.Prim_ht] = radius;

        //                //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
        //                CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 4000 + j * 1000, centerY, radius, primsup_des.ElementAt(j));
        //                DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
        //                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
        //                //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
        //                //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
        //                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

        //            }
        //            else if (primsup_des.ElementAt(j).SupportName.Length > 0)
        //            {
        //                FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 1000, centerY, 150);
        //                //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
        //                DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));

        //            }
        //        }
        //        catch (Exception)
        //        {

        //        }
        //    }

        //    /////////////prim sup left most


        //    /////////////////////topsec
        //    double height = 1000;
        //    double length = 10000;
        //    info[Defination.Sec_top_l] = length;
        //    info[Defination.Sec_top_b] = height;
        //    var sectionsize = 0.0;
        //    try
        //    {
        //        sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
        //    }
        //    catch (Exception)
        //    {

        //    }

        //    //upper secondary supp
        //    BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

        //    //info for future
        //    pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
        //    pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
        //    pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
        //    pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


        //    //hori dimen prim and top sec
        //    double l_dist_frm_centre = 0;
        //    //double r_dist_frm_centre = 0;
        //    double prim1_dist = 0;
        //    double[] fin_pt = null;
        //    List<double> final_distances_list = new List<double>();
        //    //dimensioning
        //    try
        //    {
        //        if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
        //        {
        //            List<double> all_dimen = new List<double>();
        //            all_dimen.Clear();
        //            var strpt = secsupp_des.ElementAt(0).StPt;
        //            var endpt = secsupp_des.ElementAt(0).EndPt;

        //            int dir = 0;
        //            for (int j = 0; j < 9; j++)
        //            {
        //                var prim1_midpt = primsup_des.ElementAt(j).Centroid;
        //                Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

        //                var left = 0.0;
        //                var right = 0.0;
        //                if (j == 0)
        //                {
        //                    left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
        //                    right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
        //                }

        //                if (left < right && dir == 0)
        //                {
        //                    prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
        //                    fin_pt = strpt;
        //                    dir = 1;
        //                }
        //                else if (left > right && dir == 0)
        //                {
        //                    prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
        //                    fin_pt = endpt;
        //                    dir = -1;
        //                }
        //                prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
        //                all_dimen.Add(prim1_dist);


        //            }
        //            all_dimen.Sort();
        //            final_distances_list = CalculateAccumulation(all_dimen);

        //        }
        //        else
        //        {
        //            l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
        //        }

        //    }
        //    catch (Exception)
        //    {

        //    }

        //    //dimensioning
        //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
        //    {
        //        CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 4000, centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
        //        for (int k = 1; k < 9; k++)
        //        {
        //            CreateDimension(new Point3d(centerX - 4000 + (k - 1) * 1000, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 4000 + k * 1000, centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
        //        }
        //        CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 4000 + 8000, centerY + info[Defination.Prim_Radius], 0), final_distances_list.Last().ToString(), 300);


        //    }
        //    else
        //    {
        //        CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
        //    }






        //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);


        //    string TotalHt = "";
        //    //mtext

        //    try
        //    {
        //        TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
        //    }
        //    catch (Exception)
        //    {
        //    }


        //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

        //    info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

        //    /////////////////botsec
        //    height = 3000;
        //    length = 1000;
        //    sectionsize = 0.0;
        //    try
        //    {
        //        sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
        //    }
        //    catch (Exception)
        //    {

        //    }
        //    //sec bot
        //    BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

        //    //info for future
        //    pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
        //    pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
        //    pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
        //    pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

        //    //dimensioning
        //    var botsec = "";
        //    try
        //    {
        //        botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
        //    }
        //    catch (Exception)
        //    {

        //    }

        //    CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

        //    info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

        //    ///////////////gusset plates
        //    double gusht = 500;
        //    double guslt = 100;
        //    BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

        //    BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


        //    //////////////////concrete sup
        //    height = 1000;
        //    length = 3000;
        //    info[Defination.Concrete_l] = length;
        //    info[Defination.Concrete_b] = height;

        //    if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
        //    {
        //        FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
        //    }

        //    //support name and quantity
        //    CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "85");


        //    tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        //}
        [Obsolete]
        public void DRS85(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "85");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        //with generic prim
        public void DRS86(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            //var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            //////////////all prim supports
            //string prim_height = "";
            ////left most 1st
            ////try
            ////{
            ////    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            ////    {
            ////        //height of prim from bottom

            ////        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            ////    }

            ////    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac")))
            ////    {
            ////        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            ////    }
            ////}
            ////catch (Exception)
            ////{

            ////}

            ///////////////////////prim sup
            ////try
            ////{
            ////    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            ////    {
            ////        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
            ////        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            ////        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

            ////    }

            ////    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            ////    {
            ////        double radius = 300;
            ////        info[Defination.Prim_Radius] = radius;
            ////        info[Defination.Prim_ht] = radius;

            ////        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, radius, primsup_des.First());
            ////        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            ////        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            ////        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            ////        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
            ////        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

            ////    }
            ////    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            ////    {
            ////        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
            ////        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            ////        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

            ////    }

            ////}
            ////catch (Exception)
            ////{

            ////}

            ////right most last
            //try
            //{
            //    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, radius, primsup_des.ElementAt(1));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));
            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            ////middle prim sup
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb")//)
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, radius, primsup_des.ElementAt(2));
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY + 300, 0), clampname);

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            /////////////////////////top sec
            //double height = 1000;
            //double length = 3000;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            ////info for future
            //pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0);
            //pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);




            ////hori dimen prim and top sec
            //double l_dist_frm_centre = 0;
            ////double r_dist_frm_centre = 0;
            //double prim1_dist = 0;
            //double prim2_dist = 0;
            ////double prim3_dist = 0;
            //double prim4_dist = 0;
            ////dimensioning
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            //    {
            //        List<double> all_dimen = new List<double>();
            //        var strpt = secsupp_des.ElementAt(0).StPt;
            //        var endpt = secsupp_des.ElementAt(0).EndPt;
            //        var prim1_midpt = primsup_des.ElementAt(0).Centroid;
            //        var prim2_midpt = primsup_des.ElementAt(1).Centroid;
            //        //var prim3_midpt = primsup_des.ElementAt(2).Centroid;

            //        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
            //        Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
            //        //Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
            //        var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
            //        var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
            //        if (left < right)
            //        {
            //            prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
            //            prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
            //            //prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
            //        }
            //        else
            //        {
            //            prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
            //            prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
            //            //prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
            //        }

            //        all_dimen.Add(prim1_dist);
            //        all_dimen.Add(prim2_dist);
            //        //all_dimen.Add(prim3_dist);
            //        all_dimen.Sort();

            //        prim1_dist = Math.Round(all_dimen[0]);
            //        prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
            //        //prim3_dist = Math.Round(all_dimen[2] - all_dimen[1] - all_dimen[0]);
            //        prim4_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - all_dimen[1] - all_dimen[0]);



            //    }
            //    else
            //    {
            //        l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
            //    }

            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            //{
            //    CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);
            //    CreateDimension(new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
            //    //CreateDimension(new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim3_dist.ToString(), 300);
            //    CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);

            //}
            //else
            //{
            //    CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            //}
            //// vertical dimensioning
            //string TotalHt = "";
            ////mtext


            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            double[] fin_pt = null;
            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;

                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");


            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopRT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopRT].X + length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopRT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pr", -500, sectionsize);


            ///////////////////slant sec support
            //height = 1000;
            //length = 3000;
            //info[Defination.Sec_bot_l] = length;
            //info[Defination.Sec_bot_b] = height;

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize);

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            //}
            //catch (Exception)
            //{

            //}



            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            ////hori small dimen
            //var botsec2 = "";
            //try
            //{
            //    List<double> all_dist = new List<double>();

            //    var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
            //    var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
            //    var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
            //    var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

            //    all_dist.Add(firs);
            //    all_dist.Add(sec1);
            //    all_dist.Add(thrd);
            //    all_dist.Add(four);
            //    all_dist.Sort();

            //    var toppart = secsupp_des.ElementAt(0).EndPt;
            //    var anglepart = secsupp_des.ElementAt(1).EndPt;

            //    sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

            //    botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            //}
            //catch (Exception)
            //{

            //}


            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRT], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            ////inside lines
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            ///////////////////left plate for bot sec
            //height = 1500;
            //length = 200;

            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            /////////////////////ref block
            ////pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            ////pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            ////pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            ////pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            ////CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            ////DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "86");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        public void DRS87(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            ////////////all prim supports
            string prim_height = "";
            //left most 1st
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, radius, primsup_des.First());
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            //right most last
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, radius, primsup_des.ElementAt(1));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));
                }

                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            //middle prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, radius, primsup_des.ElementAt(2));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY + 300, 0), clampname);

                }

                else if (primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);




            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            double prim2_dist = 0;
            double prim3_dist = 0;
            double prim4_dist = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;
                    var prim1_midpt = primsup_des.ElementAt(0).Centroid;
                    var prim2_midpt = primsup_des.ElementAt(1).Centroid;
                    var prim3_midpt = primsup_des.ElementAt(2).Centroid;

                    Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
                    Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
                    Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
                    var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    if (left < right)
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
                        prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
                    }
                    else
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
                        prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
                    }

                    all_dimen.Add(prim1_dist);
                    all_dimen.Add(prim2_dist);
                    all_dimen.Add(prim3_dist);
                    all_dimen.Sort();

                    prim1_dist = Math.Round(all_dimen[0]);
                    prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
                    prim3_dist = Math.Round(all_dimen[2] - all_dimen[1]);
                    double full_sec_length = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt));
                    prim4_dist = Math.Round(full_sec_length - all_dimen[2]);



                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim3_dist.ToString(), 300);
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);

            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), pointsinfo[Defination.SecTopRB], botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();


                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRT], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "87");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        //generic prim
        [Obsolete]
        public void DRS88(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "88");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        public void DRS89(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            ////////////all prim supports
            string prim_height = "";
            //left most 1st
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1200, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1200, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1200 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1200 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1200, centerY, radius, primsup_des.First());
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1200, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1200 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1200 - 1500, centerY + 1500, 0));

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1200, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1200, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1200 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1200 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            //2nd from left
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 2500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 2500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 2500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 2500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 2500, centerY, radius, primsup_des.ElementAt(1));
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 2500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 2500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 2500 - 1500, centerY + 1500, 0));

                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 2500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 2500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 2500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 2500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            //right most last
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, radius, primsup_des.ElementAt(2));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));
                }

                else if (primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            //middle prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(3));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(3).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(3).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(3).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(3).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, radius, primsup_des.ElementAt(3));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(3).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY + 300, 0), clampname);

                }

                else if (primsup_des.ElementAt(3).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(3).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);




            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            double prim2_dist = 0;
            double prim3_dist = 0;
            double prim4_dist = 0;
            double prim5_dist = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;
                    var prim1_midpt = primsup_des.ElementAt(0).Centroid;
                    var prim2_midpt = primsup_des.ElementAt(1).Centroid;
                    var prim3_midpt = primsup_des.ElementAt(2).Centroid;
                    var prim4_midpt = primsup_des.ElementAt(3).Centroid;

                    Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
                    Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
                    Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
                    Point3d prim4_projectedpt = FindPerpendicularFoot(prim4_midpt, strpt, endpt);
                    var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    if (left < right)
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
                        prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
                        prim4_dist = Math.Round(GetDist(new Point3d(strpt), prim4_projectedpt));
                    }
                    else
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
                        prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
                        prim4_dist = Math.Round(GetDist(new Point3d(endpt), prim4_projectedpt));
                    }

                    all_dimen.Add(prim1_dist);
                    all_dimen.Add(prim2_dist);
                    all_dimen.Add(prim3_dist);
                    all_dimen.Add(prim4_dist);
                    all_dimen.Sort();

                    prim1_dist = Math.Round(all_dimen[0]);
                    prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
                    prim3_dist = Math.Round(all_dimen[2] - all_dimen[1]);
                    prim4_dist = Math.Round(all_dimen[3] - all_dimen[2]);
                    prim5_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - all_dimen[3]);



                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 3000 * 0.66 + 1200, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1200, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 2500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 3000 * 0.66 + 2500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim3_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);

            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), pointsinfo[Defination.SecTopRB], botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();

                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRT], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "86");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS90(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }


                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "90");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        [Obsolete]
        public void DRS91(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "91");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS92(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());



            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            if (primsup_des.Count() == 1)
            {
                length = 2000 + 1000 * (primsup_des.Count() + 1);
            }
            else
            {
                length = 1000 * (primsup_des.Count() + 1);
            }

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;





            //////////////////////////////topsec
            //////////subtracted 3000 to left end for making long top sec
            //double height = 1000;
            //double length = 3000;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            ////info for future
            //pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            //pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            //double l_dist_frm_centre = 0;
            ////double r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
            //    //var strpt = secsupp_des.ElementAt(0).StPt;

            //    //var endpt = secsupp_des.ElementAt(0).EndPt;

            //    //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
            //    //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Max(dist1, dist2);
            //    //r_dist_frm_centre = Math.Min(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            //// CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            //// vertical dimensioning
            //string TotalHt = "";
            ////mtext


            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            //info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;





            ////////////////////////slant sec sup right
            //for adjusting 
            centerX += 2475;

            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "r", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                // botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

                //var rightpt = GetRightPoint(new Point3d(secsupp_des.ElementAt(3).StPt), new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(2).StPt));

                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //// var sec1 = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //// var thrd = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //// var four = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt)));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();


                //var toppartst = secsupp_des.ElementAt(0).StPt;
                //var toppartsend = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRB], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //////////////////////slant sec sup left
            //subtracted 1000 to left from bottom end and subtracted 6475.4928 and 4475.4928 from upper end to draw mirror of slant support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            /////Note:-for this case box doesnt start from left top
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464 - 4475.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 6475.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");


            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464 - 4475.4928, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 6475.4928, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRB], pointsinfo[Defination.SecBotLB], botsec, 1000);

            //hori small dimen
            botsec2 = "";
            try
            {
                // botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }

            //new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht] - height, 0)
            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopLB], pointsinfo[Defination.SecBotRB], botsec2, 700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200 - 4875.4928, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200 - 6075.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            centerX -= 2475;

            /////////////////////////bot secondary support
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = height + 500 + 1000;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0), SecThick.VBoth, "L", sectionsize: sectionsize);

            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }
            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 3000);


            //////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////concret supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, centerY + 350, height, length, i, "na");

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "92");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS93(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());



            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            if (primsup_des.Count() == 1)
            {
                length = 2000 + 1000 * (primsup_des.Count() + 1);
            }
            else
            {
                length = 1000 * (primsup_des.Count() + 1);
            }

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2 + 2000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2 - 2000, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;





            //////////////////////////////topsec
            //////////subtracted 3000 to left end for making long top sec
            //double height = 1000;
            //double length = 3000;
            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;

            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            ////info for future
            //pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            //pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            //pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            //double l_dist_frm_centre = 0;
            ////double r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
            //    //var strpt = secsupp_des.ElementAt(0).StPt;

            //    //var endpt = secsupp_des.ElementAt(0).EndPt;

            //    //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
            //    //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Max(dist1, dist2);
            //    //r_dist_frm_centre = Math.Min(dist1, dist2);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            //// CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            //// vertical dimensioning
            //string TotalHt = "";
            ////mtext


            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            //info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;





            ////////////////////////slant sec sup right
            //for adjusting 
            centerX += 2475;

            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "r", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                // botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

                //var rightpt = GetRightPoint(new Point3d(secsupp_des.ElementAt(3).StPt), new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(2).StPt));

                List<double> all_dist = new List<double>();


                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //// var sec1 = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //// var thrd = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //// var four = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt)));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();


                //var toppartst = secsupp_des.ElementAt(0).StPt;
                //var toppartsend = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRB], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            //////////////////////slant sec sup left
            //subtracted 1000 to left from bottom end and subtracted 6475.4928 and 4475.4928 from upper end to draw mirror of slant support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            /////Note:-for this case box doesnt start from left top
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464 - 4475.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 6475.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");


            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464 - 4475.4928, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 6475.4928, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRB], pointsinfo[Defination.SecBotLB], botsec, 1000);

            //hori small dimen
            botsec2 = "";
            try
            {
                // botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();
                List<double> all_dist = new List<double>();


                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }

            //new Point3d(centerX - length * 0.66 - 1000 - 3000, centerY - info[Defination.Prim_ht] - height, 0)
            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopLB], pointsinfo[Defination.SecBotRB], botsec2, 700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200 - 4875.4928, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200 - 6075.4928, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 - 1000, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            centerX -= 2475;

            /////////////////////////bot secondary support
            height = 4000;
            length = 1000;
            info[Defination.Sec_ht_bot] = height + 500 + 1000;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0), SecThick.VBoth, "L", sectionsize: sectionsize);

            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - length / 2, pointsinfo[Defination.SecTopLB].Y - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }
            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 3000);


            //////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////concret supp
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {

                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLB].X + pointsinfo[Defination.SecBotRB].X) / 2, centerY + 350, height, length, i, "na");

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "93");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        //with one prim dotted
        public void DRS94(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            ////////////all prim supports
            string prim_height = "";
            //left most 1st
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, radius, primsup_des.First());
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ////right most last
            //try
            //{
            //    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, radius, primsup_des.ElementAt(1));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));
            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            ////middle prim sup
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb")//)
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(2).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(2).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, radius, primsup_des.ElementAt(2));
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY + 300, 0), clampname);

            //    }

            //    else if (primsup_des.ElementAt(2).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);




            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            //double prim2_dist = 0;
            //double prim3_dist = 0;
            double prim4_dist = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;
                    var prim1_midpt = primsup_des.ElementAt(0).Centroid;
                    //var prim2_midpt = primsup_des.ElementAt(1).Centroid;
                    //var prim3_midpt = primsup_des.ElementAt(2).Centroid;

                    Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
                    //Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
                    //Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
                    var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    if (left < right)
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                        //prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
                    }
                    else
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                        //prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
                    }

                    all_dimen.Add(prim1_dist);
                    //all_dimen.Add(prim2_dist);
                    //all_dimen.Add(prim3_dist);
                    all_dimen.Sort();

                    prim1_dist = Math.Round(all_dimen[0]);
                    //prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
                    //prim3_dist = Math.Round(all_dimen[2] - all_dimen[1] - all_dimen[0]);
                    prim4_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - all_dimen[0]);



                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);
                //CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                //CreateDimension(new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim3_dist.ToString(), 300);
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);

            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", 0, sectionsize, "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var close_pt = FindClosestPoint_TOLINE(secsupp_des.ElementAt(0).StPt, secsupp_des.ElementAt(0).EndPt, secsupp_des.ElementAt(1).StPt, secsupp_des.ElementAt(1).EndPt);
                var firs = GET_PROJECTEDPT_DIST(secsupp_des.ElementAt(0), new double[] { close_pt[0], close_pt[1], close_pt[2] });
                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);
                botsec2 = Math.Round(firs - (sectionsize) / (Math.Sqrt(2) * 2)).ToString();
                //var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                //var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                //var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                //all_dist.Add(firs);
                //all_dist.Add(sec1);
                //all_dist.Add(thrd);
                //all_dist.Add(four);
                //all_dist.Sort();

                //var toppart = secsupp_des.ElementAt(0).EndPt;
                //var anglepart = secsupp_des.ElementAt(1).EndPt;

                //sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                //botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRB], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "94");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS95(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            /////////////////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "95");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS96(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            /////////////////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "96");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS97(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 4000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height, 0), SecThick.VBoth, "l", -1000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 500);

            info[Defination.Sec_ht_bot] = height;

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2, centerY, height, length, i, "na");
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "97");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS98(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 4000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height, 0), SecThick.VBoth, "l", -1000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 500);

            info[Defination.Sec_ht_bot] = height;

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotLT].X + pointsinfo[Defination.SecBotRT].X) / 2, centerY, height, length, i, "na");
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "98");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }


        //with 2 prim
        public void DRS99(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            ////////////all prim supports
            string prim_height = "";
            //left most 1st
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, radius, primsup_des.First());
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ////right most last
            //try
            //{
            //    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, radius, primsup_des.ElementAt(1));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));
            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            //middle prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, radius, primsup_des.ElementAt(1));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY + 300, 0), clampname);

                }

                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);




            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            double prim2_dist = 0;
            //double prim3_dist = 0;
            double prim4_dist = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;
                    var prim1_midpt = primsup_des.ElementAt(0).Centroid;
                    var prim2_midpt = primsup_des.ElementAt(1).Centroid;
                    //var prim3_midpt = primsup_des.ElementAt(2).Centroid;

                    Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
                    Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
                    //Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
                    var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    if (left < right)
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
                    }
                    else
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
                    }

                    all_dimen.Add(prim1_dist);
                    all_dimen.Add(prim2_dist);
                    //all_dimen.Add(prim3_dist);
                    all_dimen.Sort();

                    prim1_dist = Math.Round(all_dimen[0]);
                    prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
                    //prim3_dist = Math.Round(all_dimen[2] - all_dimen[1] - all_dimen[0]);
                    prim4_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - all_dimen[1]);



                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);
                //CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                CreateDimension(pointsinfo[Defination.SecTopRB], new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);

            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                all_dist.Add(firs);
                all_dist.Add(sec1);
                all_dist.Add(thrd);
                all_dist.Add(four);
                all_dist.Sort();

                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRB], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "99");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        //with 2 prim dotted
        public void DRS100(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            ////////////all prim supports
            string prim_height = "";
            //left most 1st
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, radius, primsup_des.First());
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ////right most last
            //try
            //{
            //    if //(ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, radius, primsup_des.ElementAt(1));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));
            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            //middle prim sup
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, radius, primsup_des.ElementAt(1));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY + 300, 0), clampname);

                }

                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);




            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            double prim2_dist = 0;
            //double prim3_dist = 0;
            double prim4_dist = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;
                    var prim1_midpt = primsup_des.ElementAt(0).Centroid;
                    var prim2_midpt = primsup_des.ElementAt(1).Centroid;
                    //var prim3_midpt = primsup_des.ElementAt(2).Centroid;

                    Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
                    Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
                    //Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
                    var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    if (left < right)
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
                    }
                    else
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                        prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
                    }

                    all_dimen.Add(prim1_dist);
                    all_dimen.Add(prim2_dist);
                    //all_dimen.Add(prim3_dist);
                    all_dimen.Sort();

                    prim1_dist = Math.Round(all_dimen[0]);
                    prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
                    //prim3_dist = Math.Round(all_dimen[2] - all_dimen[1] - all_dimen[0]);
                    prim4_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - all_dimen[1]);



                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);
                //CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                CreateDimension(pointsinfo[Defination.SecTopRB], new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);

            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                all_dist.Add(firs);
                all_dist.Add(sec1);
                all_dist.Add(thrd);
                all_dist.Add(four);
                all_dist.Sort();

                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRB], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "100");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        //with one prim
        public void DRS101(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            ////////////all prim supports
            string prim_height = "";
            //left most 1st
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            ///////////////////prim sup
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, radius, primsup_des.First());
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1500, centerY, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 4000 * 0.66 + 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1500 - 1500, centerY + 1500, 0));

                }

            }
            catch (Exception)
            {

            }

            ////right most last
            //try
            //{
            //    if// (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, radius, primsup_des.ElementAt(1));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY + 300, 0), clampname);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));
            //    }

            //    else if (primsup_des.ElementAt(1).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 1000 + 4500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 4500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500 + 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            ////middle prim sup
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb")//)
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(2).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(2).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            /////////////////////prim sup
            //try
            //{
            //    if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //    }

            //    else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 200;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, radius, primsup_des.ElementAt(2));
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 2000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY + 300, 0), clampname);

            //    }

            //    else if (primsup_des.ElementAt(2).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 3000 * 0.66 + 3500, centerY, 200);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 5000 * 0.66 + 1000 + 3500 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 3000 * 0.66 + 3500, centerY, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 500, centerY + 1500, 0), new Point3d(centerX - 3000 * 0.66 + 3500 - 1500, centerY + 1500, 0));

            //    }

            //}
            //catch (Exception)
            //{

            //}

            ///////////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }


            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34 + 3000, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);




            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;
            //double prim2_dist = 0;
            //double prim3_dist = 0;
            double prim4_dist = 0;
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;
                    var prim1_midpt = primsup_des.ElementAt(0).Centroid;
                    //var prim2_midpt = primsup_des.ElementAt(1).Centroid;
                    //var prim3_midpt = primsup_des.ElementAt(2).Centroid;

                    Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);
                    //Point3d prim2_projectedpt = FindPerpendicularFoot(prim2_midpt, strpt, endpt);
                    //Point3d prim3_projectedpt = FindPerpendicularFoot(prim3_midpt, strpt, endpt);
                    var left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    var right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                    if (left < right)
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                        //prim2_dist = Math.Round(GetDist(new Point3d(strpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(strpt), prim3_projectedpt));
                    }
                    else
                    {
                        prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                        //prim2_dist = Math.Round(GetDist(new Point3d(endpt), prim2_projectedpt));
                        //prim3_dist = Math.Round(GetDist(new Point3d(endpt), prim3_projectedpt));
                    }

                    all_dimen.Add(prim1_dist);
                    //all_dimen.Add(prim2_dist);
                    //all_dimen.Add(prim3_dist);
                    all_dimen.Sort();

                    prim1_dist = Math.Round(all_dimen[0]);
                    //prim2_dist = Math.Round(all_dimen[1] - all_dimen[0]);
                    //prim3_dist = Math.Round(all_dimen[2] - all_dimen[1] - all_dimen[0]);
                    prim4_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - all_dimen[0]);



                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), prim1_dist.ToString(), 300);
                //CreateDimension(new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), prim2_dist.ToString(), 300);
                //CreateDimension(new Point3d(centerX - 3000 * 0.66 + 3500, centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - 3000 * 0.66 + 1000 + 4500, centerY + info[Defination.Prim_Radius], 0), prim3_dist.ToString(), 300);
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - 3000 * 0.66 + 1500, centerY + info[Defination.Prim_Radius], 0), prim4_dist.ToString(), 300);

            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }
            // vertical dimensioning
            string TotalHt = "";
            //mtext


            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopRT].X, pointsinfo[Defination.SecTopRT].Y, TotalHt);
            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////left plate for top sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, (pointsinfo[Defination.SecTopLT].Y + pointsinfo[Defination.SecTopLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", 0, sectionsize);


            /////////////////slant sec support
            height = 1000;
            length = 3000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0), new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), SecThick.Nothing, "L", sectionsize: sectionsize, Centerline: "na");

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX - length * 0.66 + 1737.7464, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt))).ToString();
            }
            catch (Exception)
            {

            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660, 0), botsec, -1000);

            //hori small dimen
            var botsec2 = "";
            try
            {
                List<double> all_dist = new List<double>();

                var firs = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).StPt));
                var sec1 = GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var thrd = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).EndPt));
                var four = GetDist(new Point3d(secsupp_des.ElementAt(0).EndPt), new Point3d(secsupp_des.ElementAt(1).StPt));

                all_dist.Add(firs);
                all_dist.Add(sec1);
                all_dist.Add(thrd);
                all_dist.Add(four);
                all_dist.Sort();

                var toppart = secsupp_des.ElementAt(0).EndPt;
                var anglepart = secsupp_des.ElementAt(1).EndPt;

                sectionsize = CSECTIONSIZE(secsupp_des.ElementAt(1).Size);

                botsec2 = Math.Round((all_dist.First() - (Math.Sqrt(2) * sectionsize) / 2)).ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecTopRB], new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2, -700);

            //inside lines
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");

            /////////////////left plate for bot sec
            height = 1500;
            length = 200;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 + height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - length, (pointsinfo[Defination.SecBotLT].Y + pointsinfo[Defination.SecBotLB].Y) / 2 - height / 2, 0), SecThick.Nothing, "pl", -500, sectionsize);


            ///////////////////ref block
            //pointsextrainfo["RefLT"] = new Point3d(pointsinfo[Defination.SecTopLT].X - 1500, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRT"] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y + 1000, 0);
            //pointsextrainfo["RefRB"] = new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y - 1000, 0);
            //pointsextrainfo["RefLB"] = new Point3d(pointsinfo[Defination.SecBotLB].X - 1500, pointsinfo[Defination.SecBotLB].Y - 1000, 0);

            //CreateRefBlock(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RefLT"], pointsextrainfo["RefRT"], pointsextrainfo["RefRB"], pointsextrainfo["RefLB"]);
            //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Structure/Block", new Point3d(pointsextrainfo["RefLT"].X, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0), new Point3d(pointsextrainfo["RefLT"].X - 1000, (pointsextrainfo["RefLT"].Y + pointsextrainfo["RefLB"].Y) / 2, 0));

            ////////////////support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "101");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS102(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            ////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            //try
            //{
            //    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 300;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //        //height of prim from bottom
            //        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //        string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //    }
            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //}
            //catch (Exception)
            //{

            //}


            //////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}
            //double ht_frm_cen = 1220.7383;0.33,0.66

            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            // double l_dist_frm_centre = 0;
            // double r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(0).StPt;
            //    var endpt = secsupp_des.ElementAt(0).EndPt;
            //    var midpt = primsup_des.ElementAt(0).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            //dimensioning
            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////////bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VBoth, "l", -2000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(pointsinfo[Defination.SecBotLT].X - 1000, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - 1000, pointsinfo[Defination.SecBotLB].Y, 0), botsec, 1000);



            ////left side down secondary support
            //height = 1000;
            //length = 2500;
            //extrainfo["sec_Left_Bot_L"] = length;
            //extrainfo["sec_Left_Bot_B"] = height;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            ////verti dimen secsupp
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            ////left side down primary support

            ////verti dimen prim ht
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 300;

            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            //}

            ////hori dimesion of left side down prim and sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(1).StPt;
            //    var endpt = secsupp_des.ElementAt(1).EndPt;
            //    var midpt = primsup_des.ElementAt(1).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            /////////////right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);

            //right side upper primary support
            string prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);



            ///////////////////right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            /////////////////////hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            /////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - 1000, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "102");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS103(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;

            //for support18 only
            centerY += 2500;
            centerX -= 1500;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);

            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            ////////////////////prim sup
            //string prim_height = "";
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(0).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}
            //try
            //{
            //    if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //    else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp")|| primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 300;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;

            //        CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);
            //        //height of prim from bottom
            //        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //        //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX, centerY + 1.4 * radius, 0), new Point3d(centerX - 4 * radius, centerY + 1.4 * radius, 0));
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //        string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);

            //    }
            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
            //        //height of prim from bottom
            //        CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

            //    }

            //}
            //catch (Exception)
            //{

            //}


            //////////////////top sec
            double height = 1000;
            double length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //var sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}
            //double ht_frm_cen = 1220.7383;0.33,0.66

            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);


            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            // double l_dist_frm_centre = 0;
            // double r_dist_frm_centre = 0;
            //dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(0).StPt;
            //    var endpt = secsupp_des.ElementAt(0).EndPt;
            //    var midpt = primsup_des.ElementAt(0).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            //dimensioning
            //CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 300);
            // CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 300);


            string TotalHt = "";

            //mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;


            ///////////////////bot sec
            height = 6500;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y, 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2 - 1000, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "l", -2000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 + info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            pointsinfo[Defination.SecBotLB] = new Point3d((pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - info[Defination.Sec_bot_l] / 2, pointsinfo[Defination.SecTopRB].Y - info[Defination.Sec_bot_b], 0);
            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(pointsinfo[Defination.SecBotLT].X - 1000, pointsinfo[Defination.SecBotLT].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - 1000, pointsinfo[Defination.SecBotLB].Y, 0), botsec, 1000);


            ////left side down secondary support
            //height = 1000;
            //length = 2500;
            //extrainfo["sec_Left_Bot_L"] = length;
            //extrainfo["sec_Left_Bot_B"] = height;

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000 - extrainfo["sec_Left_Bot_B"], 0), SecThick.HBoth, "l");

            ////verti dimen secsupp
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 3500, pointsinfo[Defination.SecBotLT].Y - 1000 + 300, 0), "TOS EL.(+)" + TotalHt);
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] - 4000, pointsinfo[Defination.SecBotLT].Y - 1000, 0), MyCol.LightBlue);

            ////left side down primary support

            ////verti dimen prim ht
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //    {
            //        //height of prim from bottom

            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }

            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 &&(ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac")))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 300;

            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5), radius, "l");
            //    //height of prim from bottom
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //}

            //if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp")|| ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
            //{
            //    double radius = 300;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;

            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, radius);
            //    //height of prim from bottom
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

            //    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - 4 * radius, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 1.4 * radius, 0));
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius], pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 3000, pointsinfo[Defination.SecBotLT].Y - 1000 + radius, 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"] + 1000 - info[Defination.Prim_Radius] - 2500, pointsinfo[Defination.SecBotLT].Y - 1000 + radius + 300, 0), clampname);

            //}

            ////hori dimesion of left side down prim and sec
            //l_dist_frm_centre = 0;
            //r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    var strpt = secsupp_des.ElementAt(1).StPt;
            //    var endpt = secsupp_des.ElementAt(1).EndPt;
            //    var midpt = primsup_des.ElementAt(1).Centroid;
            //    Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    l_dist_frm_centre = Math.Min(l_dist_frm_centre, r_dist_frm_centre);
            //    r_dist_frm_centre = Math.Max(l_dist_frm_centre, r_dist_frm_centre);
            //}
            //catch (Exception)
            //{

            //}

            ////dimensioning
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X - extrainfo["sec_Left_Bot_L"], pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 10);
            //CreateDimension(new Point3d(pointsinfo[Defination.SecBotLT].X, pointsinfo[Defination.SecBotLT].Y - 1000, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - extrainfo["sec_Left_Bot_L"] + 1000, pointsinfo[Defination.SecBotLT].Y - 1000 + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 10);


            /////////////right side upper secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Upper_Bot_L"] = length;
            extrainfo["sec_Right_Upper_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y - extrainfo["sec_Right_Upper_Bot_B"], 0), SecThick.HHidBoth, "R", sectionsize: sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000, pointsinfo[Defination.SecBotRT].Y, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + extrainfo["sec_Right_Upper_Bot_L"], pointsinfo[Defination.SecBotRT].Y, 0);

            //right side verti dimen sec sup
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }

            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);

            //right side upper primary support
            string prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius, primsup_des.ElementAt(0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Upper_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 3500 + extrainfo["sec_Right_Upper_Bot_B"] + radius + 1.4 * radius, 0));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRT].Y + radius, 0), new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRT].Y + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRT].Y + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);



            ///////////////////right side down secondary support
            height = 1000;
            length = 4000;
            extrainfo["sec_Right_Lower_Bot_L"] = length;
            extrainfo["sec_Right_Lower_Bot_B"] = height;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500, 0), new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500, 0), SecThick.HHidBoth, "R", sectionsize: sectionsize);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], TotalHt);


            //right side down primary support

            //verti dime prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }

                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 400;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, radius, primsup_des.ElementAt(1));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 - 4 * radius, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 1.4 * radius, 0));
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 3000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius, 0), MyCol.LightBlue);
                    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + info[Defination.Prim_Radius] + 2500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + radius + 300, 0), clampname);
                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 600;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5), radius);
                    //height of prim from bottom
                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500 + 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }
            }
            catch (Exception)
            {

            }


            /////////////////////hori dimen right side below prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X - 1000, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"], pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"], 0), new Point3d(pointsinfo[Defination.SecBotRB].X + extrainfo["sec_Right_Lower_Bot_L"] - 1500, pointsinfo[Defination.SecBotRB].Y + 500 + extrainfo["sec_Right_Lower_Bot_B"] + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);

            //draw plate/concrete support 
            //height = 1000;
            //length = 3000;
            //info[Defination.Plate_l] = length;
            //info[Defination.Plate_b] = height;


            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 + info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), new Point3d((pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - info[Defination.Plate_l] / 2, pointsinfo[Defination.SecBotLB].Y - info[Defination.Plate_b], 0), SecThick.Nothing);

            /////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (pointsinfo[Defination.SecBotRB].X + pointsinfo[Defination.SecBotLB].X) / 2 - 1000, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "103");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");
        }

        [Obsolete]
        public void DRS104(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => !e.PartDirection.ToUpper().Contains("3D")).OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {

                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, radius, primsup_des.First());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 1)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }



            ////////////side view top sec below prim
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht], 1000);


            ///////////////topsec
            double height = 1000;
            double length = 1500;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;
                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 1500);
            //CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }



            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////bot sec supp
            height = 4500;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "R");

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0), SecThick.VBoth, "l", 1000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0);


            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);


            ////////////down top sec supp
            height = 1000;
            length = 3000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000, 0), SecThick.HHidBoth, "r", 0, sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0);

            l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));

                //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

                //var strpt = secsupp_des.ElementAt(0).StPt;

                //var endpt = secsupp_des.ElementAt(0).EndPt;

                //// var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                //var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                //l_dist_frm_centre = Math.Min(dist1, dist2);
                //r_dist_frm_centre = Math.Max(dist1, dist2);

            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);



            //////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            ////////////////////////////////
            ///////////////////////////////
            /////////////side view starts from here


            centerX = tracex + (3 * boxlen) / 4;  // 9869.9480;
            centerY = spaceY - upperYgap;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            //  var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(ListCentalSuppoData[i].ListPrimarySuppo[0]);
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("clamp") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //  CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] + 1000 - 500, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] + 1000 - 500, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 + 300, 0), clampname);

                }
                else if (ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.ToLower().Contains("nb") || ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName.Length > 0)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);

                }


            }
            catch (Exception)
            {

            }




            height = 1000;
            length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length / 2, centerY - info[Defination.Prim_ht], TotalHt, "l");


            //top sec below sec and prm side view
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", (pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - 416 / 2, pointsinfo[Defination.SecTopLT].Y, 1000);

            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().StPt;

                var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().EndPt;

                // var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Midpoint;
                var midpt = ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());



            // vertical dimensioning
            //TotalHt = "";
            ////mtext


            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////sec bot
            height = 4500;
            length = 416;

            /////////////sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "r", 1000);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //bottom top sec sv 
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 2000, 1000);

            /////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "104");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS105(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => !e.PartDirection.ToUpper().Contains("3D")).OrderByDescending(e => e.Boundingboxmin.Z);
            var secsupp_3D = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {

                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, radius, primsup_des.First());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 1)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }



            ////////////side view top sec below prim
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht], 1000);


            ///////////////topsec
            double height = 1000;
            double length = 1500;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;
                //// var midpt = primsup_des.ElementAt(0).Midpoint;
                //var midpt = primsup_des.ElementAt(0).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 1500);
            //CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }



            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////bot sec supp
            height = 4500;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "R");

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0), SecThick.VBoth, "l", 1000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0);


            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);


            ////////////down top sec supp
            //height = 1000;
            //length = 3000;

            //info[Defination.Sec_top_l] = length;
            //info[Defination.Sec_top_b] = height;
            ////double ht_frm_cen = 1220.7383;
            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            //}
            //catch (Exception)
            //{

            //}

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000, 0), SecThick.HHidBoth, "r", 0, sectionsize);

            //pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0);
            //pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0);

            //l_dist_frm_centre = 0;
            ////double r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

            //    //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

            //    //var strpt = secsupp_des.ElementAt(0).StPt;

            //    //var endpt = secsupp_des.ElementAt(0).EndPt;

            //    //// var midpt = primsup_des.ElementAt(0).Midpoint;
            //    //var midpt = primsup_des.ElementAt(0).Centroid;

            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Min(dist1, dist2);
            //    //r_dist_frm_centre = Math.Max(dist1, dist2);

            //}
            //catch (Exception)
            //{

            //}


            ////dimensioning
            //CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            //// CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            ////LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //TotalHt = "";
            ////mtext
            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);


            /////////downside prim and top sec as same
            //centey for adjusting position
            centerY -= 3500;
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            try
            {

                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, radius, primsup_des.ElementAt(1));

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }
                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(1).SupportName.Length > 1)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }



            ////////////side view top sec below prim
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht], 1000);


            ///////////////topsec
            height = 1000;
            length = 1500;
            //double ht_frm_cen = 1220.7383;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(1).StPt), new Point3d(secsupp_des.ElementAt(1).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;
                //// var midpt = primsup_des.ElementAt(0).Midpoint;
                //var midpt = primsup_des.ElementAt(0).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 1500);
            //CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);
            centerY += 3500;

            //////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            ////////////////////////////////
            ///////////////////////////////
            /////////////side view starts from here


            centerX = tracex + (3 * boxlen) / 4;  // 9869.9480;
            centerY = spaceY - upperYgap;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            //  var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //  CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] + 1000 - 500, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] + 1000 - 500, 0), MyCol.LightBlue);
                    //string clampname = primsup_des.ElementAt(0).SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);

                }


            }
            catch (Exception)
            {

            }




            height = 1000;
            length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_3D.ElementAt(0).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_3D.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length / 2, centerY - info[Defination.Prim_ht], TotalHt, "l");


            //top sec below sec and prm side view
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", (pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - 416 / 2, pointsinfo[Defination.SecTopLT].Y, 1000);

            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_3D.ElementAt(0).StPt;

                var endpt = secsupp_3D.ElementAt(0).EndPt;

                // var midpt = primsup_des.ElementAt(0).Midpoint;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());



            // vertical dimensioning
            //TotalHt = "";
            ////mtext


            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////sec bot
            height = 4500;
            length = 416;

            /////////////sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "r", 1000);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //bottom top sec sv 
            // CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 2000, 1000);
            ////bottom part same as above
            //for ajusting the position
            centerY -= 3500;
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //  CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] + 1000 - 500, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] + 1000 - 500, 0), MyCol.LightBlue);
                    //string clampname = primsup_des.ElementAt(0).SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(1).SupportName.Length > 0)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);

                }


            }
            catch (Exception)
            {

            }




            height = 1000;
            length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_3D.ElementAt(1).Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_3D.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length / 2, centerY - info[Defination.Prim_ht], TotalHt, "l");


            //top sec below sec and prm side view
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", (pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - 416 / 2, pointsinfo[Defination.SecTopLT].Y, 1000);

            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_3D.ElementAt(1).StPt;

                var endpt = secsupp_3D.ElementAt(1).EndPt;

                // var midpt = primsup_des.ElementAt(0).Midpoint;
                var midpt = primsup_des.ElementAt(1).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());

            centerY += 3500;


            /////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "105");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS106(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 2500;



            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);



            //if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            //{
            //    var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            //}
            //else
            //{
            //    info[Defination.Prim_Radius] = 500;
            //    info[Defination.Prim_ht] = 500;
            //}



            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmin.Z);

            ///////////////////////left top sec
            double height = 1000;
            double length = 4000;



            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {



            }



            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);
            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {



            }



            try
            {
                Point3d primLoc = GetMidPoint(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0),
                new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0));
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, centerY + 400, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));
                    // DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(primLoc.X, primLoc.Y + radius, 0), new Point3d(primLoc.X - 800, primLoc.Y + radius + 1700, 0), new Point3d(primLoc.X - 1700, primLoc.Y + radius + 1700, 0));



                }



                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;



                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + radius, radius, primsup_des.ElementAt(1));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(primLoc.X, primLoc.Y + radius, 0), new Point3d(primLoc.X - 800, primLoc.Y + radius + 1700, 0), new Point3d(primLoc.X - 1700, primLoc.Y + radius + 1700, 0));



                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = primsup_des.ElementAt(0).SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);



                }
                else if (primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + 400, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));
                    //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(primLoc.X, primLoc.Y + radius, 0), new Point3d(primLoc.X - 800, primLoc.Y + radius + 1700, 0), new Point3d(primLoc.X - 1700, primLoc.Y + radius + 1700, 0));




                }
            }
            catch (Exception)
            {



            }



            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            Point3d primLoc1 = GetMidPoint(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0));
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            }
            catch (Exception)
            {



            }

            //dimensioning
            //CreateDimension(new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            CreateDimension(primLoc1, new Point3d(centerX - length * 0.66 + 1000, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            CreateDimension(primLoc1, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), r_dist_frm_centre.ToString());
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));



            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);



            string TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }




            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);



            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;




            ////////////////////////bot sec
            height = 6000;
            length = 1000;
            info[Defination.Sec_bot_l] = length;
            info[Defination.Sec_bot_b] = height;



            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height - 1000;



            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(3).Size));
            }
            catch (Exception)
            {



            }



            //secondary bottom



            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), SecThick.VHidBoth, "r", 2000);
            //try
            //{
            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"//))
            //    {
            //        //height of prim from bottom



            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).PrimaryZhtNB)), 2).ToString();
            //    }



            //    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp"))
            //    {
            //        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(1).Centroid.Z)), 2).ToString();
            //    }
            //}
            //catch (Exception)
            //{



            //}



            //try
            //{
            //    Point3d primLoc = GetMidPoint(new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0));
            //    if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb"))
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, centerY + 400, 400);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));



            //    }



            //    else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
            //    {
            //        double radius = 100;
            //        info[Defination.Prim_Radius] = radius;
            //        info[Defination.Prim_ht] = radius;



            //        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
            //        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + radius, radius, primsup_des.ElementAt(1));
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));



            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
            //        //string clampname = primsup_des.ElementAt(0).SupportName;
            //        // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);



            //    }
            //    else if (primsup_des.ElementAt(0).SupportName.Length > 0)
            //    {
            //        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + 400, 400);
            //        //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
            //        DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));




            //    }
            //}
            //catch (Exception)
            //{



            //}



            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(3).BoxData.Z.ToString();
            }
            catch (Exception)
            {



            }



            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b], 0), botsec);




            /////////////////lower sec top supp
            height = 1000;
            length = 4000;
            extrainfo["Sec_low_b"] = height;
            extrainfo["Sec_low_l"] = length;
            extrainfo["Sec_low_l"] = length + 500;




            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {



            }



            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0), SecThick.HHidBoth, "L", sectionsize: sectionsize);



            //info for future
            pointsextrainfo["Sec_low_LT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RT"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0);
            pointsextrainfo["Sec_low_RB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);
            pointsextrainfo["Sec_low_LB"] = new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + 500, 0);



            //vertical sec dimensioning
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(2).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"] - 3500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + 300, 0), "TOS EL.(+)" + TotalHt);




            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(2));
                }
            }
            catch (Exception)
            {



            }



            try
            {
                Point3d primLoc = GetMidPoint(new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0));
                if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, centerY + 400, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));



                }



                else if (primsup_des.ElementAt(2).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(2).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;



                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + radius, radius, primsup_des.ElementAt(2));
                    //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(primLoc.X, primLoc.Y + radius, 0), new Point3d(primLoc.X - 500, primLoc.Y + radius + 1500, 0), new Point3d(primLoc.X - 1500, primLoc.Y + radius + 1500, 0));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(primLoc.X, primLoc.Y + radius, 0), new Point3d(primLoc.X - 800, primLoc.Y + radius + 1700, 0), new Point3d(primLoc.X - 1700, primLoc.Y + radius + 1700, 0));



                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);



                }
                else if (primsup_des.ElementAt(2).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + 400, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(2).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));

                }
            }
            catch (Exception)
            {



            }





            //////prim of lower sec top supp
            ////FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (1200 * 1.5), 1200);



            ////CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());




            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("nb"))
            //{
            //    double radius = 1200;
            //    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius, "l");
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {



            //    }
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);



            //}



            //if (ListCentalSuppoData[i].ListPrimarySuppo.Where(e => e.StPt[2] == ListCentalSuppoData[i].ListPrimarySuppo.Min(s => s.StPt[2])).First().SupportName.ToLower().Contains("clamp"))
            //{
            //    double radius = 500;
            //    info[Defination.Prim_Radius] = radius;
            //    info[Defination.Prim_ht] = radius;



            //    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), radius);



            //    // string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    //DrawLeader(AcadBlockTableRecord, AcadTransaction, AcadDatabase, clampname, new Point3d(centerX - 500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0), new Point3d(centerX - 500 - 4 * radius, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 1.4 * radius, 0));



            //    //height of prim from bottom
            //    try
            //    {
            //        lower_prim_height = MillimetersToMeters(Convert.ToDouble(lower_prim_height)).ToString();
            //    }
            //    catch (Exception)
            //    {



            //    }
            //    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 + info[Defination.Prim_Radius] - 1500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + lower_prim_height);



            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) - 100, 0), "CL.EL.(+)" + prim_height);
            //    LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5), 0), MyCol.LightBlue);
            //    string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
            //    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 500 - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500 + (radius * 1.5) + 300, 0), clampname);



            //}




            //note nfo[prim.ht changes here



            //dimensioning



            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            Point3d primLoc2 = GetMidPoint(new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0));
            try
            {
                var strpt = secsupp_des.ElementAt(2).StPt;
                var endpt = secsupp_des.ElementAt(2).EndPt;
                var midpt = primsup_des.ElementAt(2).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));


            }
            catch (Exception)
            {
            }
            //CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            CreateDimension(primLoc2, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34 - extrainfo["Sec_low_l"], centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), l_dist_frm_centre.ToString());
            CreateDimension(primLoc2, new Point3d(centerX + info[Defination.Sec_top_l] * 0.34, centerY - info[Defination.Prim_ht] - info[Defination.Sec_bot_b] + extrainfo["Sec_low_b"] + 500, 0), r_dist_frm_centre.ToString());
            // CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            // CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);




            ///////////////////////right top sec
            height = 1000;
            length = 4000;



            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {



            }



            //upper top secondary
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 5000, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "L", 0, sectionsize);
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(3));
                }
            }
            catch (Exception)
            {



            }



            try
            {
                Point3d primLoc = GetMidPoint(new Point3d(centerX - length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0));
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb"))
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, centerY + 400, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));



                }



                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 200;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;



                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + radius, radius, primsup_des.ElementAt(0));
                    //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(3).SupportName, "CL.EL.(+)" + prim_height, new Point3d(primLoc.X, primLoc.Y + radius, 0), new Point3d(primLoc.X - 500, primLoc.Y + radius + 1500, 0), new Point3d(primLoc.X - 1500, primLoc.Y + radius + 1500, 0));
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(primLoc.X, primLoc.Y + radius, 0), new Point3d(primLoc.X - 800, primLoc.Y + radius + 1700, 0), new Point3d(primLoc.X - 1800, primLoc.Y + radius + 1800, 0));



                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius], centerY, 0), new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 3000, centerY, 0), MyCol.LightBlue);
                    //string clampname = ListCentalSuppoData[i].ListPrimarySuppo[0].SupportName;
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 - info[Defination.Prim_Radius] - 2500, centerY + 300, 0), clampname);



                }
                else if (primsup_des.ElementAt(0).SupportName.Length > 0)
                {
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primLoc.X, primLoc.Y + 400, 400);
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - 1000 + info[Defination.Prim_Radius] + 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(0).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 1000, centerY, 0), new Point3d(centerX - 1000 - 500, centerY + 1500, 0), new Point3d(centerX - 1000 - 1500, centerY + 1500, 0));




                }
            }
            catch (Exception)
            {



            }



            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            Point3d primLoc3 = GetMidPoint(new Point3d(centerX - length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0));
            try
            {
                var strpt = secsupp_des.ElementAt(0).StPt;
                var endpt = secsupp_des.ElementAt(0).EndPt;
                var midpt = primsup_des.ElementAt(0).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }




            //CreateDimension(pointsextrainfo["Sec_low_LT"], pointsextrainfo["Sec_low_RT"], l_dist_frm_centre.ToString(), 500);
            CreateDimension(primLoc3, new Point3d(centerX - length * 0.66 + 5000, centerY - info[Defination.Prim_ht], 0), l_dist_frm_centre.ToString());
            CreateDimension(primLoc3, new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0), r_dist_frm_centre.ToString());
            // CreateDimension(pointsextrainfo["Sec_low_LT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            // CreateDimension(pointsextrainfo["Sec_low_RT"], new Point3d(centerX - 500, pointsextrainfo["Sec_low_LT"].Y + info[Defination.Prim_ht] + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);



            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34 + 5000, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000 + 5000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);



            TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }




            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 3500 + 5000, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);



            ////////////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX + info[Defination.Sec_top_l] * 0.34 + info[Defination.Sec_bot_l] + centerX + info[Defination.Sec_top_l] * 0.34) / 2, centerY, height, length, i);
            }
            // LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);



            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();



            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);



            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");



            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");



            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "106");



            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");




        }


        [Obsolete]
        public void DRS107(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {
            double upperYgap = 3500;

            double centerX = tracex + boxlen / 4;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => !e.PartDirection.ToUpper().Contains("3D")).OrderByDescending(e => e.Boundingboxmin.Z);

            string prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {

                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    //FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, radius, primsup_des.First());

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);


                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 1)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;
                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX + 1500 * 0.34 + 208, centerY, 801.5625);
                    //height of prim from bottom

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_Single_SV", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht] + 1000 - 500, 500);

                    CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 1500 * 0.34 + 208 - info[Defination.Prim_Radius] - 1500, centerY - 100, 0), "CL.EL.(+)" + prim_height);

                }

            }
            catch (Exception)
            {

            }



            ////////////side view top sec below prim
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", centerX + 1500 * 0.34, centerY - info[Defination.Prim_ht], 1000);


            ///////////////topsec
            double height = 1000;
            double length = 1500;
            //double ht_frm_cen = 1220.7383;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "R", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length * 0.66, centerY - info[Defination.Prim_ht] - height, 0);

            double l_dist_frm_centre = 0;
            double r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                //var strpt = secsupp_des.ElementAt(0).StPt;
                //var endpt = secsupp_des.ElementAt(0).EndPt;
                //// var midpt = primsup_des.ElementAt(0).Midpoint;
                //var midpt = primsup_des.ElementAt(0).Centroid;
                //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                //r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //dimensioning
            CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 1500);
            //CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());


            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            string TotalHt = "";

            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }



            CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ///////////bot sec supp
            height = 4500;
            length = 1000;
            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;
            // BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX - height * 0.66 + length, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - height * 0.66, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "R");

            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(2).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0), new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0), new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0), SecThick.VBoth, "l", 1000, sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(pointsinfo[Defination.SecTopLT].X - length, pointsinfo[Defination.SecTopLT].Y - height - 1000, 0);


            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotLT], pointsinfo[Defination.SecBotLB], botsec, 1000);


            ////////////down top sec supp
            height = 1000;
            length = 3000;

            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            //double ht_frm_cen = 1220.7383;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000, 0), SecThick.HHidBoth, "r", 0, sectionsize);

            pointsextrainfo["LT"] = new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0);
            pointsextrainfo["RT"] = new Point3d(pointsinfo[Defination.SecBotRB].X + length, pointsinfo[Defination.SecBotRB].Y + 1000 + height, 0);


            //down prim supp
            //right side upper primary support
            prim_height = "";
            //verti dimen prim ht
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(1));
                }
            }
            catch (Exception)
            {

            }
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 300;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", pointsinfo[Defination.SecBotRT].X - 1000 + 2500, pointsinfo[Defination.SecBotRT].Y + radius, radius);
                    CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X + 1500, pointsextrainfo["LT"].Y + radius, radius, primsup_des.ElementAt(1));

                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(pointsextrainfo["LT"].X + 1500, pointsextrainfo["LT"].Y + radius, 0), new Point3d(pointsextrainfo["LT"].X + 1500 + 300, pointsextrainfo["LT"].Y + radius + 1200, 0), new Point3d(pointsextrainfo["LT"].X + 1500 + 1000, pointsextrainfo["LT"].Y + radius + 1000, 0));


                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["LT"].X + 1500 + info[Defination.Prim_Radius] + 2500, pointsextrainfo["LT"].Y + radius - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["LT"].X + 1500 + info[Defination.Prim_Radius], pointsextrainfo["LT"].Y + radius, 0), new Point3d(pointsextrainfo["LT"].X + 1500 + info[Defination.Prim_Radius] + 3000, pointsextrainfo["LT"].Y + radius, 0), MyCol.LightBlue);
                    //string clampname = primsup_des.ElementAt(0).SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["LT"].X + 1500 + info[Defination.Prim_Radius] + 2500, pointsextrainfo["LT"].Y + radius + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    double radius = 300;

                    FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["LT"].X + 1500, pointsextrainfo["LT"].Y + (radius * 1.5), radius);
                    DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(1).SupportName, "CL.EL.(+)" + prim_height, new Point3d(pointsextrainfo["LT"].X + 1500, pointsextrainfo["LT"].Y + radius, 0), new Point3d(pointsextrainfo["LT"].X + 1500 + 300, pointsextrainfo["LT"].Y + radius + 1200, 0), new Point3d(pointsextrainfo["LT"].X + 1500 + 1000, pointsextrainfo["LT"].Y + radius + 1000, 0));
                    //height of prim from bottom
                    // CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsextrainfo["LT"].X + 1500 + 2500, pointsextrainfo["LT"].Y + (radius * 1.5) - 100, 0), "CL.EL.(+)" + info[Defination.Prim_ht].ToString());

                }



            }
            catch (Exception)
            {

            }


            ///////////////////right side upper primary hori dimen of prim and sec
            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = secsupp_des.ElementAt(1).StPt;
                var endpt = secsupp_des.ElementAt(1).EndPt;
                var midpt = primsup_des.ElementAt(1).Centroid;
                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

                l_dist_frm_centre = Math.Max(dist1, dist2);
                r_dist_frm_centre = Math.Min(dist1, dist2);
            }
            catch (Exception)
            {

            }

            //dimensioning
            CreateDimension(pointsextrainfo["LT"], new Point3d(pointsextrainfo["LT"].X + 1500, pointsextrainfo["LT"].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString(), 200);
            CreateDimension(pointsextrainfo["RT"], new Point3d(pointsextrainfo["LT"].X + 1500, pointsextrainfo["LT"].Y + (info[Defination.Prim_Radius] * 1.5) + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString(), 200);


            //l_dist_frm_centre = 0;
            ////double r_dist_frm_centre = 0;
            ////dimensioning
            //try
            //{
            //    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));

            //    //var maxz = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z));

            //    //var strpt = secsupp_des.ElementAt(0).StPt;

            //    //var endpt = secsupp_des.ElementAt(0).EndPt;

            //    //// var midpt = primsup_des.ElementAt(0).Midpoint;
            //    //var midpt = primsup_des.ElementAt(0).Centroid;

            //    //Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

            //    //var dist1 = Math.Round(GetDist(new Point3d(strpt), projectedpt));
            //    //var dist2 = Math.Round(GetDist(new Point3d(endpt), projectedpt));

            //    //l_dist_frm_centre = Math.Min(dist1, dist2);
            //    //r_dist_frm_centre = Math.Max(dist1, dist2);

            //}
            //catch (Exception)
            //{

            //}


            ////dimensioning
            //CreateDimension(pointsextrainfo["LT"], pointsextrainfo["RT"], l_dist_frm_centre.ToString(), 500);
            // CreateDimension(new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX - 500, centerY + info[Defination.Prim_Radius], 0));

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            TotalHt = "";
            //mtext
            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(1).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsextrainfo["RT"].X, pointsextrainfo["RT"].Y, TotalHt);



            //////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;
            //FixCreateSecondarySupportTop(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY);
            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, (centerX - length * 0.66 + centerX - length * 0.66 + height) / 2, centerY, height, length, i);
            }
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length * 0.34, centerY - info[Defination.Sec_ht_bot] - length, 0), new Point3d(centerX + length * 0.34 + 4000, centerY - info[Defination.Sec_ht_bot] - length, 0), MyCol.LightBlue);

            ////hori small dimen
            //var botsec2 = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.BoxData.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.BoxData.Z)).First().BoxData.Z.ToString();

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length * 0.34, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 1000, centerY - info[Defination.Sec_ht_top], 0), botsec2);

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 115, 0), new Point3d(centerX - length * 0.66 + 1737.7464 + 200, centerY - info[Defination.Sec_ht_top], 0), MyCol.Yellow, "Dashed");

            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length * 0.66 + 1737.7464 + 1000 - 200, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX - length * 0.66, centerY - info[Defination.Sec_ht_top] - 1000 - 571.1660 + 115, 0), MyCol.Yellow, "Dashed");


            ////////////////////////////////
            ///////////////////////////////
            /////////////side view starts from here


            centerX = tracex + (3 * boxlen) / 4;  // 9869.9480;
            centerY = spaceY - upperYgap;

            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            //var primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderByDescending(e => e.Centroid.Z);
            //  var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);


            prim_height = "";
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(0));
                }
            }
            catch (Exception)
            {

            }

            try
            {
                if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(0).SupportName.ToLower().Contains("brac"))
                {
                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    //  CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX, centerY, radius);

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);
                    //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius], centerY - info[Defination.Prim_ht] + 1000 - 500, 0), new Point3d(centerX - info[Defination.Prim_Radius] - 3000, centerY - info[Defination.Prim_ht] + 1000 - 500, 0), MyCol.LightBlue);
                    //string clampname = primsup_des.ElementAt(0).SupportName;
                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - info[Defination.Prim_Radius] - 2500, centerY - info[Defination.Prim_ht] + 1000 - 500 + 300, 0), clampname);

                }
                else if (primsup_des.ElementAt(0).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(0).SupportName.Length > 0)
                {

                    double radius = 500;
                    info[Defination.Prim_Radius] = radius;
                    info[Defination.Prim_ht] = radius;

                    // FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, 801.5625);
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_From_End", centerX, centerY - info[Defination.Prim_ht], 500);

                    //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + info[Defination.Prim_Radius] + 1500, centerY - info[Defination.Prim_ht] + 1000 - 500 - 100, 0), "CL.EL.(+)" + prim_height);

                }


            }
            catch (Exception)
            {

            }




            height = 1000;
            length = 3000;
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;

            //upper secondary supp

            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().Size));
            }
            catch (Exception)
            {
            }

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HBoth, "l", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - length / 2, centerY - info[Defination.Prim_ht], TotalHt, "l");


            //top sec below sec and prm side view
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", (pointsinfo[Defination.SecTopLB].X + pointsinfo[Defination.SecTopRB].X) / 2 - 416 / 2, pointsinfo[Defination.SecTopLT].Y, 1000);

            l_dist_frm_centre = 0;
            r_dist_frm_centre = 0;
            //dimensioning
            try
            {
                var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().StPt;

                var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection.ToUpper().Contains("3D")).First().EndPt;

                // var midpt = primsup_des.ElementAt(0).Midpoint;
                var midpt = primsup_des.ElementAt(0).Centroid;

                Point3d projectedpt = FindPerpendicularFoot(midpt, strpt, endpt);

                l_dist_frm_centre = Math.Round(GetDist(new Point3d(strpt), projectedpt));
                r_dist_frm_centre = Math.Round(GetDist(new Point3d(endpt), projectedpt));
            }
            catch (Exception)
            {

            }


            //double strtmiddist=GetDist(ldist)

            CreateDimension(new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), l_dist_frm_centre.ToString());
            CreateDimension(new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX, centerY + info[Defination.Prim_Radius], 0), r_dist_frm_centre.ToString());



            // vertical dimensioning
            //TotalHt = "";
            ////mtext


            //try
            //{
            //    TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            //}
            //catch (Exception)
            //{
            //}
            //LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2 + 4000, centerY - info[Defination.Prim_ht], 0), MyCol.LightBlue);

            //CreateMtextfunc(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX + 2500, centerY - info[Defination.Prim_ht] + 300, 0), "TOS EL.(+)" + TotalHt);

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;
            ////////////////sec bot
            height = 4500;
            length = 416;

            /////////////sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "r", 1000);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] + 1000, 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(2).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }


            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, pointsinfo[Defination.SecBotRT], pointsinfo[Defination.SecBotRB], botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            //bottom top sec sv 
            CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + 2000, 1000);
            //prim above bottom top sec
            try
            {
                if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(1).SupportName.ToLower().Contains("brac"))
                {
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Prim_block_U", pointsinfo[Defination.SecBotLB].X + 208, pointsinfo[Defination.SecBotLB].Y + 2000, 300);
                }
                else if (primsup_des.ElementAt(1).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(1).SupportName.Length > 0)
                {
                    CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Side_Top_Secondary", pointsinfo[Defination.SecBotLB].X + 208, pointsinfo[Defination.SecBotLB].Y + 2000, 300);
                }


            }
            catch (Exception)
            {

            }


            /////////////////concrete
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "107");

            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); //Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");


        }

        [Obsolete]
        public void DRS108(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            //height = 3000;
            //length = 1000;
            //sectionsize = 0.0;
            //try
            //{
            //    sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            //}
            //catch (Exception)
            //{

            //}
            ////sec bot
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            ////info for future
            //pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            //pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            //pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            ////dimensioning
            //var botsec = "";
            //try
            //{
            //    botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            //}
            //catch (Exception)
            //{

            //}

            //CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top];

            ///////////////gusset plates
            //double gusht = 500;
            //double guslt = 100;
            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            //BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "108");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS110(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb"))
                    {

                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).PrimaryZhtNB)), 2).ToString();
                    }

                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0 && (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac")))
                    {
                        prim_height = Math.Round((MillimetersToMeters(primsup_des.ElementAt(j).Centroid.Z)), 2).ToString();
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            if (primsup_des.Count() == 1)
            {
                length = 2000 + 1000 * (primsup_des.Count() + 1);
            }
            else
            {
                length = 1000 * (primsup_des.Count() + 1);
            }
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.Top, "LR", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht] + height;

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.HidLeft, "ll", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////gusset plates
            double gusht = 500;
            double guslt = 100;
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");


            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "110");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        [Obsolete]
        public void DRS115(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType, [Optional] int i)
        {

            double upperYgap = 3500;
            double centerX = tracex + boxlen / 2;  // 9869.9480;
            double centerY = spaceY - upperYgap;
            //box boundaries
            //vertical line
            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex + boxlen, spaceY + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);

            LineDraw(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(tracex, spaceY - boxht + 619.1209, 0), new Point3d(tracex + boxlen, spaceY - boxht + 619.1209, 0), MyCol.LightBlue);


            //generic prim sup
            IOrderedEnumerable<SupporSpecData> primsup_des = null;
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 1)
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo[0].Centroid.X == ListCentalSuppoData[i].ListPrimarySuppo[1].Centroid.X)
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.Y);
                }
                else
                {
                    primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
                }
            }
            else if (ListCentalSuppoData[i].ListPrimarySuppo.Count == 1)
            {
                primsup_des = ListCentalSuppoData[i].ListPrimarySuppo.OrderBy(e => e.Centroid.X);
            }


            var secsupp_des = ListCentalSuppoData[i].ListSecondrySuppo.OrderByDescending(e => e.Boundingboxmax.Z);

            List<double> prim_pos = new List<double>();
            prim_pos = PlaceFiguresOnSupport(1000 * (primsup_des.Count() + 1), primsup_des.Count(), 1000);
            /////////////////prim sup left
            string prim_height = "";
            for (int j = 0; j < primsup_des.Count(); j++)
            {
                try
                {
                    if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                    {
                        prim_height = GET_PRIM_HT_FRM_DATUM(primsup_des.ElementAt(j));
                    }
                }
                catch (Exception)
                {

                }
                try
                {

                    if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("clamp") || primsup_des.ElementAt(j).SupportName.ToLower().Contains("brac"))
                    {
                        double radius = 150;
                        info[Defination.Prim_Radius] = radius;
                        info[Defination.Prim_ht] = radius;

                        //CopyAndModifyEntities(AcadBlockTableRecord, AcadTransaction, AcadDatabase, "Prim_block_U", centerX - 1000, centerY, radius);
                        CHECKPRIM_CLAMP_BRAC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, radius, primsup_des.ElementAt(j));
                        //DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - 4000 + j * 1000, centerY, 0), new Point3d(centerX - 4000 + j * 1000 - 300, centerY + 1500, 0), new Point3d(centerX - 4000 + j * 1000 - 800, centerY + 1500, 0));
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }
                    }
                    else if (primsup_des.ElementAt(j).SupportName.ToLower().Contains("nb") || primsup_des.ElementAt(j).SupportName.Length > 0)
                    {
                        FixCreatePrimarySupportwithvertex(AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX - (1000 * (primsup_des.Count()) / 2) + j * 1000, centerY, 150);
                        if (j % 2 == 0)
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 500, centerY + 1000, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1500, centerY + 1000, 0));
                        }
                        else
                        {
                            DrawLeader_WITH_TXT_ABOVE_BELOW(AcadBlockTableRecord, AcadTransaction, AcadDatabase, primsup_des.ElementAt(j).SupportName, "CL.EL.(+)" + prim_height, new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j], centerY, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 300, centerY + 2500, 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[j] - 1200, centerY + 2500, 0));

                        }

                    }



                }
                catch (Exception)
                {

                }
            }

            /////////////prim sup left most


            /////////////////////topsec
            double height = 1000;
            double length = 1000 * (primsup_des.Count() + 1);
            info[Defination.Sec_top_l] = length;
            info[Defination.Sec_top_b] = height;
            var sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(0).Size));
            }
            catch (Exception)
            {

            }

            //upper secondary supp
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0), SecThick.HHidBoth, "R", 0, sectionsize);

            //info for future
            pointsinfo[Defination.SecTopLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht], 0);
            pointsinfo[Defination.SecTopRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Prim_ht] - height, 0);
            pointsinfo[Defination.SecTopLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Prim_ht] - height, 0);


            //hori dimen prim and top sec
            double l_dist_frm_centre = 0;
            //double r_dist_frm_centre = 0;
            double prim1_dist = 0;

            List<double> final_distances_list = new List<double>();
            //dimensioning
            try
            {
                if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
                {
                    List<double> all_dimen = new List<double>();
                    all_dimen.Clear();
                    var strpt = secsupp_des.ElementAt(0).StPt;
                    var endpt = secsupp_des.ElementAt(0).EndPt;

                    int dir = 0;
                    double[] fin_pt = null;
                    for (int j = 0; j < primsup_des.Count(); j++)
                    {
                        var prim1_midpt = primsup_des.ElementAt(j).Centroid;
                        Point3d prim1_projectedpt = FindPerpendicularFoot(prim1_midpt, strpt, endpt);

                        var left = 0.0;
                        var right = 0.0;
                        if (j == 0)
                        {
                            left = GetDist(new Point3d(strpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            right = GetDist(new Point3d(endpt), new Point3d(prim1_midpt.X, prim1_midpt.Y, prim1_midpt.Z));
                            if (left < right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(strpt), prim1_projectedpt));
                                fin_pt = strpt;
                                dir = 1;
                            }
                            else if (left >= right && dir == 0)
                            {
                                prim1_dist = Math.Round(GetDist(new Point3d(endpt), prim1_projectedpt));
                                fin_pt = endpt;
                                dir = -1;
                            }
                        }
                        prim1_dist = Math.Round(GetDist(new Point3d(fin_pt), prim1_projectedpt));
                        all_dimen.Add(prim1_dist);


                    }
                    all_dimen.Sort();
                    final_distances_list = CalculateAccumulation(all_dimen);

                }
                else
                {
                    l_dist_frm_centre = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)));
                }

            }
            catch (Exception e)
            {

            }

            //dimensioning
            if (ListCentalSuppoData[i].ListPrimarySuppo.Count > 0)
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.First(), centerY + info[Defination.Prim_Radius], 0), final_distances_list.First().ToString(), 300);
                for (int k = 1; k < primsup_des.Count(); k++)
                {
                    CreateDimension(new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k - 1], centerY + info[Defination.Prim_Radius], 0), new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos[k], centerY + info[Defination.Prim_Radius], 0), final_distances_list[k].ToString(), 300);
                }
                double last_dist = Math.Round(GetDist(new Point3d(secsupp_des.ElementAt(0).StPt), new Point3d(secsupp_des.ElementAt(0).EndPt)) - final_distances_list.Sum());
                CreateDimension(pointsinfo[Defination.SecTopRT], new Point3d(centerX - (1000 * (prim_pos.Count() + 1) / 2) + prim_pos.Last(), centerY + info[Defination.Prim_Radius], 0), last_dist.ToString(), 300);


            }
            else
            {
                CreateDimension(pointsinfo[Defination.SecTopLT], pointsinfo[Defination.SecTopRT], l_dist_frm_centre.ToString(), 500);
            }

            string TotalHt = "";
            //mtext

            try
            {
                TotalHt = Math.Round(MillimetersToMeters(secsupp_des.ElementAt(0).Boundingboxmax.Z), 2).ToString();
            }
            catch (Exception)
            {
            }
            TOSLOC(AcadBlockTableRecord, AcadTransaction, AcadDatabase, pointsinfo[Defination.SecTopLT].X, pointsinfo[Defination.SecTopLT].Y, TotalHt, "l");

            info[Defination.Sec_ht_top] = info[Defination.Prim_ht];

            /////////////////botsec
            height = 3000;
            length = 1000;
            sectionsize = 0.0;
            try
            {
                sectionsize = Convert.ToDouble(CSECTIONSIZE(secsupp_des.ElementAt(1).Size));
            }
            catch (Exception)
            {

            }
            //sec bot
            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), SecThick.VBoth, "l", sectionsize: sectionsize);

            //info for future
            pointsinfo[Defination.SecBotLT] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRT] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0);
            pointsinfo[Defination.SecBotRB] = new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);
            pointsinfo[Defination.SecBotLB] = new Point3d(centerX - length / 2, centerY - info[Defination.Sec_ht_top] - height, 0);

            //dimensioning
            var botsec = "";
            try
            {
                botsec = secsupp_des.ElementAt(1).BoxData.Z.ToString();
            }
            catch (Exception)
            {

            }

            CreateAlighDimen(AcadBlockTableRecord, AcadTransaction, new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top], 0), new Point3d(centerX + length / 2, centerY - info[Defination.Sec_ht_top] - height, 0), botsec);

            info[Defination.Sec_ht_bot] = info[Defination.Sec_ht_top] + height;

            ///////////////gusset plates

            if (ListCentalSuppoData[i].ListSecondrySuppo.Count > 3)
            {
                double gusht = 500;
                double guslt = 100;
                BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotLB].X, pointsinfo[Defination.SecBotLB].Y, 0), new Point3d(pointsinfo[Defination.SecBotLB].X - guslt, pointsinfo[Defination.SecBotLB].Y, 0), SecThick.Nothing, "gpl");

                BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y + gusht, 0), new Point3d(pointsinfo[Defination.SecBotRB].X + guslt, pointsinfo[Defination.SecBotRB].Y, 0), new Point3d(pointsinfo[Defination.SecBotRB].X, pointsinfo[Defination.SecBotRB].Y, 0), SecThick.Nothing, "gpr");
            }

            //////////////////concrete sup
            height = 1000;
            length = 3000;
            info[Defination.Concrete_l] = length;
            info[Defination.Concrete_b] = height;

            if (ListCentalSuppoData[i].ListConcreteData.Count > 0)
            {
                if (ListCentalSuppoData[i].ListSecondrySuppo.Count > 3)
                {
                    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i, "na");
                }
                else
                {
                    FixCreateBottomSupportTopType2(Document2D, AcadBlockTableRecord, AcadTransaction, AcadDatabase, centerX, centerY, height, length, i);

                }
            }

            //support name and quantity
            CreateSupportName(AcadBlockTableRecord, AcadTransaction, AcadDatabase, ref tracex, boxlen, boxht, ref spaceY, i, "115");


            tracex += boxlen; Created_TAG.Add(ListCentalSuppoData[i].Name); Logger.GetInstance.Debug(ListCentalSuppoData[i].SupportType + " successfully created");

        }

        //commented arguments ref double tracex, double boxlen, double boxht, ref double spaceY, Document Document2D, string SupType
        public void GenericCase(BlockTableRecord AcadBlockTableRecord, Transaction AcadTransaction, Database AcadDatabase, [Optional] int i)
        {

            var strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => (e.PartDirection == "Hor") && (e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z))).First().StPt;

            var endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => (e.PartDirection == "Hor") && (e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z))).First().EndPt;

            var height = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => (e.PartDirection == "Hor") && (e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z))).First().BoxData.Z;

            var length = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => (e.PartDirection == "Hor") && (e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z))).First().BoxData.X;

            //var lengthY = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => (e.PartDirection == "Hor") && (e.Boundingboxmax.Z == ListCentalSuppoData[i].ListSecondrySuppo.Max(s => s.Boundingboxmax.Z))).First().BoxData.Y;

            //var length = Math.Max(lengthX, lengthY);

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(strpt[0], strpt[2] + height / 2, 0), new Point3d(strpt[0] + length, strpt[2] + height / 2, 0), new Point3d(strpt[0] + length, strpt[2] - height / 2, 0), new Point3d(strpt[0] - length, strpt[2] - height / 2, 0), SecThick.HBoth, "R");


            strpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Ver").First().StPt;

            endpt = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Ver").First().EndPt;

            height = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Ver").First().BoxData.Z;

            length = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Ver").First().BoxData.X;

            //lengthY = ListCentalSuppoData[i].ListSecondrySuppo.Where(e => e.PartDirection == "Ver").First().BoxData.Y;

            //length = Math.Min(lengthX, lengthY);

            BoxGenCreateSecondarySupportBottom(AcadBlockTableRecord, AcadTransaction, AcadDatabase, new Point3d(strpt[0], strpt[2] + height / 2, 0), new Point3d(strpt[0] + length, strpt[2] + height / 2, 0), new Point3d(strpt[0] + length, strpt[2] - height / 2, 0), new Point3d(strpt[0] - length, strpt[2] - height / 2, 0), SecThick.HBoth, "R");


        }



        //enum for support identification
        public enum SupportType
        {
            Nothing = 0,
            Support1,
            Support2,
            Support3,
            Support4,
            Support5,
            Support6,
            Support7,
            Support8,
            Support9,
            Support10,
            Support11,

            Support13,
            Support14,
            Support15,
            Support16,
            Support17,
            Support18,
            Support19,
            Support20,
            Support21,
            Support22,
            Support23,
            Support24,
            Support25,
            Support26,
            Support27,
            Support28,
            Support29,
            Support30,
            Support31,
            Support32,
            Support33,
            Support34,
            Support35,
            Support36,
            Support37,
            Support38,
            Support39,
            Support40,
            Support41,
            Support42,
            Support43,
            Support44,
            Support45,
            Support46,
            Support47,
            Support48,
            Support49,
            Support50,
            Support51,
            Support52,
            Support53,
            Support54,
            Support55,
            Support56,
            Support57,
            Support58,
            Support59,

            Support61,
            Support62,
            Support63,
            Support64,
            Support65,
            Support66,
            Support67,
            Support68,
            Support69,
            Support70,
            Support71,
            Support72,
            Support73,
            Support74,
            Support75,
            Support76,
            Support77,
            Support78,
            Support79,
            Support80,
            Support81,
            Support82,
            Support83,

            Support85,
            Support86,
            Support87,
            Support88,
            Support89,
            Support90,
            Support91,
            Support92,
            Support93,
            Support94,
            Support95,
            Support96,
            Support97,
            Support98,
            Support99,
            Support100,
            Support101,
            Support102,
            Support103,
            Support104,
            Support105,
            Support106,
            Support107,
            Support108,





            Support115,






            Elevation,
            S_Type,
            SL_Tyep,
            SR_Tyep,

        }







    }
}
